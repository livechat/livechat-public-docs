---
weight: 21
category: "messaging"
subcategory: "agent-chat-api"
title: "RTM API Reference"
tagline: "Interact with the chat as an Agent."
desc: "Build powerful LiveChat integrations with an open messaging protocol. Use the Agent Chat RTM API to send messages, manage access and properties."
apiVersion: "3.1"
---

# Introduction

## Versioning

This documentation describes the **Agent Chat Real-Time Messaging API v3.1**. This version is **deprecated**. We encourage you to migrate to the latest stable version. [Read more about versioning...](/messaging/#api-versioning)

### Lifecycle headers

When opening a WebSocket connection, the API responses will contain one of two headers related to the API lifecycle: `Legacy` or `Deprecation`. These headers specify when the associated stage ends (in the `YYYY-MM-DD` format).

## What is RTM API

Real-Time Messaging API (RTM API) is based on a websocket-like connection. Client can send a **request message** that results in getting a **response message**. It's also possible to get **push messages**.

## When to use RTM API

If you're wondering which API to use - Agent Chat **RTM API** or **Web API**, keep on reading.

**Real-Time Messaging API** allows for building stateful integrations that require **logging in** and **maintaining the connection**. Since connection maintenance is required, the implementation might be more challenging than with Web API.

Agent Chat RTM API enables communication in real time. It supports pushes like `sneak peek`, `typing indicator`, and other. Web API doesnâ€™t have equivalent webhooks, which means you won't be informed about certain events using Web API.

Also, the RTM API will be a better choice if you want to avoid time delays or presume significant traffic.
**Not what you're looking for?** Perhaps, you need to use [**Agent Chat Web API**](..) instead.

## Access

The basics on authorization, server pinging, and scopes in the Agent Chat RTM API.

### Authorization

**Agent authorization** is handled with access tokens. Find out how to get an **access token** from [Agent authorization flows](/authorization/authorizing-api-calls/#agent-authorization-flows). You need to authorize within 30 seconds from establishing the connection. Otherwise, the connection will be closed. Given that the connection is continuosly maintained, you only need to authorize once.

### Server pinging

After successful authorization, the client needs to **ping the server** every 15 seconds. Otherwise, the connection will be closed after about 30 seconds of inactivity. Until authorization is completed, ping is a no-op.

Use one of these 2 ways of pinging the server:

- **Protocol message with the ping action**

For web applications and backend integrations (e.g. in Python, Go). Send the following request every 15 seconds:
```
{
  "action": "ping",
  "payload": {}
}
```

After pinging the server, the client will receive a response with the `ping` action. Thanks to that, the client can make sure the connection is still alive.

- **The control frame ping in the websocket protocol**

For backend integrations; unavailable in web browsers. Read more about the [control frame ping](https://tools.ietf.org/html/rfc6455#section-5.5.2).

### Scopes

All authorization scopes are listed in the [Scopes](/getting-started/authorization/scopes/) document. If a method requires particular authorization scopes, you'll find them included in the method description.

## Data centers

LiveChat system operates in two data centers: `dal` (USA) and `fra` (Europe). The default data center is `dal`.

For backend applications, you can specify the region in the request header. The mechanism is the same as in [Agent Chat Web API reference](../#data-centers). It doesn't work for frontend applications, though.
Instead, frontend apps connect to a region different than the default one by specifying the region suffix in the URL.

**`fra`:** `wss://api-fra.livechatinc.com/v3.1/agent/rtm/ws`

**`dal`:** `wss://api.livechatinc.com/v3.1/agent/rtm/ws`

## Rate limits

To prevent sending a massive number of requests, there are rate limits for method calls. After exceeding those limits, the requester will get a `Too many requests` error in the response of a specific request. After some time, the request will be unblocked so it can be sent again.

# Data structures

To find sample payloads of **events**, **users**, and **other common structures** such as chats or threads [visit the Data structures](/messaging/agent-chat-api/v3.1/data-structures) document.

# Methods

In the websocket transport, actions generate [pushes](/messaging/agent-chat-api/v3.1/rtm-pushes). RTM API actions can also trigger [webhooks](/management/configuration-api/v3.1/#webhooks), but they need to be registered first.

<Section>
<Text>

| The API endpoint                              |
| --------------------------------------------- |
| `wss://api.livechatinc.com/v3.1/agent/rtm/ws` |

## Available methods

|                 |                                                                                                                                                                                                                                                                                                                                                         |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Chats**       | [`get_chats_summary`](#get-chats-summary) [`get_chat_threads_summary`](#get-chat-threads-summary) [`get_chat_threads`](#get-chat-threads) [`get_archives`](#get-archives) [`start_chat`](#start-chat) [`activate_chat`](#activate-chat) [`close_thread`](#close-thread) [`follow_chat`](#follow-chat) [`unfollow_chat`](#unfollow-chat)                 |
| **Chat access** | [`grant_access`](#grant-access) [`revoke_access`](#revoke-access) [`set_access`](#set-access) [`transfer_chat`](#transfer-chat)                                                                                                                                                                                                                         |
| **Chat users**  | [`add_user_to_chat`](#add-user-to-chat) [`remove_user_from_chat`](#remove-user-from-chat)                                                                                                                                                                                                                                                               |
| **Events**      | [`send_event`](#send-event) [`send_rich_message_postback`](#send-rich-message-postback)                                                                                                                                                                                                                                                                 |
| **Properties**  | [`update_chat_properties`](#update-chat-properties) [`delete_chat_properties`](#delete-chat-properties) [`update_chat_thread_properties`](#update-chat-thread-properties) [`delete_chat_thread_properties`](#delete-chat-thread-properties) [`update_event_properties`](#update-event-properties) [`delete_event_properties`](#delete-event-properties) |
| **Thread tags** | [`tag_chat_thread`](#tag-chat-thread) [`untag_chat_thread`](#untag-chat-thread)                                                                                                                                                                                                                                                                         |
| **Customers**   | [`get_customers`](#get-customers) [`create_customer`](#create-customer) [`update_customer`](#update-customer) [`ban_customer`](#ban-customer)                                                                                                                                                                                                           |
| **Status**      | [`login`](#login) [`change_push_notifications`](#change-push-notifications) [`update_agent`](#update-agent) [`set_away_status`](#set-away-status) [`logout`](#logout)                                                                                                                                                                                   |
| **Other**       | [`mark_events_as_seen`](#mark-events-as-seen) [`send_typing_indicator`](#send-typing-indicator) [`multicast`](#multicast)                                                                                                                                                                                                                               |

</Text>
<Code>
<CodeSample path={'GENERAL RTM API REQUEST FORMAT'}>

```json
{
  "request_id": "<request_id>", // optional
  "action": "<action>",
  "payload": {
    // optional
  },
  "author_id": "<author_id>" // optional, applies only to bots
}
```

</CodeSample>
<CodeResponse title={'GENERAL RTM API RESPONSE FORMAT'}>

```json
{
  "request_id": "<request_id>", // optional
  "action": "<action>",
  "type": "response",
  "success": true,
  "payload": {
    // optional
  }
}
```

</CodeResponse>
</Code>
</Section>

## Chats

<Section>
<Text>

### Get Chats Summary

It returns [summaries](/messaging/agent-chat-api/v3.1/data-structures/#chat-summaries) of the chats an Agent has access to.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `get_chats_summary`                               |
| **Required scopes \*** | `chats--all:ro` `chats--access:ro` `chats--my:ro` |
| **Web API equivalent** | [`get_chats_summary`](../#get-chats-summary)      |
| **Push message**       | -                                                 |

#### Request

| Parameter                                             | Required | Type     | Notes                                                                                       |
| ----------------------------------------------------- | -------- | -------- | ------------------------------------------------------------------------------------------- |
| `filters`                                             | No       | `object` | Mustn't change between requests for subsequent pages. Otherwise, the behavior is undefined. |
| `filters.include_active`                              | No       | `bool`   | Defines if the returned chat summary includes active chats; default: `true`.                |
| `filters.group_ids`                                   | No       | `array`  | Array of group IDs.                                                                         |
| `filters.properties.<namespace>.<name>.<filter_type>` | No       | `any`    |                                                                                             |
| `order`                                               | No       | `string` | Possible values: `asc` - oldest chats firstm `desc` - newest chats first (default)          |
| `limit`                                               | No       | `number` | Default: 10, maximum: 100                                                                   |
| `page_id`                                             | No       | `string` |                                                                                             |

`filter_type` can take the following values:

- exists (bool)
- values (type[] - array with specific type for property: `string`, `int`, or `bool`)
- exclude_values (type[] - array with specific type for property: `string`, `int`, or `bool`)

There's only one value allowed for a single property.

#### Response

| Field              | Data type | Notes                                                                     |
| ------------------ | --------- | ------------------------------------------------------------------------- |
| `found_chats`      | `number`  | An estimated number. The real number of found chats can slightly differ . |
| `next_page_id`     | `string`  | In relation to `page_id` specified in the request.                        |
| `previous_page_id` | `string`  | In relation to `page_id` specified in the request.                        |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "get_chats_summary",
  "payload": {}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "get_chats_summary",
  "type": "response",
  "success": true,
  "payload": {
    "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
    "chats_summary": [
        {
            "id": "PJ0MRSHTDG",
            "last_event_per_type": {
                "message": {
                    "thread_id": "K600PKZON8",
                    "thread_order": 1,
                    "event": {
                        "id": "Q298LUVPRH_1",
                        "created_at": "2019-12-09T12:01:18.909000Z",
                        "recipients": "all",
                        "type": "message",
                        "text": "hello world",
                        "author_id": "5ae8b076-03b0-43db-44f9-b95f8ead62e4"
                    }
                },
                "system_message": {
                    "thread_id": "K600PKZON8",
                    "thread_order": 1,
                    "event": {
                      // "System message" event
                    }
                }
            },
            "users": [
                {
                  // "Customer" user object
                },
                {
                  // "Agent" user object
                }
            ],
            "last_thread_summary": {
                "id": "K600PKZON8",
                "timestamp": 1575892853,
                "user_ids": [
                    "5ae8b076-03b0-43db-44f9-b95f8ead62e4",
                    "customer1@example.com"
                ],
                "order": 1,
                "properties": {
                  // "Properties" object
                },
                "active": true,
                "access": {
                    "group_ids": [0]
                }
            },
            "properties": {
              // "Properties" object
            },
            "access": {
                "group_ids": [0]
            },
            "order": 1575892853242000,
            "is_followed": true
             }
      ],
      "found_chats": 4
    }
}
```
</CodeResponse>

</Code>
</Section>

<Section>
<Text>

### Get Chat Threads Summary

#### Specifics

|                        |                                                            |
| ---------------------- | ---------------------------------------------------------- |
| **Action**             | `get_chat_threads_summary`                                 |
| **Required scopes**    | `chats--all:ro` `chats--access:ro` `chats--my:ro`          |
| **Web API equivalent** | [`get_chat_threads_summary`](../#get-chat-threads-summary) |
| **Push message**       | -                                                          |

#### Request

| Parameter | Required | Data type | Notes                                                                              |
| --------- | -------- | --------- | ---------------------------------------------------------------------------------- |
| `chat_id` | Yes      | `string`  |                                                                                    |
| `order`   | No       | `string`  | Possible values: `asc` - oldest chats first, `desc` - newest chats first (default) |
| `limit`   | No       | `number`  | Defaul: 10, maximum: 100                                                           |
| `page_id` | No       | `string`  |                                                                                    |

#### Response

| Field              | Data type | Notes                                              |
| ------------------ | --------- | -------------------------------------------------- |
| `found_threads`    | `number`  | The number of threads in a chat                    |
| `next_page_id`     | `string`  | In relation to `page_id` specified in the request. |
| `previous_page_id` | `string`  | In relation to `page_id` specified in the request. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "get_chat_threads_summary",
  "payload": {
    "chat_id": "PJ0MRSHTDG"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "get_chat_threads_summary",
  "type": "response",
  "success": true,
  "payload": {
    "threads_summary": [
      {
        "id": "PT039ES4OG",
        "order": 2,
        "events_count": 2
      },
      {
        "id": "PT039DS6IP",
        "order": 1,
        "events_count": 17
      }
    ],
    "found_threads": 7,
    "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
    "previous_page_id": "MTUxNzM5ODEzMTQ5Nw==" // optional
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Get Chat Threads

It returns threads that the current Agent has access to in a given chat.

#### Specifics

|                        |                                            |
| ---------------------- | ------------------------------------------ |
| **Action**             | `get_chat_threads`                         |
| **Required scopes**    | `chats--all:ro` `chats--access:ro`         |
| **Web API equivalent** | [`get_chat_threads`](../#get-chat-threads) |
| **Push message**       | -                                          |

#### Request

| Parameter    | Required | Data type |     |
| ------------ | -------- | --------- | --- |
| `chat_id`    | Yes      | `string`  |     |
| `thread_ids` | No       | `array`   |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "get_chat_threads",
  "payload": {
    "chat_id": "PJ0MRSHTDG"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "get_chat_threads",
  "type": "response",
  "success": true,
  "payload": {
    {
    "chat": {
        "id": "PWJ8Y4THAV",
        "users": [
            {
                "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
                "type": "customer",
                "present": true,
                "created_at": "2019-12-17T08:53:20.693553+01:00",
                "statistics": {
                    "chats_count": 1,
                    // ...
                },
                "agent_last_event_created_at": "2019-12-17T09:04:05.239000+01:00"
            },
            {
                "id": "agent1@example.com",
                "name": "Agent Name",
                "email": "agent1@example.com",
                "type": "agent",
                "present": true,
                "avatar": "https://example.com/avatar.jpg"
            }
        ],
        "threads_summary": [
            {
                "thread_id": "Q20N9CKRX2",
                "order": 1
            }
        ],
        "properties": {
          // "Property" object
        },
        "access": {
            "group_ids": [0]
        },
        "is_followed": true
    }
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Get Archives

It returns a list of the chats an Agent has access to. Together with a **chat**, the **events** of **one thread** from this chat are returned.

The list classification is based on threads; 1 chat per 1 thread. Thus, the same **chat** object may appear on the list several times, but each time with a different **thread**. The returned **chat** is a complete object, not only a **chat summary**.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `get_archives`                                    |
| **Required scopes**    | `chats--all:ro` `chats--access:ro` `chats--my:ro` |
| **Web API equivalent** | [`get_archives`](../#get-archives)                |
| **Push message**       | -                                                 |

#### Request

| Parameter                                             | Required | Data type | Notes                                                                                     |
| ----------------------------------------------------- | -------- | --------- | ----------------------------------------------------------------------------------------- |
| `filters`                                             | No       | `object`  |                                                                                           |
| `filters.query`                                       | No       | `string`  |                                                                                           |
| `filters.date_from`                                   | No       | `string`  | `YYYY-MM-DD` format                                                                       |
| `filters.date_to`                                     | No       | `string`  | `YYYY-MM-DD` format                                                                       |
| `filters.agent_ids`                                   | No       | `array`   | Array of agent IDs                                                                        |
| `filters.thread_ids`                                  | No       | `array`   | Array of thread IDs. Cannot be used with other filters or pagination; max array size: 20. |
| `filters.group_ids`                                   | No       | `array`   | Array of group IDs                                                                        |
| `filters.properties.<namespace>.<name>.<filter_type>` | No       | `any`     | **\*** __described below__                                                                |
| `filters.tags.<filter_type>`                          | No       | `any`     |                                                                                           |
| `filters.sales.<filter_type>`                         | No       | `any`     |                                                                                           |
| `filters.goals.<filter_type>`                         | No       | `any`     |                                                                                           |
| `filters.surveys.<survey>`                            | No       | `array`   | **\**** __described below__                                                               |
| `pagination`                                          | No       | `object`  |                                                                                           |
| `pagination.page`                                     | No       | `number`  | Default: 1, min: 1, max: 1000                                                             |
| `pagination.limit`                                    | No       | `number`  | Default: 25, min: 0, max: 100                                                             |

**\*)**

`sort_order` can take the following values:

- `asc` - the oldest chats first
- `desc` - the newest chats first

`<filter_type>` can take the following values:

- `exists` (`bool`)
- `values` (`type[]` - an array with a specific type for property: `string`, `int` or `bool`)
- `exclude_values` (`type[]` - an array with a specific type for property: `string`, `int` or `bool`)

There's only one value allowed for a single property.

**\**)**
`<survey>` contains the following fields:
  * `type` (`string`) - allowed values: `pre_chat`, `post_chat`
  * `answer_id` (`string`)

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "get_archives",
  "payload": {
    "filters": {
      "thread_ids": ["K600PKZON8"]
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "get_archives",
  "type": "response",
  "success": true,
  "payload": {
    "chats": [
      {
        "id": "PJ0MRSHTDG",
        "users": [
          {
            "id": "smith@example.com",
            "name": "Agent Smith",
            "email": "smith@example.com",
            "type": "agent",
            "present": true,
            "avatar": "https://cdn.livechatinc.com/cloud/?uri=avatar.jpg"
          }
        ],
        "thread": {
          "id": "K600PKZON8",
          "timestamp": 1590666298,
          "active": false,
          "user_ids": [
            "smith@example.com"
          ],
          "events": [
            {
              "id": "QBT14H0Y3Y_1",
              "created_at": "2020-05-28T11:45:32.269000Z",
              "recipients": "all",
              "type": "message",
              "properties": {
                "0805e283233042b37f460ed8fbf22160": {
                  "event_property": {
                    "value": "property_value"
                  }
                }
              },
              "text": "Hello, how can I help you?",
              "author_id": "smith@example.com"
            }
          ],
          "order": 1,
          "properties": {
            "0805e283233042b37f460ed8fbf22160": {
              "thread_property": {
                "value": "property_value"
              }
            }
          },
          "access": {
            "group_ids": [
              0
            ]
          }
        },
        "properties": {
          "0805e283233042b37f460ed8fbf22160": {
            "chat_property": {
              "value": "property_value"
            }
          },
        },
        "access": {
          "group_ids": [
            0
          ]
        },
        "is_followed": false
      }
    ],
    "found_chats": 42,
    "next_page_id": "MTUxNzM5ODEzMTQ5Ng==",
    "previous_page_id": "MTUxNzM5ODEzMTQ5Ng=="
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Start Chat

Starts a chat.

#### Specifics

|                        |                                                                                           |
| ---------------------- | ----------------------------------------------------------------------------------------- |
| **Action**             | `start_chat`                                                                              |
| **Required scopes \*** | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw`  |
| **Web API equivalent** | [`start_chat`](../#start-chat)                                                            |
| **Push message**       | [`incoming_chat_thread`](/messaging/agent-chat-api/v3.1/rtm-pushes/#incoming_chat_thread) |

**\*)**
When `chat.users` is defined, one of following scopes is required:

- `chats--all:rw`
- `chats--access:rw`
- `chats--my:rw`

#### Request

| Parameter                | Required | Data type | Notes                                                                       |
| ------------------------ | -------- | --------- | --------------------------------------------------------------------------- |
| `chat`                   | No       | `object`  |                                                                             |
| `chat.properties`        | No       | `object`  |                                                                             |
| `chat.access`            | No       | `object`  |                                                                             |
| `chat.users`             | No       | `array`   | The list of existing users. Only one user is allowed (type `customer`).     |
| `chat.thread`            | No       | `object`  |                                                                             |
| `chat.thread.events`     | No       | `array`   | The list of initial chat events                                             |
| `chat.thread.properties` | No       | `object`  |                                                                             |
| `continuous`             | No       | `bool`    | Starts chat as continuous (online group is not required); default: `false`. |

#### Response

| Field       | Data type  | Notes                                                                                                                                                                   |
| ----------- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`   | `string`   |                                                                                                                                                                         |
| `thread_id` | `string`   |                                                                                                                                                                         |
| `event_ids` | `[]string` | Returned only when the chat was started with initial events. Returns only the IDs of user-generated events; server-side generated events are not included in the array. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "start_chat",
  "payload": {}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "start_chat",
  "type": "response",
  "success": true,
  "payload": {
      "chat_id": "PJ0MRSHTDG",
      "thread_id": "PGDGHT5G"
    }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Activate Chat

Restarts an archived chat.

#### Specifics

|                        |                                                                                           |
| ---------------------- | ----------------------------------------------------------------------------------------- |
| **Action**             | `activate_chat`                                                                           |
| **Required scopes \*** | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw`  |
| **Web API equivalent** | [`activate_chat`](../#activate-chat)                                                      |
| **Push message**       | [`incoming_chat_thread`](/messaging/agent-chat-api/v3.1/rtm-pushes/#incoming_chat_thread) |

**\*)**
When `chat.users` is defined, one of following scopes is required:

- `chats--all:rw`
- `chats--access:rw`
- `chats--my:rw`

#### Request

| Parameter                | Required | Type     | Notes                                                                      |
| ------------------------ | -------- | -------- | -------------------------------------------------------------------------- |
| `chat`                   | Yes      | `object` |                                                                            |
| `chat.id`                | Yes      | `string` | The ID of the chat that will be activated.                                 |
| `chat.access`            | No       | `object` | Chat access to set, default: all agents.                                   |
| `chat.properties`        | No       | `object` | Initial chat properties                                                    |
| `chat.users`             | No       | `array`  | List of existing users. Only one user is allowed (type `customer`).        |
| `chat.thread`            | No       | `object` |                                                                            |
| `chat.thread.events`     | No       | `array`  | Initial chat events array                                                  |
| `chat.thread.properties` | No       | `object` | Initial chat thread properties                                             |
| `continuous`             | No       | `bool`   | Sets a chat to the continuous mode. When unset, leaves the mode unchanged. |

#### Response

| Field       | Data type  | Notes                                                                                                                                                                     |
| ----------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `thread_id` | `string`   |                                                                                                                                                                           |
| `event_ids` | `[]string` | Returned only when the chat was activated with initial events. Returns only the IDs of user-generated events; server-side generated events are not included in the array. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "activate_chat",
  "payload": {
    "chat": {
      "id": "PWJ8Y4THAV"
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "<action>",
  "type": "response",
  "success": true,
  "payload": {
    "thread_id": "Z8AGR5OUW"
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Close Thread

Closes a thread. Sending messages to this thread will no longer be possible.

#### Specifics

|                        |                                                                             |
| ---------------------- | --------------------------------------------------------------------------- |
| **Action**             | `close_thread`                                                              |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                           |
| **Web API equivalent** | [`close_thread`](../#close-thread)                                          |
| **Push message**       | [`thread_closed`](/messaging/agent-chat-api/v3.1/rtm-pushes/#thread_closed) |

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `chat_id` | Yes      | `string`  |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "close_thread",
  "payload": {
    "chat_id": "PJ0MRSHTDG"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "close_thread",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Follow Chat

Marks a chat as followed. All changes to the chat will be sent to the requester until the chat is reactivated or unfollowed. Chat members don't need to follow their chats. They receive all chat pushes regardless of their follower status.

#### Specifics

|                        |                                                                                                 |
| ---------------------- | ----------------------------------------------------------------------------------------------- |
| **Action**             | `follow_chat`                                                                                   |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                                               |
| **Web API equivalent** | [`follow_chat`](../#follow-chat)                                                                |
| **Push message**       | [`incoming_chat_thread`](/messaging/agent-chat-api/v3.1/rtm-pushes/#incoming_chat_thread)**\*** |

**\*)**
It won't be sent when the requester already follows the chat or is the chat member.

#### Request

| Parameter | Required | Data type |
| --------- | -------- | --------- |
| `chat_id` | Yes      | `string`  |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "follow_chat",
  "payload": {
    "chat_id": "PW94SJTGW6"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "follow_chat",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Unfollow Chat

Removes the requester from the chat followers. After that, only key changes to the chat (like `transfer_chat` or `close_active_thread`) will be sent to the requester. Chat members cannot unfollow the chat.

#### Specifics

|                        |                                      |
| ---------------------- | ------------------------------------ |
| **Action**             | `unfollow_chat`                      |
| **Required scopes**    | -                                    |
| **Web API equivalent** | [`unfollow_chat`](../#unfollow-chat) |
| **Push message**       | -                                    |

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `chat_id` | Yes      | `string`  |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "unfollow_chat",
  "payload": {
    "chat_id": "PWF6BACIKO"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "unfollow_chat",
  "type": "response",
  "success": true,
  "payload": {
    "chat_id": "PWF6BACIKO"
  }
}
```

</CodeResponse>
</Code>
</Section>

## Chat access

<Section>
<Text>

### Grant Access

Grants access to a new resource without overwriting the existing ones.

#### Specifics

|                        |                                                                               |
| ---------------------- | ----------------------------------------------------------------------------- |
| **Action**             | `grant_access`                                                                |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                             |
| **Web API equivalent** | [`grant_access`](../#grant-access)                                            |
| **Push message**       | [`access_granted`](/messaging/agent-chat-api/v3.1/rtm-pushes/#access_granted) |

#### Request

| Parameter     | Required | Data type | Notes                                                       |
| ------------- | -------- | --------- | ----------------------------------------------------------- |
| `resource`    | Yes      | `string`  | `chat` or `customer`                                        |
| `id`          | Yes      | `string`  | Resource Id                                                 |
| `access`      | Yes      | `object`  | The entity that is granted access to the specified resource |
| `access.type` | Yes      | `string`  | `group`                                                     |
| `access.id`   | Yes      | `number`  |                                                             |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "grant_access",
  "payload": {
    "resource": "chat",
    "id": "PW94SJTGW6",
    "access": {
      "type": "group",
      "id": 19
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "grant_access",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Revoke Access

#### Specifics

|                        |                                                                               |
| ---------------------- | ----------------------------------------------------------------------------- |
| **Action**             | `revoke_access`                                                               |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                             |
| **Web API equivalent** | [`revoke_access`](../#revoke-access)                                          |
| **Push message**       | [`access_revoked`](/messaging/agent-chat-api/v3.1/rtm-pushes/#access_revoked) |

#### Request

| Parameter     | Required | Data type | Notes                                                  |
| ------------- | -------- | --------- | ------------------------------------------------------ |
| `resource`    | Yes      | `string`  | `chat` or `customer`                                   |
| `id`          | Yes      | `string`  | Resource Id                                            |
| `access`      | Yes      | `object`  | The entity that loses access to the specified resource |
| `access.type` | Yes      | `string`  | `group`                                                |
| `access.id`   | Yes      | `number`  |                                                        |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "revoke_access",
  "payload": {
    "resource": "chat",
    "id": "PW94SJTGW6",
    "access": {
      "type": "group",
      "id": 19
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "revoke_access",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Set Access

Gives access to a new resource overwriting the existing ones.

#### Specifics

|                        |                                                                       |
| ---------------------- | --------------------------------------------------------------------- |
| **Action**             | `set_access`                                                          |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                     |
| **Web API equivalent** | [`set_access`](../#set-access)                                        |
| **Push message**       | [`access_set`](/messaging/agent-chat-api/v3.1/rtm-pushes/#access_set) |

#### Request

| Parameter     | Required | Type     | Notes                                                     |
| ------------- | -------- | -------- | --------------------------------------------------------- |
| `resource`    | Yes      | `string` | `chat` or `customer`                                      |
| `id`          | Yes      | `string` | Resource Id                                               |
| `access`      | Yes      | `object` | The entity that is given access to the specified resource |
| `access.type` | Yes      | `string` | `group`                                                   |
| `access.id`   | Yes      | `number` |                                                           |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "set_access",
  "payload": {
    "resource": "chat",
    "id": "PW94SJTGW6",
    "access": {
      "type": "group",
      "id": 19
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "set_access",
  "type": "response",
  "success": true,
  "payload": {
    // no response optional
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Transfer Chat

Transfers a chat to an Agent or a group. When transferring directly to an agent, the agent must have access to the transferred chat.

#### Specifics

|                        |                                                                                   |
| ---------------------- | --------------------------------------------------------------------------------- |
| **Action**             | `transfer_chat`                                                                   |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                                 |
| **Web API equivalent** | [`transfer_chat`](../#transfer-chat)                                              |
| **Push message**       | [`chat_transferred`](/messaging/agent-chat-api/v3.1/rtm-pushes/#chat_transferred) |

#### Request

| Parameter     | Required | Data type | Notes                                                                                                                           |
| ------------- | -------- | --------- | ------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`     | Yes      | `string`  | Resource Id                                                                                                                     |
| `target`      | No       | `object`  | If missing, the chat will be transferred within the current group.                                                              |
| `target.type` | Yes      | `string`  | `group` or `agent`                                                                                                              |
| `target.ids`  | Yes      | `array`   | `group` or `agent` IDs array                                                                                                    |
| `force`       | No       | `bool`    | If `true`, always transfers chats. Otherwise, fails when unable to assign any Agent from the requested groups; default `false`. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "transfer_chat",
  "payload": {
    "chat_id": "PWF6BACIKO",
    "target": {
      "type": "group",
      "ids": [19]
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "transfer_chat",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Chat users

### Add User to Chat

Adds a user to the chat. You can't add more than one `customer` user type to the chat.

#### Specifics

|                        |                                                                                 |
| ---------------------- | ------------------------------------------------------------------------------- |
| **Action**             | `add_user_to_chat`                                                              |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                               |
| **Web API equivalent** | [`add_user_to_chat`](../#add-user-to-chat)                                      |
| **Push message**       | [`chat_user_added`](/messaging/agent-chat-api/v3.1/rtm-pushes/#chat_user_added) |

#### Request

| Parameter   | Required | Type     | Notes                                  |
| ----------- | -------- | -------- | -------------------------------------- |
| `chat_id`   | Yes      | `string` |                                        |
| `user_id`   | Yes      | `string` |                                        |
| `user_type` | Yes      | `string` | Possible values: `agent` or `customer` |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "add_user_to_chat",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "user_id": "agent1@example.com",
    "user_type": "agent"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "add_user_to_chat",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Remove User from Chat

Removes a user from chat. Removing `customer` user type is not allowed. It's always possible to remove the requester from chat.

#### Specifics

|                        |                                                                                     |
| ---------------------- | ----------------------------------------------------------------------------------- |
| **Action**             | `remove_user_from_chat`                                                             |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                                   |
| **Web API equivalent** | [`remove_user_from_chat`](../#remove-user-from-chat)                                |
| **Push message**       | [`chat_user_removed`](/messaging/agent-chat-api/v3.1/rtm-pushes/#chat_user_removed) |

**Request payload**

| Parameter   | Required | Type     | Notes                                     |
| ----------- | -------- | -------- | ----------------------------------------- |
| `chat_id`   | Yes      | `string` |                                           |
| `user_id`   | Yes      | `string` |                                           |
| `user_type` | Yes      | `string` | Possible values are `agent` or `customer` |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "remove_user_from_chat",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "user_id": "agent1@example.com",
    "user_type": "agent"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "remove_user_from_chat",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Events

### Send Event

Sends an [Event](/messaging/agent-chat-api/v3.1/data-structures/#events) object. Use this method to send a message by specifing the [Message](/messaging/agent-chat-api/v3.1/data-structures/#message) event type in the request.

It's possible to write to a chat without joining it. The user sending an event will be automatically added to the chat with the `present` parameter set to `false` (see [`chat_user_added`](/messaging/agent-chat-api/v3.1/rtm-pushes/#chat_user_added)). **Sample use case:** a Bot Agent that sends messages visible to all chat participants without actually joining the chat.

#### Specifics

|                        |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `send_event`                                                                             |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`send_event`](../#send-event)                                                           |
| **Push message**       | [`incoming_event`](/messaging/agent-chat-api/v3.1/rtm-pushes/#incoming_event)            |

#### Request

| Parameters              | Required | Data type | Notes                                                                                                                                                             |
| ----------------------- | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`               | Yes      | `string`  | Id of the chat you want to send the message to.                                                                                                                   |
| `event`                 | Yes      | `object`  | Event object                                                                                                                                                      |
| `attach_to_last_thread` | No       | `bool`    | The flag is ignored for active chats. For inactive chats: `true` â€“ the event will be added to the last thread; `false` â€“ the request will fail. Default: `false`. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "send_event",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "event": {
      "type": "message",
      "text": "hello world",
      "recipients": "all"
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "send_event",
  "type": "response",
  "success": true,
  "payload": {
      "event_id": "K600PKZON8"
    }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Send Rich Message Postback

#### Specifics

|                        |                                                                                                                     |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------- |
| **Action**             | `send_rich_message_postback`                                                                                        |
| **Required scopes**    | `chats.conversation--my:rw` `chats.conversation--all:rw`                                                            |
| **Web API equivalent** | [`send_rich_message_postback`](../#send-rich-message-postback)                                                      |
| **Push message**       | [`incoming_rich_message_postback`](/messaging/agent-chat-api/v3.1/rtm-pushes/#incoming_rich_message_postback)**\*** |

**\*)** `incoming_rich_message_postback` will be sent only for active threads.

#### Request

| Parameter          | Required | Data type | Notes                               |
| ------------------ | -------- | --------- | ----------------------------------- |
| `chat_id`          | Yes      | `string`  |                                     |
| `event_id`         | Yes      | `string`  |                                     |
| `postback`         | Yes      | `object`  |                                     |
| `postback.id`      | Yes      | `string`  | Postback name of the button         |
| `postback.toggled` | Yes      | `bool`    | Postback toggled; `true` or `false` |
| `thread_id`        | Yes      | `string`  |                                     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "send_rich_message_postback",
  "payload": {
    "chat_id": "PJ0MRSHTDG",
    "thread_id": "K600PKZON8",
    "event_id": "a0c22fdd-fb71-40b5-bfc6-a8a0bc3117f7",
    "postback": {
      "id": "Method URL_yes",
      "toggled": true
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "send_rich_message_postback",
  "type": "response",
  "success": true,
  "payload": {
    //no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Properties

### Update Chat Properties

#### Specifics

|                        |                                                                                                 |
| ---------------------- | ----------------------------------------------------------------------------------------------- |
| **Action**             | `update_chat_properties`                                                                        |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw`        |
| **Web API equivalent** | [`update_chat_properties`](../#update-chat-properties)                                          |
| **Push message**       | [`chat_properties_updated`](/messaging/agent-chat-api/v3.1/rtm-pushes/#chat_properties_updated) |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                             |
| ------------ | -------- | --------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you to set a property for.                                                                                                                                         |
| `properties` | Yes      | `object`  | Chat properties to set. You should stick to the [general properties format](/management/configuration-api/v3.1/#properties) and include _namespace_, _property name_ and _value_. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "update_chat_properties",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "properties": {
      "bb9e5b2f1ab480e4a715977b7b1b4279": {
        "score": 10,
        "comment": "Thank you!"
      }
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "update_chat_properties",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Delete Chat Properties

#### Specifics

|                        |                                                                                                 |
| ---------------------- | ----------------------------------------------------------------------------------------------- |
| **Action**             | `delete_chat_properties`                                                                        |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw`        |
| **Web API equivalent** | [`delete_chat_properties`](../#delete-chat-properties)                                          |
| **Push message**       | [`chat_properties_deleted`](/messaging/agent-chat-api/v3.1/rtm-pushes/#chat_properties_deleted) |

#### Request

| Parameter    | Required | Data type | Notes                                           |
| ------------ | -------- | --------- | ----------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete property for. |
| `properties` | Yes      | `object`  | Chat properties to delete.                      |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "delete_chat_properties",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "properties": {
      "bb9e5b2f1ab480e4a715977b7b1b4279": ["score", "comment"]
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "delete_chat_properties",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Update Chat Thread Properties

#### Specifics

|                        |                                                                                                               |
| ---------------------- | ------------------------------------------------------------------------------------------------------------- |
| **Action**             | `update_chat_thread_properties`                                                                               |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw`                      |
| **Web API equivalent** | [`update_chat_thread_properties`](../#update-chat-thread-properties)                                          |
| **Push message**       | [`chat_thread_properties_updated`](/messaging/agent-chat-api/v3.1/rtm-pushes/#chat_thread_properties_updated) |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                             |
| ------------ | -------- | --------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to set properties for.                                                                                                                                    |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to set properties for.                                                                                                                                  |
| `properties` | Yes      | `object`  | Chat properties to set. You should stick to the [general properties format](/management/configuration-api/v3.1/#properties) and include _namespace_, _property name_ and _value_. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "update_chat_thread_properties",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "thread_id": "K600PKZON8",
    "properties": {
      "bb9e5b2f1ab480e4a715977b7b1b4279": {
        "score": 10,
        "comment": "Thank you!"
      }
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "update_chat_thread_properties",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Delete Chat Thread Properties

#### Specifics

|                        |                                                                                                               |
| ---------------------- | ------------------------------------------------------------------------------------------------------------- |
| **Action**             | `delete_chat_thread_properties`                                                                               |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw`                      |
| **Web API equivalent** | [`delete_chat_thread_properties`](../#delete-chat-thread-properties)                                          |
| **Push message**       | [`chat_thread_properties_deleted`](/messaging/agent-chat-api/v3.1/rtm-pushes/#chat_thread_properties_deleted) |

#### Request

| Parameter    | Required | Data type | Notes                                             |
| ------------ | -------- | --------- | ------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete property for.   |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to delete property for. |
| `properties` | Yes      | `object`  | Chat thread properties to delete.                 |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "delete_chat_thread_properties",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "thread_id": "K600PKZON8",
    "properties": {
      "bb9e5b2f1ab480e4a715977b7b1b4279": ["score", "comment"]
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "delete_chat_thread_properties",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Update Event Properties

#### Specifics

|                        |                                                                                                   |
| ---------------------- | ------------------------------------------------------------------------------------------------- |
| **Action**             | `update_event_properties`                                                                         |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw`          |
| **Web API equivalent** | [`update_event_properties`](../#update-event-properties)                                          |
| **Push message**       | [`event_properties_updated`](/messaging/agent-chat-api/v3.1/rtm-pushes/#event_properties_updated) |

#### Request

| Parameter    | Required | Data type | Notes                                            |
| ------------ | -------- | --------- | ------------------------------------------------ |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to set properties for.   |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to set properties for. |
| `event_id`   | Yes      | `string`  | Id of the event you want to set properties for.  |
| `properties` | Yes      | `object`  | Chat properties to set.                          |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "update_event_properties",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "thread_id": "K600PKZON8",
    "event_id": "2_EW2WQSA8",
    "properties": {
      "bb9e5b2f1ab480e4a715977b7b1b4279": {
        "score": 10,
        "comment": "Thank you!"
      }
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "update_event_properties",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Delete Event Properties

#### Specifics

|                        |                                                                                                   |
| ---------------------- | ------------------------------------------------------------------------------------------------- |
| **Action**             | `delete_event_properties`                                                                         |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw`          |
| **Web API equivalent** | [`delete_event_properties`](../#delete-event-properties)                                          |
| **Push message**       | [`event_properties_deleted`](/messaging/agent-chat-api/v3.1/rtm-pushes/#event_properties_deleted) |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                                 |
| ------------ | -------- | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete the properties of.                                                                                                                                  |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to delete the properties of.                                                                                                                                |
| `event_id`   | Yes      | `string`  | Id of the event you want to delete the properties of.                                                                                                                                 |
| `properties` | Yes      | `object`  | Event properties to delete. You should stick to the [general properties format](/management/configuration-api/v3.1/#properties) and include _namespace_, _property name_ and _value_. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "delete_event_properties",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "thread_id": "K600PKZON8",
    "event_id": "2_EW2WQSA8",
    "properties": {
      "bb9e5b2f1ab480e4a715977b7b1b4279": {
        "rating": ["score", "comment"]
      }
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "delete_event_properties",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Thread tags

### Tag Chat Thread

#### Specifics

|                        |                                                                                       |
| ---------------------- | ------------------------------------------------------------------------------------- |
| **Action**             | `tag_chat_thread`                                                                     |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                                     |
| **Web API equivalent** | [`tag_chat_thread`](../#tag-chat-thread)                                              |
| **Push message**       | [`chat_thread_tagged`](/messaging/agent-chat-api/v3.1/rtm-pushes/#chat_thread_tagged) |

#### Request

| Parameter   | Required | Data type | Notes                                      |
| ----------- | -------- | --------- | ------------------------------------------ |
| `chat_id`   | Yes      | `string`  | Id of the chat you want to add a tag to.   |
| `thread_id` | Yes      | `string`  | Id of the thread you want to add a tag to. |
| `tag`       | Yes      | `string`  | Tag name                                   |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "tag_chat_thread",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "thread_id": "PWS6GIKAKH",
    "tag": "support"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "tag_chat_thread",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Untag Chat Thread

#### Specifics

|                        |                                                                                           |
| ---------------------- | ----------------------------------------------------------------------------------------- |
| **Action**             | `untag_chat_thread`                                                                       |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`                                         |
| **Web API equivalent** | [`untag_chat_thread`](../#untag-chat-thread)                                              |
| **Push message**       | [`chat_thread_untagged`]/messaging/agent-chat-api/v3.1/rtm-pushes/(#chat_thread_untagged) |

#### Request

| Parameter   | Required | Data type | Notes                                           |
| ----------- | -------- | --------- | ----------------------------------------------- |
| `chat_id`   | Yes      | `string`  | Id of the chat you want to remove a tag from.   |
| `thread_id` | Yes      | `string`  | Id of the thread you want to remove a tag from. |
| `tag`       | Yes      | `string`  | Tag name                                        |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "untag_chat_thread",
  "payload": {
    "chat_id": "PW94SJTGW6",
    "thread_id": "PWS6GIKAKH",
    "tag": "support"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "untag_chat_thread",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

## Customers

<Section>
<Text>

### Get Customers

It returns the list of Customers.

#### Specifics

|                        |                                      |
| ---------------------- | ------------------------------------ |
| **Action**             | `get_customers`                      |
| **Required scopes**    | `customers:ro`                       |
| **Web API equivalent** | [`get_customers`](../#get-customers) |
| **Push message**       | -                                    |

#### Request

All parameters are optional.

| Parameter                                                                      | Data type | Notes                     |
| ------------------------------------------------------------------------------ | --------- | ------------------------- |
| `page_id`                                                                      | `string`  |                           |
| `limit`                                                                        | `number`  | Default: 10, maximum: 100 |
| `order` **\***                                                                 | `string`  | Default: `desc`           |
| `filters`                                                                      | `object`  |                           |
| `filters.country.<string_filter_type>` **\*\***                                | `object`  |                           |
| `filters.email.<string_filter_type>` **\*\***                                  | `object`  |                           |
| `filters.name.<string_filter_type>` **\*\***                                   | `object`  |                           |
| `filters.customer_id.<string_filter_type>` **\*\***                            | `object`  |                           |
| `filters.chats_count.<range_filter_type>` **\*\*\***                           | `object`  |                           |
| `filters.threads_count.<range_filter_type>` **\*\*\***                         | `object`  |                           |
| `filters.visits_count.<range_filter_type>` **\*\*\***                          | `object`  |                           |
| `filters.created_at.<date_range_filter_type>`**\*\*\*\***                      | `object`  |                           |
| `filters.agent_last_event_created_at.<date_range_filter_type>` **\*\*\*\***    | `object`  |                           |
| `filters.customer_last_event_created_at.<date_range_filter_type>` **\*\*\*\*** | `object`  |                           |

**\*)**

`order` can take the following values:

- `asc` - oldest customers first
- `desc` - newest customers first

**\*\*)**

`<string_filter_type>` can take the following values :

- `values` (`string[]` - an array of strings)
- `exclude_values` (`string[]` - an array of strings)

There's only one value allowed for a single filter.

**\*\*\*)**

`<range_filter_type>` can take the following values:

- `lte` (`int` - less than or equal to given value)
- `lt` (`int` - less than given value)
- `gte` (`int` - greater than or equal to given value)
- `gt` (`int` - greater than given value)
- `eq` (`int` - equal to given value)

**\*\*\*\*)**

`<date_range_filter_type>` can take the following values:

- `lte` ( `string` - less than or equal to given value)
- `lt` (`string` - less than given value)
- `gte` (`string` - greater than or equal to given value)
- `gt` (`string` - greater than given value)
- `eq` (`string` - equal to given value)

Dates are represented in ISO 8601 format with microseconds resolution, e.g. `2017-10-12T15:19:21.010200+01:00` in specific timezone or `2017-10-12T14:19:21.010200Z` in UTC.

#### Response

| Field              | Data type | Notes                                              |
| ------------------ | --------- | -------------------------------------------------- |
| `next_page_id`     | `string`  | In relation to `page_id` specified in the request. |
| `previous_page_id` | `string`  | In relation to `page_id` specified in the request. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "get_customers",
  "payload": {}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "get_customers",
  "type": "response",
  "success": true,
  "payload": {
    "customers": [
      // an array of "User > Customer" objects
    ],
    "total_customers": 2340,
    "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
    "previous_page_id": "MTUxNzM5ODEzMTQ5Ng==" // optional
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Create Customer

Creates a new [Customer](/messaging/agent-chat-api/v3.1/data-structures/#customer) user type.

#### Specifics

|                        |                                                                                   |
| ---------------------- | --------------------------------------------------------------------------------- |
| **Action**             | `create_customer`                                                                 |
| **Required scopes**    | `customers:rw`                                                                    |
| **Web API equivalent** | [`create_customer`](../#create-customer)                                          |
| **Push message**       | [`customer_created`](/messaging/agent-chat-api/v3.1/rtm-pushes/#customer_created) |

#### Request

| Parameter | Required | Data type | Notes                            |
| --------- | -------- | --------- | -------------------------------- |
| `name`    | No       | `string`  |                                  |
| `email`   | No       | `string`  |                                  |
| `avatar`  | No       | `string`  | URL of the Customer's avatar     |
| `fields`  | No       | `object`  | A map in `"key": "value"` format |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "create_customer",
  "payload": {}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "create_customer",
  "type": "response",
  "success": true,
  "payload": {
     "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Update Customer

Updates Customer's properties.

#### Specifics

|                        |                                                                                   |
| ---------------------- | --------------------------------------------------------------------------------- |
| **Action**             | `update_customer`                                                                 |
| **Required scopes**    | `customers:rw`                                                                    |
| **Web API equivalent** | [`update_customer`](../#update-customer)                                          |
| **Push message**       | [`customer_updated`](/messaging/agent-chat-api/v3.1/rtm-pushes/#customer_updated) |

#### Request

| Parameter     | Required | Data type | Notes                            |
| ------------- | -------- | --------- | -------------------------------- |
| `customer_id` | Yes      | `string`  | UUID v4 format is required.      |
| `name`        | No       | `string`  |                                  |
| `email`       | No       | `string`  |                                  |
| `avatar`      | No       | `string`  | URL of the Customer's avatar     |
| `fields`      | No       | `object`  | A map in `"key": "value"` format |

Apart from `customer_id`, which is a required parameter, you also need to include **one of the optional** parameters.

When updating customer data while the customer has an active chat, the update will take effect after the chat has ended.

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "update_customer",
  "payload": {
    "customer_id": "646d53b8-ba76-48bf-7ef1-f6d61ec4ec44",
    "name": "John Doe"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "update_customer",
  "type": "response",
  "success": true,
  "payload": {
    // "User > Customer" object
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Ban Customer

Bans the customer for a specific period of time. It immediately disconnects all active sessions of this customer and does not accept new ones during the ban lifespan.

#### Specifics

|                        |                                                                                 |
| ---------------------- | ------------------------------------------------------------------------------- |
| **Action**             | `ban_customer`                                                                  |
| **Required scopes**    | `customers.ban:rw`                                                              |
| **Web API equivalent** | [`ban_customer`](../#ban-customer)                                              |
| **Push message**       | [`customer_banned`](/messaging/agent-chat-api/v3.1/rtm-pushes/#customer_banned) |

#### Request

| Parameter     | Required | Data type |     |
| ------------- | -------- | --------- | --- |
| `customer_id` | Yes      | `string`  |     |
| `ban`         | Yes      | `object`  |     |
| `ban.days`    | Yes      | `number`  |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "ban_customer",
  "payload": {
    "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
    "ban": {
      "days": 3
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "ban_customer",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Status

### Login

It returns the initial state of the current Agent.

#### Specifics

|                        |                                                                                        |
| ---------------------- | -------------------------------------------------------------------------------------- |
| **Action**             | `login`                                                                                |
| **Required scopes**    | `chats--access:ro` `customers:ro` `multicast:ro` `agents--all:ro` `agents-bot--all:ro` |
| **Web API equivalent** | -                                                                                      |
| **Push message**       | -                                                                                      |

#### Request

| Parameter                           | Required | Data type | Notes                                                                                                                            |
| ----------------------------------- | -------- | --------- | -------------------------------------------------------------------------------------------------------------------------------- |
| `token`                             | Yes      | `string`  | OAuth token from the Agent's account                                                                                             |
| `timezone`                          | No       | `string`  |                                                                                                                                  |
| `reconnect`                         | No       | `bool`    | Reconnecting sets the status to the last known state instead of the default one.                                                 |
| `push_notifications`                | No       | `object`  |                                                                                                                                  |
| `push_notifications.firebase_token` | No       | `string`  | Firebase device token to allow connecting this instance with the existing push notification instance (to be seen as 1 instance). |
| `push_notifications.platform`       | Yes      | `string`  | OS platform; possible values:`ios`, `android`. Required only when `push_notifications` is included.                              |
| `application`                       | No       | `object`  |                                                                                                                                  |
| `application.name`                  | No       | `string`  | Application name                                                                                                                 |
| `application.version`               | No       | `string`  | Application version                                                                                                              |

#### Response

| Field        | Req./Optional |     |     |
| ------------ | ------------- | --- | --- |
| `access`     | optional      |     |     |
| `properties` | optional      |     |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
	"action": "login",
	"payload": {
		"token": "Bearer dal:test_1fgTbfXmgthj4cZSA"
		}
	}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "login",
  "type": "response",
  "success": true,
  "payload": {
    "license": {
      "id": "104130623",
      "plan": "enterprise",
      "expiration_timestamp": 1483433500,
      "creation_timestamp": 1482433500,
      "in_trial": true,
      "website_last_activity": "2018-01-05" // optional
    },
    "my_profile": {
      // "User > My profile" object
    },
    "chats_summary": [
      {
        "id": "PJ0MRSHTDG",
        "users": [
          // array of "User" objects
        ],
        "last_event_per_type": {
          // the last event of each type in chat
          "message": {
            "thread_id": "K600PKZON8",
            "thread_order": 343544565,
            "event": {
              // "restricted_access": true
              // or
              // Event > Message object
            }
          },
          "system_message": {
            "thread_id": "K600PKZON8",
            "thread_order": 343544565,
            "event": {
              // "restricted_access": true
              // or
              // Event > System Message object
            }
          }
          // ...
        },
        "last_thread_summary": {
          "id": "K600PKZON8",
          "timestamp": 1473433500,
          "user_ids": ["agent1@example.com"],
          "order": 12417249812721,
          "properties": {
            "routing": {
              "idle": {
                "value": false
              },
              "unassigned": {
                "value": false
              }
            }
            // ...
          }
        },
        "properties": {
          "routing": {
            "idle": {
              "value": false
            },
            "unassigned": {
              "value": false
            }
          }
          // ...
        },
        "access": {
          // "Access" object
        }
      }
    ]
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Set Away Status

#### Specifics

|                        |                   |
| ---------------------- | ----------------- |
| **Action**             | `set_away_status` |
| **Required scopes**    | `agents--my:rw`   |
| **Web API equivalent** | -                 |
| **Push message**       | -                 |

#### Request

| Parameter | Required | Type   |     |
| --------- | -------- | ------ | --- |
| `away`    | Yes      | `bool` |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "set_away_status",
  "payload": {
    "away": true
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "set_away_status",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Change Push Notifications

Change the firebase push notifications properties.

#### Specifics

|                        |                             |
| ---------------------- | --------------------------- |
| **Action**             | `change_push_notifications` |
| **Required scopes**    | -                           |
| **Web API equivalent** | -                           |
| **Push message**       | -                           |

#### Request

| Parameter        | Required | Data type | Notes                                                        |
| ---------------- | -------- | --------- | ------------------------------------------------------------ |
| `firebase_token` | Yes      | string    | Firebase device token                                        |
| `platform`       | Yes      | string    | OS platform; possible values: `ios`, `android`               |
| `enabled`        | Yes      | bool      | Enable or disable push notifications for the requested token |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "change_push_notifications",
  "payload": {
    "firebase_token": "test_D9dada8ja1JADA11",
    "platform": "ios",
    "enabled": true
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "change_push_notifications",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Update Agent

Updates Agent's properties.

#### Specifics

|                        |                                                                             |
| ---------------------- | --------------------------------------------------------------------------- |
| **Action**             | `update_agent`                                                              |
| **Required scopes**    | `agents--my:rw` `agents--all:rw`                                            |
| **Web API equivalent** | [`update_agent`](../#update-agent)                                          |
| **Push message**       | [`agent_updated`](/messaging/agent-chat-api/v3.1/rtm-pushes/#agent_updated) |

#### Request

| Parameter        | Required | Data type | Notes                                                     |
| ---------------- | -------- | --------- | --------------------------------------------------------- |
| `agent_id`       | No       | `string`  | The current Agent is used by default.                     |
| `routing_status` | No       | `string`  | Possible values: `accepting_chats`, `not_accepting_chats` |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "update_agent",
  "payload": {
    "agent_id": "uagent1@example.com",
    "routing_status": "accepting_chats"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "update_agent",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Logout

Logs the Agent out.

#### Specifics

|                        |          |
| ---------------------- | -------- |
| **Action**             | `logout` |
| **Required scopes**    | -        |
| **Web API equivalent** | -        |
| **Push message**       | -        |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "logout",
  "payload": {}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "logout",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

## Other

<Section>
<Text>

### Mark Events as Seen

#### Specifics

|                        |                                                                                             |
| ---------------------- | ------------------------------------------------------------------------------------------- |
| **Action**             | `mark_events_as_seen`                                                                       |
| **Required scopes**    | `chats--access:ro` `chats--all:ro`                                                          |
| **Web API equivalent** | [`mark_events_as_seen`](../#mark-events-as-seen)                                            |
| **Push message**       | [`events_marked_as_seen`](/messaging/agent-chat-api/v3.1/rtm-pushes/#events_marked_as_seen) |

#### Request

| Parameter    | Required | Data type | Notes                     |
| ------------ | -------- | --------- | ------------------------- |
| `chat_id`    | Yes      | `string`  |                           |
| `seen_up_to` | Yes      | `string`  | RFC 3339 date-time format |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "mark_events_as_seen",
  "payload": {
    "chat_id": "PJ0MRSHTDG",
    "seen_up_to": "2017-10-12T15:19:21.010200Z"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>",
  "action": "mark_events_as_seen",
  "type": "response",
  "success": true,
  "payload": {}
}
```

</CodeResponse>

</Code>
</Section>

<Section>
<Text>

### Send Typing Indicator

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `send_typing_indicator`                                                                  |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`send_typing_indicator`](../#send_typing_indicator)                                     |
| **Push message**       | -                                                                                        |

#### Request

| Parameter    | Required | Data type | Notes                                                    |
| ------------ | -------- | --------- | -------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to send the typing indicator to. |
| `recipients` | No       | `string`  | `all` (default), `agents`                                |
| `is_typing`  | Yes      | `bool`    |                                                          |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "send_typing_indicator",
  "payload": {
    "chat_id": "PJ0MRSHTDG",
    "is_typing": true
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "send_typing_indicator",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Multicast

This method serves for the **chat-unrelated communication**. Messages sent using `multicast` are not being saved.

For example, it could be used in an app that sends notifications to Agents or Customers, when a certain condition is met (e.g. an important Customer started the chat).

#### Specifics

|                        |                                                                                       |
| ---------------------- | ------------------------------------------------------------------------------------- |
| **Action**             | `multicast`                                                                           |
| **Required scopes**    | `multicast:rw`                                                                        |
| **Web API equivalent** | [`multicast`](../#multicast)                                                          |
| **Push message**       | [`incoming_multicast`](/messaging/agent-chat-api/v3.1/rtm-pushes/#incoming_multicast) |

#### Request

| Parameter | Required | Data type | Notes                     |
| --------- | -------- | --------- | ------------------------- |
| `scopes`  | Yes      | `object`  | **\***                    |
| `content` | Yes      | `any`     | A JSON message to be sent |
| `type`    | No       | `string`  | Multicast message type    |

**\*)** `scopes` can take the following values:

- `agents`:

  - `all` (`bool` - includes all agents)
  - `ids` (`[]string` - an array of agents' IDs)
  - `groups` (`[]string` - an array of groups' IDs)

- `customers`:
  - `ids` (`[]string` - an array of customer's IDs)

At least one `scopes` type (`agents.all`, `agents.ids`, `agents.groups`, `customers.ids`) is required.

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
	"action": "multicast",
	"payload": {
		"scopes": {
            "agents": {
                "all": true,
                "ids": [
                    "agent1@example.com",
                    "agent2@example.com"
                ],
                "groups": [
                    1,
                    2
                ]
            },
            "customers": {
                "ids": [
                    "b7eff798-f8df-4364-8059-649c35c9ed0c"
                ]
            }
        },
        "content": {
            "example": {
                "nested": "json"
				}
			}
		}
	}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "multicast",
  "type": "response",
  "success": true,
  "payload": {
    // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>

<Text>

# Pushes

Here's what you need to know about **pushes**:

- They are generated primarily by RTM API actions, but also by Web API actions.
- They notify you when specific events occur.
- Can be **delivered** only in the websocket transport.
- You don't need to register pushes to receive them.
- Their equivalents in Web API are [webhooks](/management/configuration-api/v3.1/#webhooks). Pushes and webhooks have similar payloads.
- There are no retries for pushes. To determine if a user has seen an event, compare the [event's](/messaging/agent-chat-api/v3.1/data-structures/#response) `created_at` parameter with the [user's](/messaging/agent-chat-api/v3.1/data-structures/#users) `events_seen_up_to` field.

<SectionLink to={"/messaging/agent-chat-api/v3.1/rtm-pushes"}>See available pushes</SectionLink>

</Text>

<Code>

<CodeResponse title={'general push format'}>

```json
{
  "request_id": "<request_id>", // optional, applies only to the requester
  "action": "<action>",
  "type": "push",
  "payload": {
    // optional payload
  }
}
```

</CodeResponse>

</Code>

</Section>

# Errors

<CodeResponse title={'General error format'}>

```json
{
  "error": {
    "type": "misdirected_request",
    "message": "Wrong region",
    "data": {
      // optional
      "region": "dal"
    }
  }
}
```

</CodeResponse>

## Possible errors

<Errors errors="authentication,authorization,internal,license_expired,pending_requests_limit_reached,requester_already_offline,requester_awaiting_approval,request_timeout,requester_suspended,seats_limit_exceeded,too_many_requests,validation,wrong_product_version"/>

# Contact us

If you found a bug or a typo, you can let us know directly on GitHub.
In case of any questions or feedback, don't hesitate to contact us at [developers@livechat.com](mailto:developers@livechat.com). We'll be happy to hear from you!

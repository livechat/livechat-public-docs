---
weight: 20
category: "messaging"
subcategory: "agent-chat-api"
title: "Web API Reference"
tagline: "Interact with the chat as an Agent."
desc: "Build powerful LiveChat integrations with an open messaging protocol. Use the Agent Chat Web API to send messages, manage access and properties."
apiVersion: "3.5"
---

import { openChatWindow } from "utils/index";

# Introduction

## Versioning

This document describes the **Agent Chat Web API v3.5**. This is the developer preview version that provides a preview of the upcoming changes to the API. **It's not open to public use.** However, if you want to test some features, contact us at developers@livechat.com or <a href="#open-chat" onClick={openChatWindow}>ask on the chat</a>, and we'll give you access. [Read more about versioning...](/messaging/#api-versioning)

## What is Web API

Web API is similar to REST API. Client can send a **request message** that results in getting a **response message**. It's also possible to get webhooks.

## When to use Web API

If you're wondering which API to use - Agent Chat **RTM API** or **Web API**, keep on reading.

**Web API** allows for building stateless integrations. The communication is done via **XHR requests**. The implementation is easier than with RTM API, but you need to take possible time delays into consideration.

**Not what you're looking for?** Perhaps, you need to use [**Agent Chat RTM API**](./rtm-reference/) instead.

## Access

The basics on authorization, access tokens, and scopes in the Agent Chat Web API.

### Authorization

**Agent authorization** is handled with access tokens. Find out how to get an **access token** from [Agent authorization flows](/authorization/authorizing-api-calls/#agent-authorization-flows). Take note **you won't be able to use this token** for the Customer Chat API.

### Scopes

All authorization scopes are listed in the [Scopes](/getting-started/authorization/scopes/) document. If a method requires certain scopes, you'll find them included in the method description. Keep in mind that Web API requires authorization every time you make a request.

## Data centers

LiveChat system operates in two data centers: `dal` (USA) and `fra` (Europe). The default data center is `dal`.

All the LiveChat OAuth 2.1 access tokens have a prefix: `dal:` or `fra:`. This prefix indicates the data center they belong to. If you need to specify the data center while making an API call, simply add the `X-Region: <token_prefix>` optional header.

Summing up, if the user token starts with `fra`, you should add the `X-Region: fra` header. If the token starts with `dal`, you donâ€™t have to specify the header.

## Rate limits

To prevent sending a massive number of requests, there are rate limits for method calls. After exceeding those limits, the requester will get a `Too many requests` error in the response of a specific request. After some time, the request will be unblocked so it can be sent again.

## Pagination

Pagination is a mechanism that allows splitting the database output into more manageable chunks of data.
Based on the `limit` and `sort order` parameters, pagination is able to decide how many records will be returned at once and whether it should fetch the oldest or the latest data first.

Any filters that could be applied should be provided in first pagination request. In the response, you'll get the `next_page_id` and `previous_page_id` parameters.
You should make the subsequent request using one of these parameters as `page_id`, depending on the direction of iteration: forward or backward.

The `filters`, `limit`, and `sort_order` parameters can't be provided along with `page_id`.

ðŸ’¡ The maximum duration of the `page_id` parameter before it expires is one month.

# Data structures

To find sample payloads of **events**, **users**, and **other common structures** such as chats or threads [visit the Data structures](/messaging/agent-chat-api/v3.5/data-structures) document.

<Section>
<Text>

# Methods

| HTTP method | The API endpoint                                         |
| ----------- | -------------------------------------------------------- |
| `POST`      | `https://api.livechatinc.com/v3.5/agent/action/<action>` |

If you specify the API version in the URL, you don't have to include the optional `"X-API-Version: 3.5"` header.

| Required Header |                   Value                    |                                          Notes |
| --------------- | :----------------------------------------: | ---------------------------------------------: |
| `Content-Type`  | `multipart/form-data; boundary=<boundary>` |             Valid for the `upload_file` method |
| `Content-Type`  |             `application/json`             | Valid for all methods except for `upload_file` |
| `Authorization` |              `Bearer <token>`              |                                   Access token |
| `X-Author-Id`   |              `<bot_agent_id>`              |                      Valid only for Bot Agents |

</Text>
<Code>
<CodeSample path={'GENERAL WEB API REQUEST FORMAT '}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/<action> \
  -H 'Content-Type: <content-type>' \
  -H 'Authorization: Bearer <your_access_token>' \
  -d '{
    // payload
    }'
```

</CodeSample>
</Code>
</Section>

## Available methods

|                 |                                                                                                                                                                                                                                                                                                                                     |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Chats**       | [`list_chats`](#list-chats) [`list_threads`](#list-threads) [`get_chat`](#get-chat) [`list_archives`](#list-archives) [`start_chat`](#start-chat) [`resume_chat`](#resume-chat) [`deactivate_chat`](#deactivate-chat) [`follow_chat`](#follow-chat) [`unfollow_chat`](#unfollow-chat)                                               |
| **Chat access** | [`transfer_chat`](#transfer-chat)                                                                                                                                                                                                                                                                                                   |
| **Chat users**  | [`add_user_to_chat`](#add-user-to-chat) [`remove_user_from_chat`](#remove-user-from-chat)                                                                                                                                                                                                                                           |
| **Events**      | [`send_event`](#send-event) [`upload_file`](#upload-file) [`send_rich_message_postback`](#send-rich-message-postback)                                                                                                                                                                                                               |
| **Properties**  | [`update_chat_properties`](#update-chat-properties) [`delete_chat_properties`](#delete-chat-properties) [`update_thread_properties`](#update-thread-properties) [`delete_thread_properties`](#delete-thread-properties) [`update_event_properties`](#update-event-properties) [`delete_event_properties`](#delete-event-properties) |
| **Thread tags** | [`tag_thread`](#tag-thread) [`untag_thread`](#untag-thread)                                                                                                                                                                                                                                                                         |
| **Customers**   | [`get_customer`](#get-customer) [`list_customers`](#list-customers) [`create_customer`](#create-customer) [`update_customer`](#update-customer) [`ban_customer`](#ban-customer) [`follow_customer`](#follow-customer) [`unfollow_customer`](#unfollow-customer)                                                                     |
| **Status**      | [`set_routing_status`](#set-routing-status) [`list_routing_statuses`](#list-routing-statuses)                                                                                                                                                                                                                                       |
| **Other**       | [`mark_events_as_seen`](#mark-events-as-seen) [`send_typing_indicator`](#send-typing-indicator) [`multicast`](#multicast) [`list_agents_for_transfer`](#list-agents-for-transfer)                                                                                                                                                   |

## Chats

<Section>
<Text>

### List Chats

It returns [summaries](/messaging/agent-chat-api/v3.5/data-structures/#chat-summaries) of the chats an Agent has access to.

#### Specifics

|                        |                                                                          |
| ---------------------- | ------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/list_chats`               |
| **Required scopes**    | `chats--all:ro` `chats--access:ro`                                       |
| **RTM API equivalent** | [`list_chats`](/messaging/agent-chat-api/v3.5/rtm-reference/#list-chats) |
| **Webhook**            | -                                                                        |

| Parameter                                             | Required | Type     | Notes                                                                                                                                                                                                                                                                |
| ----------------------------------------------------- | -------- | -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `filters`                                             | No       | `object` | When paginating, `filters` provided in the first request are remembered and automatically used for the subsequent requests. Providing a new `filters` object will result in a `validation` error.  To reset the filters, start paginating with a new set of filters. |
| `filters.include_active`                              | No       | `bool`   | Defines if the returned chat summary includes active chats; default: `true`.                                                                                                                                                                                         |
| `filters.include_chats_without_threads`               | No       | `bool`   | Defines if the returned chat summary includes chats without any threads; default: `true`.                                                                                                                                                                            |
| `filters.group_ids`                                   | No       | `array`  | Array of group IDs. Max array size: 200                                                                                                                                                                                                                              |
| `filters.properties.<namespace>.<name>.<filter_type>` | No       | `any`    |                                                                                                                                                                                                                                                                      |
| `sort_order`                                          | No       | `string` | Possible values: `asc` - oldest chats firstm `desc` - newest chats first (default)                                                                                                                                                                                   |
| `limit`                                               | No       | `number` | Default: 10, maximum: 100                                                                                                                                                                                                                                            |
| `page_id`                                             | No       | `string` |                                                                                                                                                                                                                                                                      |

`filter_type` can take the following values:

- exists (bool)
- values (type[] - array with specific type for property: `string`, `int`, or `bool`)
- exclude_values (type[] - array with specific type for property: `string`, `int`, or `bool`)

There's only one value allowed for a single property.

#### Response

| Field              | Data type | Notes                                                                                                        |
| ------------------ | --------- | ------------------------------------------------------------------------------------------------------------ |
| `chats_summary`    | `array`   | An array of [Chat summary](/messaging/agent-chat-api/v3.5/data-structures/#chat-summaries) data structures   |
| `next_page_id`     | `string`  | In relation to `page_id` specified in the request. Appears in the response only when there's a next page.    |
| `previous_page_id` | `string`  | In relation to `page_id` specified in the request Appears in the response only when there's a previous page. |
| `found_chats`      | `number`  | An estimated number. The real number of found chats can slightly differ.                                     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/list_chats \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <your_access_token>' \
  -d '{}'
```

</CodeSample>
<CodeResponse>

```json
{
  "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
  "chats_summary": [{
    "id": "PJ0MRSHTDG",
    "last_event_per_type": {
      "message": {
        "thread_id": "K600PKZON8",
        "thread_created_at": "2020-05-07T07:11:28.288340Z",
        "event": {
          "id": "Q298LUVPRH_1",
          "created_at": "2019-12-09T12:01:18.909000Z",
          "visibility": "all",
          "type": "message",
          "text": "hello world",
          "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
        }
      },
      "system_message": {
        "thread_id": "K600PKZON8",
        "thread_created_at": "2020-05-07T07:11:28.288340Z",
        "event": {
          // "System message" event
        }
      }
    },
    "users": [{
      // "Customer" user object
    }, {
      // "Agent" user object
    }],
    "last_thread_summary": {
      "id": "K600PKZON8",
      "created_at": "2020-05-07T07:11:28.288340Z",
      "user_ids": [
        "b7eff798-f8df-4364-8059-649c35c9ed0c",
        "smith@example.com"
      ],
      "properties": {
        // "Properties" object
      },
      "active": true,
      "access": {
        "group_ids": [0]
      }
    },
    "properties": {
      // "Properties" object
    },
    "access": {
      "group_ids": [0]
    },
    "is_followed": true
  }],
  "found_chats": 4
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### List Threads

It returns threads that the current Agent has access to in a given chat.

#### Specifics

|                        |                                                                              |
| ---------------------- | ---------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/list_threads`                 |
| **Required scopes**    | `chats--all:ro` `chats--access:ro`                                           |
| **RTM API equivalent** | [`list_threads`](/messaging/agent-chat-api/v3.5/rtm-reference/#list-threads) |
| **Webhook**            | -                                                                            |

#### Request

| Parameter          | Required | Data type | Notes                                                                                                                                                                                                                                                       |
| ------------------ | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`          | Yes      | `string`  |                                                                                                                                                                                                                                                             |
| `sort_order`       | No       | `string`  | Possible values: `asc` - oldest threads first and `desc` - newest threads first (default).                                                                                                                                                                  |
| `limit`            | No       | `number`  | Default: 3, maximum: 100                                                                                                                                                                                                                                    |
| `page_id`          | No       | `string`  |                                                                                                                                                                                                                                                             |
| `min_events_count` | No       | `number`  | Range: 1-100; Specifies the minimum number of events to be returned in the response. It's the **total** number of events, so they can come from more than one thread. You'll get as many latest threads as needed to meet the `min_events_count` condition. |
| `filters`          | No       | `object`  |                                                                                                                                                                                                                                                             |
| `filters.from`     | No       | `string`  | Date & time format with a resolution of microseconds, UTC string, `YYYY-MM-DDTHH:MM:SS.ssssssZHH:MM`                                                                                                                                                        |
| `filters.to`       | No       | `string`  | Date & time format with a resolution of microseconds, UTC string, `YYYY-MM-DDTHH:MM:SS.ssssssZHH:MM`                                                                                                                                                        |

You cannot use either `limit` and `min_events_count` or `filters` and `min_events_count` at the same time.

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/list_threads \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: application/json' \
  -d '{
      "chat_id": "PWJ8Y4THAV"
    }'
```

</CodeSample>

<CodeResponse>

```json
{
  "threads": [{
    "id": "K600PKZON8",
    "created_at": "2019-12-17T07:57:41.512000Z",
    "active": true,
    "user_ids": [
      "b7eff798-f8df-4364-8059-649c35c9ed0c",
      "smith@example.com"
    ],
    "events": [{
      "id": "Q20N9CKRX2_1",
      "created_at": "2019-12-17T07:57:41.512000Z",
      "visibility": "all",
      "type": "message",
      "text": "Hello",
      "author_id": "smith@example.com"
    }],
    "properties": {
      // "Property" object
    },
    "access": {
      "group_ids": [0]
    },
    "previous_thread_id": "K600PKZOM8", // optional
    "next_thread_id": "K600PKZOO8" // optional
  }],
  "found_threads": 42,
  "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
  "previous_page_id": "MTUxNzM5ODEzMTQ5Nw==" // optional
}
```

</CodeResponse>

</Code>
</Section>

<Section>
<Text>

### Get Chat

It returns a thread that the current Agent has access to in a given chat.

#### Specifics

|                        |                                                                      |
| ---------------------- | -------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/get_chat`             |
| **Required scopes**    | `chats--all:ro` `chats--access:ro`                                   |
| **RTM API equivalent** | [`get_chat`](/messaging/agent-chat-api/v3.5/rtm-reference/#get-chat) |
| **Webhook**            | -                                                                    |

#### Request

| Parameter   | Required | Data type | Notes                                  |
| ----------- | -------- | --------- | -------------------------------------- |
| `chat_id`   | Yes      | `string`  |                                        |
| `thread_id` | No       | `string`  | Default: the latest thread (if exists) |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/get_chat \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: application/json' \
  -d '{
      "chat_id": "PWJ8Y4THAV",
      "thread_id": "K600PKZON8"
    }'
```

</CodeSample>

<CodeResponse>

```json
{
  "id": "PJ0MRSHTDG",
  "thread": {
    "id": "K600PKZON8",
    "created_at": "2020-05-07T07:11:28.288340Z",
    "active": true,
    "user_ids": [
      "b7eff798-f8df-4364-8059-649c35c9ed0c",
      "smith@example.com"
    ],
    "events": [{
      "id": "Q20N9CKRX2_1",
      "created_at": "2019-12-17T07:57:41.512000Z",
      "visibility": "all",
      "type": "message",
      "text": "Hello",
      "author_id": "smith@example.com"
    }],
    "properties": {
      "0805e283233042b37f460ed8fbf22160": {
        "string_property": "string_value"
      }
    },
    "access": {
      "group_ids": [0]
    },
    "previous_thread_id": "K600PKZOM8",
    "next_thread_id": "K600PKZOO8"
  },
  "users": [{
    "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
    "type": "customer",
    "present": true,
    "created_at": "2019-12-17T08:53:20.693553+01:00",
    "statistics": {
      "chats_count": 1
    },
    "agent_last_event_created_at": "2019-12-17T09:04:05.239000+01:00"
  }, {
    "id": "smith@example.com",
    "name": "Agent Smith",
    "email": "smith@example.com",
    "type": "agent",
    "present": true,
    "avatar": "https://example.com/avatar.jpg",
    "visibility": "all"
  }],
  "properties": {
    "0805e283233042b37f460ed8fbf22160": {
      "string_property": "string_value"
    }
  },
  "access": {
    "group_ids": [0]
  },
  "is_followed": true
}
```

</CodeResponse>

</Code>
</Section>

<Section>
<Text>

### List Archives

It returns a list of the chats an Agent has access to. Together with a **chat**, the **events** of **one thread** from this chat are returned.

The list classification is based on threads; 1 chat per 1 thread. Thus, the same **chat** object may appear on the list several times, but each time with a different **thread**. The returned **chat** is a complete object, not only a **chat summary**.

#### Specifics

|                        |                                                                                |
| ---------------------- | ------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/list_archives`                  |
| **Required scopes**    | `chats--all:ro` `chats--access:ro`                                             |
| **RTM API equivalent** | [`list_archives`](/messaging/agent-chat-api/v3.5/rtm-reference/#list-archives) |
| **Webhook**            | -                                                                              |

#### Request

| Parameter                                                        | Required | Data type | Notes                                                                                                                 |
| ---------------------------------------------------------------- | -------- | --------- | --------------------------------------------------------------------------------------------------------------------- |
| `filters`                                                        | No       | `object`  |                                                                                                                       |
| `filters.query`                                                  | No       | `string`  |                                                                                                                       |
| `filters.from`                                                   | No       | `string`  | Date & time format with a resolution of microseconds, UTC string, `YYYY-MM-DDTHH:MM:SS.ssssssZHH:MM`                  |
| `filters.to`                                                     | No       | `string`  | Date & time format with a resolution of microseconds, UTC string, `YYYY-MM-DDTHH:MM:SS.ssssssZHH:MM`                  |
| `filters.thread_ids`                                             | No       | `array`   | Array of thread IDs. Cannot be used with other filters or pagination; max array size: 20.                             |
| `filters.group_ids`                                              | No       | `array`   | Array of group IDs. Max array size: 200                                                                               |
| `filters.properties.<namespace>.<name>.<properties_filter_type>` | No       | `any`     | **\* described below**                                                                                                |
| `filters.agents.<filter_type>`                                   | No       | `any`     | **\*\* described below** `exists` set to `false` will return unassigned chats; `true` will return the assigned ones.  |
| `filters.tags.<filter_type>`                                     | No       | `any`     |                                                                                                                       |
| `filters.sales.<filter_type>`                                    | No       | `any`     |                                                                                                                       |
| `filters.goals.<filter_type>`                                    | No       | `any`     |                                                                                                                       |
| `filters.surveys.<survey>`                                       | No       | `array`   | **\*\*\*** **described below**                                                                                        |
| `filters.event_types.<event_type_filter_type>`                   | No       | `any`     | **\*\*\*\*** **described below**                                                                                      |
| `filters.greetings.<greetings_filter_type>`                      | No       | `any`     | **\*\*\*\*\*\*** **described below**                                                                                  |
| `filters.agent_response.<agent_response_filter_type>`            | No       | `any`     | **\*\*\*\*\*\*\*** **described below**                                                                                |
| `filters.customer_countries.<filter_type>`                       | No       | `any`     | It supports country codes with the `ISO 3166-1 Alpha-2` format.                                                       |
| `page_id`                                                        | No       | `string`  |                                                                                                                       |
| `sort_order` **\*\*\*\*\***                                      | No       | `string`  | Default: `desc`                                                                                                       |
| `limit`                                                          | No       | `number`  | Default: 10, min: 1, max: 100                                                                                         |
| `highlights`                                                     | No       | `object`  | Use it to highlight the match of `filters.query`. To enable highlights with default parameters, pass an empty object. |
| `highlights.pre_tag`                                             | No       | `string`  | An HTML tag to use for highlighting the matched text; default: `<em>`. Use it together with `highlights.post_tag`.    |
| `highlights.post_tag`                                            | No       | `string`  | An HTML tag to use for highlighting the matched text; default: `</em>`. Use it together with `highlights.pre_tag`.    |

**\*)**
`<properties_filter_type>` can take the following values:

- `exists` (`bool`)
- `values` (`type[]` - an array with a specific type for property: `string`, `int` or `bool`)
- `exclude_values` (`type[]` - an array with a specific type for property: `string`, `int` or `bool`)

There's only one value allowed for a single property.

**\*\*)**
`<filter_type>` can take the following values:

- `exists` (`bool`)
- `values` (`type[]` - an array with a specific type for property: `string`, `int` or `bool`)
- `exclude_values` (`type[]` - an array with a specific type for property: `string`, `int` or `bool`)
- `require_every_value` (`bool`) - if set to `true`, will return only those chats that have all elements passed in `values` or `exclude_values`

You can pass only one of the following values at a time: `exists`, `values` or `exclude_values`.

**\*\*\*)**
`<survey>` contains the following fields:

- `type` (`string`) - allowed values: `pre_chat`, `post_chat`
- `answer_id` (`string`)

**\*\*\*\*)**
`<event_type_filter_type>` can take the following values:

- `values` (`string[]` - an array of [Event](#events) types, duplicates are ignored)
- `exclude_values` (`string[]` - an array of [Event](#events) types, duplicates are ignored)
- `require_every_value` (`bool`) - if set to `true`, will return only those chats that have all elements passed in `values` or `exclude_values`

You can pass only one of the following values at a time: `values` or `exclude_values`.

**\*\*\*\*\*)**
`sort_order` can take the following values:

- `asc` - the oldest chats first
- `desc` - the newest chats first

**\*\*\*\*\*\*)**
`<greetings_filter_type>` can take the following values:

- `from` (`string`) - Date & time format with a resolution of microseconds, UTC string, `YYYY-MM-DDTHH:MM:SS.ssssssZHH:MM`
- `to` (`string`) - Date & time format with a resolution of microseconds, UTC string, `YYYY-MM-DDTHH:MM:SS.ssssssZHH:MM`
- `exists` (`bool`)
- `values` (`int[]`) - an array of greeting IDs
- `exclude_values` (`int[]`) - an array of greeting IDs
- `groups.values` (`int[]`) - an array of group IDs
- `groups.exclude_values` (`int[]`) - an array of group IDs

**\*\*\*\*\*\*)**
`<agent_response_filter_type>` can take the following values:

- `exists` (`bool`)
- `first` (`bool`) - modifier that makes the other `agent_response` filters operate only on agents' first response
- `agents.values` (`string[]`) - an array of agent IDs
- `agents.exclude_values` (`string[]`) - an array of agent IDs
- `groups.values` (`int[]`) - an array of group IDs
- `groups.exclude_values` (`int[]`) - an array of group IDs

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/list_archives \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: application/json' \
  -d '{
    "filters": {
      "event_types": {
        "values": ["message", "filled_form"]
    }
  }
}'
```

</CodeSample>
<CodeResponse>

```json
{
  "chats": [
    {
      "id": "PJ0MRSHTDG",
      "users": [
        {
          "id": "smith@example.com",
          "name": "Agent Smith",
          "email": "smith@example.com",
          "type": "agent",
          "present": true,
          "avatar": "https://cdn.livechatinc.com/cloud/?uri=avatar.jpg",
          "visibility": "all"
        }
      ],
      "thread": {
        "id": "K600PKZON8",
        "active": false,
        "user_ids": [
          "smith@example.com"
        ],
        "events": [
          {
            "id": "QBT14H0Y3Y_1",
            "created_at": "2020-05-28T11:45:32.269000Z",
            "visibility": "all",
            "type": "message",
            "properties": {
              "0805e283233042b37f460ed8fbf22160": {
                "event_property": "property_value"
              }
            },
            "text": "Hello there",
            "author_id": "smith@example.com"
          }
        ],
        "properties": {
          "0805e283233042b37f460ed8fbf22160": {
            "thread_property": "property_value"
          }
        },
        "access": {
          "group_ids": [
            0
          ]
        },
        "created_at": "2020-05-28T11:44:58.829000Z",
        "previous_thread_id": "K600PKZOM8", // optional
        "next_thread_id": "K600PKZOO8", // optional
        "previous_accessible_thread_id": "K600PKZOM8", // optional
        "next_accessible_thread_id": "K600PKZOO8" // optional
      },
      "properties": {
        "0805e283233042b37f460ed8fbf22160": {
          "chat_property": "property_value"
        }
      },
      "access": {
        "group_ids": [
          0
        ]
      },
      "is_followed": false
    }
  ],
  "found_chats": 42,
  "next_page_id": "MTUxNzM5ODEzMTQ5Ng==",
  "previous_page_id": "MTUxNzM5ODEzMTQ5Ng=="
}

```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Start Chat

Starts a chat.

Authors (except the requester) of all initial events must be listed in the `users` field. The default `visibility` of both the events and users is set to `all` and cannot be changed.
The method updates the requester's `events_seen_up_to` as if they've seen all chat events.

#### Specifics

|                        |                                                                          |
| ---------------------- | ------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/start_chat`               |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                       |
| **RTM API equivalent** | [`start_chat`](/messaging/agent-chat-api/v3.5/rtm-reference/#start-chat) |
| **Webhook**            | [`incoming_chat`](/management/webhooks/v3.5/#incoming_chat)              |

#### Request

| Parameters               | Required | Data type  | Notes                                                                                                    |
| ------------------------ | -------- | ---------- | -------------------------------------------------------------------------------------------------------- |
| `chat`                   | No       | `object`   |                                                                                                          |
| `chat.properties`        | No       | `object`   |                                                                                                          |
| `chat.access`            | No       | `object`   |                                                                                                          |
| `chat.users`             | No       | `[]object` | The list of existing users. Up to 4 additional (other than the requester) agents and 1 customer allowed. |
| `chat.users.id`          | Yes      | `string`   | User ID                                                                                                  |
| `chat.users.type`        | Yes      | `string`   | `agent` or `customer`                                                                                    |
| `chat.thread`            | No       | `object`   |                                                                                                          |
| `chat.thread.events`     | No       | `array`    | The list of initial chat events.                                                                         |
| `chat.thread.properties` | No       | `object`   |                                                                                                          |
| `active`                 | No       | `bool`     | When set to `false`, creates an inactive thread; default: `true`.                                        |
| `continuous`             | No       | `bool`     | Starts chat as continuous (online group is not required); default: `false`.                              |

#### Response

| Field       | Data type  | Notes                                                                                                                                                                   |
| ----------- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`   | `string`   |                                                                                                                                                                         |
| `thread_id` | `string`   |                                                                                                                                                                         |
| `event_ids` | `[]string` | Returned only when the chat was started with initial events. Returns only the IDs of user-generated events; server-side generated events are not included in the array. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/start_chat \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: application/json' \
  -d '{}'
```

</CodeSample>
<CodeResponse>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "PGDGHT5G"
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Resume Chat

Restarts an archived chat.

Authors (except the requester) of all initial events must be listed in the `users` field. The default `visibility` of both the events and users is set to `all` and cannot be changed.
The method updates the requester's `events_seen_up_to` as if they've seen all chat events.

#### Specifics

|                        |                                                                            |
| ---------------------- | -------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/resume_chat`                |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                         |
| **RTM API equivalent** | [`resume_chat`](/messaging/agent-chat-api/v3.5/rtm-reference/#resume-chat) |
| **Webhook**            | [`incoming_chat`](/management/webhooks/v3.5/#incoming_chat)                |

#### Request

| Parameter                | Required | Data type  | Notes                                                                                                    |
| ------------------------ | -------- | ---------- | -------------------------------------------------------------------------------------------------------- |
| `chat`                   | Yes      | `object`   |                                                                                                          |
| `chat.id`                | Yes      | `string`   | ID of the chat that will be resumed.                                                                     |
| `chat.access`            | No       | `object`   | Chat access to set, default: all agents.                                                                 |
| `chat.properties`        | No       | `object`   | Initial chat properties                                                                                  |
| `chat.users`             | No       | `[]object` | The list of existing users. Up to 4 additional (other than the requester) agents and 1 customer allowed. |
| `chat.users.id`          | Yes      | `string`   | User ID                                                                                                  |
| `chat.users.type`        | Yes      | `string`   | `agent` or `customer`                                                                                    |
| `chat.thread`            | No       | `object`   |                                                                                                          |
| `chat.thread.events`     | No       | `array`    | Initial chat events array                                                                                |
| `chat.thread.properties` | No       | `object`   | Initial thread properties                                                                                |
| `active`                 | No       | `bool`     | When set to `false`, creates an inactive thread; default: `true`.                                        |
| `continuous`             | No       | `bool`     | Sets a chat to the continuous mode. When unset, leaves the mode unchanged.                               |

#### Response

| Field       | Data type  | Notes                                                                                                                                                                   |
| ----------- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `thread_id` | `string`   |                                                                                                                                                                         |
| `event_ids` | `[]string` | Returned only when the chat was resumed with initial events. Returns only the IDs of user-generated events; server-side generated events are not included in the array. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/resume_chat \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: application/json' \
  -d '{
    "chat": {
      "id": "PWJ8Y4THAV"
      }
    }'
```

</CodeSample>
<CodeResponse>

```json
{
  "thread_id": "Z8AGR5OUW"
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Deactivate Chat

Deactivates a chat by closing the currently open thread. Sending messages to this thread will no longer be possible.

The requester must be present on the list of chat users. You can override it by setting the `ignore_requester_presence` parameter.

#### Specifics

|                        |                                                                                    |
| ---------------------- | ---------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/deactivate_chat`                    |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                 |
| **RTM API equivalent** | [`deactivate_chat`](/messaging/agent-chat-api/v3.5/rtm-reference/#deactivate-chat) |
| **Webhook**            | [`chat_deactivated`](/management/webhooks/v3.5/#chat_deactivated)                  |

#### Request

| Parameter                   | Required | Data type | Notes                                                                                           |
| --------------------------- | -------- | --------- | ----------------------------------------------------------------------------------------------- |
| `id`                        | Yes      | `string`  |                                                                                                 |
| `ignore_requester_presence` | No       | `bool`    | If `true`, the requester doesn't need to be present on the list of chat users; default `false`. |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/deactivate_chat \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: application/json' \
  -d '{
    "id": "PJ0MRSHTDG"
    }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Follow Chat

Marks a chat as followed. All changes to the chat will be sent to the requester until the chat is reactivated or unfollowed. Chat members don't need to follow their chats. They receive all chat pushes regardless of their follower status.

#### Specifics

|                        |                                                                            |
| ---------------------- | -------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/follow_chat`                |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                         |
| **RTM API equivalent** | [`follow_chat`](/messaging/agent-chat-api/v3.5/rtm-reference/#follow-chat) |
| **Webhook**            | -                                                                          |

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `id`      | Yes      | `string`  |     |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/follow_chat \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
  "id": "PW94SJTGW6"
  }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Unfollow Chat

Removes the requester from the chat followers. After that, only key changes to the chat (like `transfer_chat` or `close_active_thread`) will be sent to the requester. Chat members cannot unfollow the chat.

#### Specifics

|                        |                                                                                |
| ---------------------- | ------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/unfollow_chat`                  |
| **Required scopes**    | -                                                                              |
| **RTM API equivalent** | [`unfollow_chat`](/messaging/agent-chat-api/v3.5/rtm-reference/#unfollow-chat) |
| **Webhook**            | -                                                                              |

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `id`      | Yes      | `string`  |     |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/unfollow_chat \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "id": "PJ0MRSHTDG"
  }'
```

</CodeSample>
</Code>
</Section>

## Chat access

<Section>
<Text>

### Transfer Chat

Transfers a chat to an agent or a group. The following restrictions apply:

- The transferred chat must be active.
- The requester must be present on the list of chat users.
  - You can override it by setting the `ignore_requester_presence` parameter.
- When transferring directly to an agent, the agent must have access to the transferred chat.

#### Specifics

|                        |                                                                                |
| ---------------------- | ------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/transfer_chat`                  |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                             |
| **RTM API equivalent** | [`transfer_chat`](/messaging/agent-chat-api/v3.5/rtm-reference/#transfer-chat) |
| **Webhook**            | [`chat_transferred`](/management/webhooks/v3.5/#chat_transferred)              |

#### Request

| Parameter                    | Required | Data type | Notes                                                                                                                                                                  |
| ---------------------------- | -------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `id`                         | Yes      | `string`  | Chat ID                                                                                                                                                                |
| `target`                     | No       | `object`  | If missing, the chat will be transferred within the current group.                                                                                                     |
| `target.type`                | Yes      | `string`  | `group` or `agent`                                                                                                                                                     |
| `target.ids`                 | Yes      | `array`   | `group` or `agent` IDs array                                                                                                                                           |
| `ignore_agents_availability` | No       | `bool`    | If `true`, allows the chat to be enqueued after the transfer. Otherwise, fails when unable to immediately assign any agent from the requested groups; default `false`. |
| `ignore_requester_presence`  | No       | `bool`    | If `true`, the requester doesn't need to be present on the list of chat users; default `false`.                                                                        |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/transfer_chat \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "id": "PJ0MRSHTDG",
    "target": {
      "type": "group",
      "ids": [
        19
      ]
    }
  }'
```

</CodeSample>
</Code>
</Section>

## Chat users

<Section>
<Text>

### Add User to Chat

Adds a user to the chat. The following restrictions apply:

- The chat must be active.
- The requester must be present on the list of chat users.
  - You can override it by setting the `ignore_requester_presence` parameter.
- You can't have more than one `customer` in the chat.
- Additional agents must also have access to the chat.
- `customer` must be added with `visibility:all`.

To learn how to add more than one agent to the chat, reach out to us [on Discord](https://discord.gg/gRzwSaCxg4) or via email, developers@livechat.com.

#### Specifics

|                        |                                                                                      |
| ---------------------- | ------------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/add_user_to_chat`                     |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                   |
| **RTM API equivalent** | [`add_user_to_chat`](/messaging/agent-chat-api/v3.5/rtm-reference/#add-user-to-chat) |
| **Webhook**            | [`user_added_to_chat`](/management/webhooks/v3.5/#user_added_to_chat)                |

#### Request

| Parameter                   | Required | Type     | Notes                                                                                           |
| --------------------------- | -------- | -------- | ----------------------------------------------------------------------------------------------- |
| `chat_id`                   | Yes      | `string` |                                                                                                 |
| `user_id`                   | Yes      | `string` |                                                                                                 |
| `user_type`                 | Yes      | `string` | Possible values: `agent` or `customer`                                                          |
| `visibility`                | Yes      | `string` | Possible values: `all` or `agents`                                                              |
| `ignore_requester_presence` | No       | `bool`   | If `true`, the requester doesn't need to be present on the list of chat users; default `false`. |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/add_user_to_chat \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "chat_id": "PW94SJTGW6",
    "user_id": "smith@example.com",
    "user_type": "agent",
    "visibility": "all",
    "require_active_thread": true
  }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Remove User from Chat

Removes a user from chat. The following restrictions apply:

- You can't remove the `customer`.
- The requester must be present on the list of chat users.
  - You can override it by setting the `ignore_requester_presence` parameter.

#### Specifics

|                        |                                                                                                |
| ---------------------- | ---------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/remove_user_from_chat`                          |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                             |
| **RTM API equivalent** | [`remove_user_from_chat`](/messaging/agent-chat-api/v3.5/rtm-reference/#remove-user-from-chat) |
| **Webhook**            | [`user_removed_from_chat`](/management/webhooks/v3.5/#user_removed_from_chat)                  |

#### Request

| Parameter                   | Required | Type     | Notes                                                                                           |
| --------------------------- | -------- | -------- | ----------------------------------------------------------------------------------------------- |
| `chat_id`                   | Yes      | `string` |                                                                                                 |
| `user_id`                   | Yes      | `string` |                                                                                                 |
| `user_type`                 | Yes      | `string` | Possible values are `agent` or `customer`                                                       |
| `ignore_requester_presence` | No       | `bool`   | If `true`, the requester doesn't need to be present on the list of chat users; default `false`. |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/remove_user_from_chat \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "chat_id": "PW94SJTGW6",
    "user_id": "smith@example.com",
    "user_type": "agent"
  }'
```

</CodeSample>
</Code>
</Section>

## Events

<Section>
<Text>

### Send Event

Sends an [Event](/messaging/agent-chat-api/v3.5/data-structures/#events) object. Use this method to send a message by specifying the [Message](/messaging/agent-chat-api/v3.5/data-structures/#message) event type in the request.

The user must be [added to the chat](/messaging/agent-chat-api/rtm-pushes/#user_added_to_chat) before they can send an event.
Events with `visibility:agents` are sent to agents only, and with `visibility:all` to all users. Users with `visibility:agents` cannot send events with `visibility:all`.

The method updates the requester's `events_seen_up_to` as if they've seen all chat events.

To call the API as a bot, use the `X-Author-Id` header set to the bot's id.

#### Specifics

|                        |
| ---------------------- | ------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/send_event`               |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                       |
| **RTM API equivalent** | [`send_event`](/messaging/agent-chat-api/v3.5/rtm-reference/#send-event) |
| **Webhook**            | [`incoming_event`](/management/webhooks/v3.5/#incoming_event)            |

#### Request

| Parameter               | Required | Data type | Notes                                                                                                                                                             |
| ----------------------- | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`               | Yes      | `string`  | Id of the chat you want to send a message to.                                                                                                                     |
| `event`                 | Yes      | `object`  | Event object                                                                                                                                                      |
| `attach_to_last_thread` | No       | `bool`    | The flag is ignored for active chats. For inactive chats: `true` â€“ the event will be added to the last thread; `false` â€“ the request will fail. Default: `false`. |

#### Response

| Field      | Data type |
| ---------- | --------- |
| `event_id` | `string`  |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/send_event \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
   "chat_id": "PW94SJTGW6",
   "event": {
     "type": "message",
     "text": "hello world",
     "visibility": "all"
     }
   }'
```

</CodeSample>
<CodeResponse>

```json
{
  "event_id": "K600PKZON8"
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Upload File

Uploads a file to the server as a temporary file. It returns a URL that expires after 24 hours unless the URL is used in [`send_event`](#send-event).

#### Specifics

|                        |                                                                      |
| ---------------------- | -------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/upload_file`          |
| **RTM API equivalent** | -                                                                    |
| **Webhook**            | [`incoming_event`](/management/webhooks/v3.5/#incoming_event) **\*** |

**\*)**
`incoming_event` returns a URL that never expires.

#### Request

| Parameter | Required | Data type | Notes              |
| --------- | -------- | --------- | ------------------ |
| `file`    | Yes      | `binary`  | maximum size: 10MB |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/upload_file \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: multipart/form-data; boundary=--------------------------210197025774705439685896' \
  -H 'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW' \
  -F file=@/Users/MyAccount/Desktop/image.png
```

</CodeSample>
<CodeResponse>

```json
{
  "url": "https://cdn.livechat-files.com/api/file/lc/att/8948324/45a3581b59a7295145c3825c86ec7ab3/image.png"
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Send Rich Message Postback

#### Specifics

|                        |                                                                                                          |
| ---------------------- | -------------------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/send_rich_message_postback`                               |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                                       |
| **RTM API equivalent** | [`send_rich_message_postback`](/messaging/agent-chat-api/v3.5/rtm-reference/#send-rich-message-postback) |
| **Webhook**            | [`incoming_rich_message_postback`](/management/webhooks/v3.5/#incoming_rich_message_postback)**\***      |

**\*)** `incoming_rich_message_postback` will be sent only for active threads.

#### Request

| Parameter          | Required | Data type | Notes                       |
| ------------------ | -------- | --------- | --------------------------- |
| `chat_id`          | Yes      | `string`  |                             |
| `event_id`         | Yes      | `string`  |                             |
| `postback`         | Yes      | `object`  |                             |
| `postback.id`      | Yes      | `string`  | Postback name of the button |
| `postback.toggled` | Yes      | `bool`    | Postback toggled true/false |
| `thread_id`        | Yes      | `string`  |                             |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/send_rich_message_postback \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
   "chat_id": "PJ0MRSHTDG",
   "thread_id": "K600PKZON8",
   "event_id": "a0c22fdd-fb71-40b5-bfc6-a8a0bc3117f7",
   "postback": {
     "id": "Method URL_yes",
     "toggled": true
     }
   }'
```

</CodeSample>
</Code>
</Section>

## Properties

<Section>
<Text>

### Update Chat Properties

#### Specifics

|                        |                                                                                                  |
| ---------------------- | ------------------------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/update_chat_properties`                           |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                               |
| **RTM API equivalent** | [`update_chat_properties`](/messaging/agent-chat-api/v3.5/rtm-reference/#update-chat-properties) |
| **Webhook**            | [`chat_properties_updated`](/management/webhooks/v3.5/#chat_properties_updated)                  |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                        |
| ------------ | -------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `id`         | Yes      | `string`  | Id of the chat you to set properties for.                                                                                                                                    |
| `properties` | Yes      | `object`  | Chat properties to set. You should stick to the [general properties format](/management/configuration-api/#properties) and include _namespace_, _property name_ and _value_. |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/update_chat_properties \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
  "id": "Q1VZR7AJCE",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": {
      "string_property": "Chat property value updated by Agent"
        }
     }
  }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Delete Chat Properties

#### Specifics

|                        |                                                                                                  |
| ---------------------- | ------------------------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/delete_chat_properties`                           |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                               |
| **RTM API equivalent** | [`delete_chat_properties`](/messaging/agent-chat-api/v3.5/rtm-reference/#delete-chat-properties) |
| **Webhook**            | [`chat_properties_deleted`](/management/webhooks/v3.5/#chat_properties_deleted)                  |

#### Request

| Parameter    | Required | Data type | Notes                                          |
| ------------ | -------- | --------- | ---------------------------------------------- |
| `id`         | Yes      | `string`  | Id of the chat you want to delete property of. |
| `properties` | Yes      | `object`  | Chat properties to delete.                     |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
  curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/delete_chat_properties \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: application/json' \
  -d '{
    "id": "Q1VZR7AJCE",
    "properties": {
      "0805e283233042b37f460ed8fbf22160": [
        "string_property"
        ]
      }
    }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Update Thread Properties

#### Specifics

|                        |                                                                                                      |
| ---------------------- | ---------------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/update_thread_properties`                             |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                                   |
| **RTM API equivalent** | [`update_thread_properties`](/messaging/agent-chat-api/v3.5/rtm-reference/#update-thread-properties) |
| **Webhook**            | [`thread_properties_updated`](/management/webhooks/v3.5/#thread_properties_updated)                  |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                        |
| ------------ | -------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to set properties for.                                                                                                                               |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to set properties for.                                                                                                                             |
| `properties` | Yes      | `object`  | Chat properties to set. You should stick to the [general properties format](/management/configuration-api/#properties) and include _namespace_, _property name_ and _value_. |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.5/agent/action/update_thread_properties \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: application/json' \
  -d '{
    "chat_id": "Q1WZ073OA7",
    "thread_id": "Q1WZ073OB7",
    "properties": {
      "0805e283233042b37f460ed8fbf22160": {
        "string_property": "Chat thread property value updated by Agent"
        }
      }
    }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Delete Thread Properties

#### Specifics

|                        |                                                                                                      |
| ---------------------- | ---------------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/delete_thread_properties`                             |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                                   |
| **RTM API equivalent** | [`delete_thread_properties`](/messaging/agent-chat-api/v3.5/rtm-reference/#delete-thread-properties) |
| **Webhook**            | [`thread_properties_deleted`](/management/webhooks/v3.5/#thread_properties_deleted)                  |

#### Request

| Parameter    | Required | Data type | Notes                                              |
| ------------ | -------- | --------- | -------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete properties of.   |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to delete properties of. |
| `properties` | Yes      | `object`  | Thread properties to delete.                       |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/delete_thread_properties \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
  "chat_id": "Q1WZ073OA7",
  "thread_id": "Q1WZ073OB7",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": [
      "string_property"
      ]
    }
  }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Update Event Properties

#### Specifics

|                        |                                                                                                    |
| ---------------------- | -------------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/update_event_properties`                            |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                                 |
| **RTM API equivalent** | [`update_event_properties`](/messaging/agent-chat-api/v3.5/rtm-reference/#update-event-properties) |
| **Webhook**            | [`event_properties_updated`](/management/webhooks/v3.5/#event_properties_updated)                  |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                        |
| ------------ | -------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to set properties for.                                                                                                                               |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to set properties for.                                                                                                                             |
| `event_id`   | Yes      | `string`  | Id of the event you want to set properties for.                                                                                                                              |
| `properties` | Yes      | `object`  | Chat properties to set. You should stick to the [general properties format](/management/configuration-api/#properties) and include _namespace_, _property name_ and _value_. |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/update_event_properties \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
  "chat_id": "Q1GZ3FNAT9",
  "thread_id": "Q1GZ3FNAU9",
  "event_id": "Q1GZ3FNAU9_1",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": {
      "string_property": "Event property value updated by Agent"
      }
    }
  }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Delete Event Properties

#### Specifics

|                        |                                                                                                    |
| ---------------------- | -------------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/delete_event_properties`                            |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                                 |
| **RTM API equivalent** | [`delete_event_properties`](/messaging/agent-chat-api/v3.5/rtm-reference/#delete-event-properties) |
| **Webhook**            | [`event_properties_deleted`](/management/webhooks/v3.5/#event_properties_deleted)                  |

#### Request

| Parameter    | Required | Data type | Notes                                                  |
| ------------ | -------- | --------- | ------------------------------------------------------ |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete the properties of.   |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to delete the properties of. |
| `event_id`   | Yes      | `string`  | Id of the event you want to delete the properties of.  |
| `properties` | Yes      | `object`  | Event properties to delete.                            |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/delete_event_properties \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
  "chat_id": "Q16ZSBGX3J",
  "thread_id": "Q16ZSBGX4J",
  "event_id": "Q16ZSBGX4J_1",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": [
      "string_property"
      ]
    }
  }'
```

</CodeSample>
</Code>
</Section>

## Thread tags

<Section>
<Text>

### Tag Thread

Tags a given **thread**. 

Read how to [list all available chats](/management/configuration-api/v3.5#list-tags) and [create a new tag](/management/configuration-api/v3.5#create-tag). In this method, `tag` is case sensitive.

#### Specifics

|                        |                                                                          |
| ---------------------- | ------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/tag_thread`               |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                       |
| **RTM API equivalent** | [`tag_thread`](/messaging/agent-chat-api/v3.5/rtm-reference/#tag-thread) |
| **Webhook**            | [`thread_tagged`](/management/webhooks/v3.5/#thread_tagged)              |

#### Request

| Parameter   | Required | Data type | Notes                                      |
| ----------- | -------- | --------- | ------------------------------------------ |
| `chat_id`   | Yes      | `string`  | Id of the chat you want to add a tag to.   |
| `thread_id` | Yes      | `string`  | Id of the thread you want to add a tag to. |
| `tag`       | Yes      | `string`  | Tag name                                   |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/tag_thread \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
  "chat_id": "PW94SJTGW6",
  "thread_id": "PWS6GIKAKH",
  "tag": "support"
   }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Untag Thread

Untags a given **thread**. In this method, `tag` is case sensitive.

#### Specifics

|                        |                                                                              |
| ---------------------- | ---------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/untag_thread`                 |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                           |
| **RTM API equivalent** | [`untag_thread`](/messaging/agent-chat-api/v3.5/rtm-reference/#untag-thread) |
| **Webhook**            | [`thread_untagged`](/management/webhooks/v3.5/#thread_untagged)              |

#### Request

| Parameter   | Required | Data type | Notes                                           |
| ----------- | -------- | --------- | ----------------------------------------------- |
| `chat_id`   | Yes      | `string`  | Id of the chat you want to remove a tag from.   |
| `thread_id` | Yes      | `string`  | Id of the thread you want to remove a tag from. |
| `tag`       | Yes      | `string`  | Tag name                                        |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/untag_thread \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
  "chat_id": "PW94SJTGW6",
  "thread_id": "PWS6GIKAKH",
  "tag": "support"
   }'
```

</CodeSample>
</Code>
</Section>

## Customers

<Section>
<Text>

### Get Customer

Returns the info about the Customer with a given `id`.

#### Specifics

|                        |                                                                              |
| ---------------------- | ---------------------------------------------------------------------------- |
| **Action**             | `get_customer`                                                               |
| **Required scopes**    | `customers:ro`                                                               |
| **RTM API equivalent** | [`get_customer`](/messaging/agent-chat-api/v3.5/rtm-reference/#get-customer) |
| **Push message**       | -                                                                            |

#### Request

| Parameter | Required | Data type | Notes |
| --------- | -------- | --------- | ----- |
| `id`      | Yes      | string    |       |

#### Response

| Field            | Data type | Notes                                                                                                                             |
| ---------------- | --------- | --------------------------------------------------------------------------------------------------------------------------------- |
| `id`             | string    | [Customer's](/messaging/agent-chat-api/v3.5/data-structures/#customer) ID.                                                        |
| `type`           | string    | `customer`                                                                                                                        |
| `name`           | string    | Customer's name. Returned only if set.                                                                                            |
| `email`          | string    | Customer's email. Returned only if set.                                                                                           |
| `avatar`         | string    | Customer's avatar. Returned only if set.                                                                                          |
| `created_at`     | string    | Specifies when the customer's identity was created.                                                                               |
| `session_fields` | []object  | An array of custom object-enclosed `key:value` pairs. Returned only if set. Available for the session duration.                   |
| `statistics`     | object    | Counters for started threads, opened pages, etc.                                                                                  |
| `last_visit`     | object    | Geolocation and opened pages from the customer's most recent online visit. Returned only if the customer logged in at least once. |
| `chat_ids`       | []string  | IDs of a customer's chats. Returned only if the customer had at least one chat.                                                   |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/get_customer \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
  }'
```

</CodeSample>
<CodeResponse>

```json
{
  "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "type": "customer",
  "created_at": "2017-10-11T15:19:21.010200Z",
  "name": "Thomas Anderson",
  "email": "t.anderson@example.com",
  "avatar": "example.com/avatars/1.jpg",
  "session_fields": [{
    "custom_key": "custom_value"
  }, {
    "another_custom_key": "another_custom_value"
  }],
  "last_visit": {
    "started_at": "2017-10-12T15:19:21.010200Z",
    "ended_at": "2017-10-12T15:20:22.010200Z",
    "referrer": "http://www.google.com/",
    "ip": "<customer_ip>",
    "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36",
    "geolocation": {
      "latitude": "-14.6973803",
      "longitude": "-75.1266898",
      "country": "Poland",
      "country_code": "PL",
      "region": "Dolnoslaskie",
      "city": "Wroclaw",
      "timezone": "Europe/Warsaw"
    },
    "last_pages": [{
      "opened_at": "2017-10-12T15:19:21.010200Z",
      "url": "https://www.livechat.com/",
      "title": "LiveChat - Homepage"
    }, {
      "opened_at": "2017-10-12T15:19:21.010200Z",
      "url": "https://www.livechat.com/tour",
      "title": "LiveChat - Tour"
    }]
  },
  "statistics": {
  "chats_count": 3,
  "threads_count": 9,
  "visits_count": 5,
  "page_views_count": 1337,
  "greetings_shown_count": 69,
  "greetings_accepted_count": 42
  },
  "__priv_lc2_customer_id": "test_771305.dafea66e5c", // old customer_id
  "agent_last_event_created_at": "2017-10-12T15:19:21.010200Z",
  "customer_last_event_created_at": "2017-10-12T15:19:21.010200Z",
  "chat_ids": [
  "PWJ8Y4THAV"
  ]
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### List Customers

It returns the list of Customers.

#### Specifics

|                        |                                                                                  |
| ---------------------- | -------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/list_customers`                   |
| **Required scopes**    | `customers:ro`                                                                   |
| **RTM API equivalent** | [`list_customers`](/messaging/agent-chat-api/v3.5/rtm-reference/#list_customers) |
| **Webhook**            | -                                                                                |

#### Request

All parameters are optional.

| Parameter                                                                        | Data type | Notes                        |
| -------------------------------------------------------------------------------- | --------- | ---------------------------- |
| `page_id`                                                                        | `string`  |                              |
| `limit`                                                                          | `number`  | Default: 10, maximum: 100    |
| `sort_order` **\***                                                              | `string`  | Default: `desc`              |
| `sort_by` **\*\***                                                               | `string`  | Default: `created_at`        |
| `filters`                                                                        | `object`  |                              |
| `filters.country.<string_filter_type>` **\*\*\***                                | `object`  |                              |
| `filters.email.<string_filter_type>` **\*\*\***                                  | `object`  |                              |
| `filters.name.<string_filter_type>` **\*\*\***                                   | `object`  |                              |
| `filters.customer_id.<string_filter_type>` **\*\*\***                            | `object`  |                              |
| `filters.chats_count.<range_filter_type>` **\*\*\*\***                           | `object`  |                              |
| `filters.threads_count.<range_filter_type>` **\*\*\*\***                         | `object`  |                              |
| `filters.visits_count.<range_filter_type>` **\*\*\*\***                          | `object`  |                              |
| `filters.created_at.<date_range_filter_type>`**\*\*\*\*\***                      | `object`  |                              |
| `filters.agent_last_event_created_at.<date_range_filter_type>` **\*\*\*\*\***    | `object`  |                              |
| `filters.customer_last_event_created_at.<date_range_filter_type>` **\*\*\*\*\*** | `object`  |                              |
| `filters.chat_group_ids.<integer_filter_type>`  **\*\*\***                       | `object`  | Maximum 40 group ids at once |
| `filters.include_customers_without_chats`                                        | `bool`    |                              |

**\*)**

`sort_order` can take the following values:

- `asc`
- `desc`

**\*\*)**

`sort_by` can take the following values:

- `created_at`
- `threads_count`
- `visits_count`
- `agent_last_event`
- `customer_last_event`

When sorting by fields other than `created_at`, the entries with identical values will be additionally sorted by their creation time.

**\*\*\*)**

`<string_filter_type>` can take the following values :

- `values` (`string[]` - an array of strings)
- `exclude_values` (`string[]` - an array of strings)

`<integer_filter_type>` can take the following values:

- `values` (`int[]` - an array of integers)
- `exclude_values` (`int[]` - an array of integers)

There's only one value allowed for a single filter.

**\*\*\*\*)**

`<range_filter_type>` can take the following values:

- `lte` (`int` - less than or equal to given value)
- `lt` (`int` - less than given value)
- `gte` (`int` - greater than or equal to given value)
- `gt` (`int` - greater than given value)
- `eq` (`int` - equal to given value)

**\*\*\*\*\*)**

`<date_range_filter_type>` can take the following values:

- `lte` ( `string` - less than or equal to given value)
- `lt` (`string` - less than given value)
- `gte` (`string` - greater than or equal to given value)
- `gt` (`string` - greater than given value)
- `eq` (`string` - equal to given value)

Dates are represented in ISO 8601 format with microseconds resolution, e.g. `2017-10-12T15:19:21.010200+01:00` in specific timezone or `2017-10-12T14:19:21.010200Z` in UTC.

#### Response

| Field              | Data type | Notes                                              |
| ------------------ | --------- | -------------------------------------------------- |
| `next_page_id`     | `string`  | In relation to `page_id` specified in the request. |
| `previous_page_id` | `string`  | In relation to `page_id` specified in the request. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/list_customers \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{}'
```

</CodeSample>
<CodeResponse>

```json
{
  "customers": [
  // array of "User > Customer" objects
  ],
  "total_customers": 2340,
  "limited_customers": 120, // optional
  "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
  "previous_page_id": "MTUxNzM5ODEzMTQ5Ng==" // optional
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Create Customer

Creates a new [Customer](/messaging/agent-chat-api/v3.5/data-structures/#customer) user type.

#### Specifics

|                        |                                                                                    |
| ---------------------- | ---------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/create_customer`                    |
| **Required scopes**    | `customers:rw`                                                                     |
| **RTM API equivalent** | [`create_customer`](/messaging/agent-chat-api/v3.5/rtm-reference/#create-customer) |
| **Webhook**            | [`incoming_customer`](/management/webhook/v3.5/#incoming_customer)                 |

#### Request

| Parameter        | Required | Data type  | Notes                                                                              |
| ---------------- | -------- | ---------- | ---------------------------------------------------------------------------------- |
| `name`           | No       | `string`   |                                                                                    |
| `email`          | No       | `string`   |                                                                                    |
| `avatar`         | No       | `string`   | URL of the Customer's avatar                                                       |
| `session_fields` | No       | `[]object` | An array of custom object-enclosed `key:value` pairs. Respects the order of items. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/create_customer \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "name": "Thomas Anderson",
    "email": "t.anderson@example.com",
    "avatar": "https://example.com/avatars/1.png",
    "session_fields": [{
    "custom_key": "custom_value"
    }, {
    "another_custom_key": "another_custom_value"
    }]
  }'
```

</CodeSample>
<CodeResponse>

```json
{
  "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Update Customer

Updates Customer's properties.

#### Specifics

|                        |                                                                                                        |
| ---------------------- | ------------------------------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/update_customer`                                        |
| **Required scopes**    | `customers:rw`                                                                                         |
| **RTM API equivalent** | [`update_customer`](/messaging/agent-chat-api/v3.5/rtm-reference/#update-customer)                     |
| **Webhook**            | [`customer_session_fields_updated`](/management/webhooks/v3.5/#customer_session_fields_updated) **\*** |

**\***
The webhook will be sent only if the customer has active chats.

#### Request

| Parameter        | Required | Data type  | Notes                                                                              |
| ---------------- | -------- | ---------- | ---------------------------------------------------------------------------------- |
| `id`             | Yes      | `string`   | UUID v4 format is required                                                         |
| `name`           | No       | `string`   |                                                                                    |
| `email`          | No       | `string`   |                                                                                    |
| `avatar`         | No       | `string`   | URL of the Customer's avatar                                                       |
| `session_fields` | No       | `[]object` | An array of custom object-enclosed `key:value` pairs. Respects the order of items. |

Apart from `id`, which is a required parameter, you also need to include **one of the optional** parameters.

When updating customer data while the customer has an active chat, the update will take effect after the chat has ended.

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/update_customer \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
    "name": "Thomas Anderson",
    "email": "t.anderson@example.com",
    "avatar": "https://example.com/avatars/1.png",
    "session_fields": [{
    "custom_key": "custom_value"
    }, {
    "another_custom_key": "another_custom_value"
    }]
  }'
```

</CodeSample>
<CodeResponse>

```json
{}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Ban Customer

Bans the customer for a specific period of time. It immediately disconnects all active sessions of this customer and does not accept new ones during the ban lifespan.

#### Specifics

|                        |                                                                              |
| ---------------------- | ---------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/ban_customer`                 |
| **Required scopes**    | `customers.ban:rw`                                                           |
| **RTM API equivalent** | [`ban_customer`](/messaging/agent-chat-api/v3.5/rtm-reference/#ban-customer) |
| **Webhook**            | -                                                                            |

#### Request

| Parameter  | Required | Data type |     |
| ---------- | -------- | --------- | --- |
| `id`       | Yes      | `string`  |     |
| `ban`      | Yes      | `object`  |     |
| `ban.days` | Yes      | `number`  |     |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/ban_customer \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
   "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
   "ban": {
     "days": 3
     }
   }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Follow Customer

Marks a customer as followed. As a result, the requester (an agent) will receive the info about all the changes related to that customer via pushes. Once the customer leaves the website or is [unfollowed](#unfollow-customer), the agent will no longer receive that information.

Following a customer causes the agent to receive customer-related pushes as long as the followed customer is available. The followed customer may be transferred to a group the agent doesn't have access to, which makes the customer unavailable to the agent. At that moment, the agent stops receiving pushes related to that customer. When the customer is transferred back and becomes available again, the pushes resume.

Agents don't need to follow the customers they're chatting with in order to receive related pushes. Agents will be receiving pushes related to those customers as long as the chats last.

#### Specifics

|                        |                                                                                    |
| ---------------------- | ---------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/follow_customer`                    |
| **Required scopes**    | `customers:ro`                                                                     |
| **RTM API equivalent** | [`follow_customer`](/messaging/agent-chat-api/v3.5/rtm-reference/#follow-customer) |
| **Webhook**            | -                                                                                  |

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `id`      | Yes      | `string`  |     |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/follow_customer \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
   "id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
   }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Unfollow Customer

Removes the agent from the list of customer's followers. Calling this method on a customer the agent's chatting with will result in success, however, the agent will still receive pushes about the customer's data updates. The unfollowing will take effect once the chat ends.

#### Specifics

|                        |                                                                                        |
| ---------------------- | -------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/unfollow_customer`                      |
| **Required scopes**    | -                                                                                      |
| **RTM API equivalent** | [`unfollow_customer`](/messaging/agent-chat-api/v3.5/rtm-reference/#unfollow-customer) |
| **Webhook**            | -                                                                                      |

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `id`      | Yes      | `string`  |     |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/unfollow_customer \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
   "id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
   }'
```

</CodeSample>
</Code>
</Section>

## Status

<Section>
<Text>

### Set Routing Status

Changes the status of an Agent or a Bot Agent.

#### Specifics

|                        |                                                                                                        |
| ---------------------- | ------------------------------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/set_routing_status`                                     |
| **Required scopes**    | for Agents: `agents--my:rw` `agents--all:rw`; for Bot Agents: `agents-bot--my:rw` `agents-bot--all:rw` |
| **RTM API equivalent** | [`set_routing_status`](/messaging/agent-chat-api/v3.5/rtm-reference/#set-routing-status)               |
| **Webhook**            | [`routing_status_set`](/management/webhooks/v3.5/#routing_status_set)                                  |

#### Request

| Parameter  | Required | Data type | Notes                                                                                                                          |
| ---------- | -------- | --------- | ------------------------------------------------------------------------------------------------------------------------------ |
| `status`   | Yes      | `string`  | For Agents: `accepting_chats` or `not_accepting_chats`; for Bot Agents: `accepting_chats`, `not_accepting_chats`, or `offline` |
| `agent_id` | No       | `string`  | If not specified, the requester's status will be updated.                                                                      |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/set_routing_status \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "status": "accepting_chats",
    "agent_id": "smith@example.com"
  }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### List Routing Statuses

Returns the current routing status of each agent selected by the provided filters.

#### Specifics

|                        |                                                                                                |
| ---------------------- | ---------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/list_routing_statuses`                          |
| **Required scopes**    | `agents--all:ro`, `agents-bot--all:ro`                                                         |
| **RTM API equivalent** | [`list_routing_statuses`](/messaging/agent-chat-api/v3.5/rtm-reference/#list-routing-statuses) |
| **Webhook**            | -                                                                                              |

#### Request

| Parameter           | Required | Type     | Notes |
| ------------------- | -------- | -------- | ----- |
| `filters`           | No       | `object` |       |
| `filters.group_ids` | No       | `array`  |       |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/list_routing_statuses \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "filters": {
      "group_ids": [
        0
      ]
    }
  }'
```

</CodeSample>
<CodeResponse path={'RESPONSE'}>

```shell
[{
  "agent_id": "smith@example.com",
  "status": "accepting_chats"
}, {
  "agent_id": "agent@example.com",
  "status": "not_accepting_chats"
}]
```

</CodeResponse>
</Code>
</Section>

## Other

<Section>
<Text>

### Mark Events as Seen

#### Specifics

|                        |                                                                                            |
| ---------------------- | ------------------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/mark_events_as_seen`                        |
| **Required scopes**    | `chats--all:ro` `chats--access:ro`                                                         |
| **RTM API equivalent** | [`mark_events_as_seen`](/messaging/agent-chat-api/v3.5/rtm-reference/#mark-events-as-seen) |
| **Webhook**            | [`events_marked_as_seen`](/management/webhooks/v3.5/#events_marked_as_seen)                |

#### Request

| Parameter    | Required | Data type | Notes                     |
| ------------ | -------- | --------- | ------------------------- |
| `chat_id`    | Yes      | `string`  |                           |
| `seen_up_to` | Yes      | `string`  | RFC 3339 date-time format |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/mark_events_as_seen \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
   "chat_id": "PJ0MRSHTDG",
   "seen_up_to": "2017-10-12T15:19:21.010200Z"
   }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Send Typing Indicator

#### Specifics

|                        |                                                                                                |
| ---------------------- | ---------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/send_typing_indicator`                          |
| **Required scopes**    | `chats--all:rw` `chats--access:rw`                                                             |
| **RTM API equivalent** | [`send_typing_indicator`](/messaging/agent-chat-api/v3.5/rtm-reference/#send-typing-indicator) |
| **Webhook**            | -                                                                                              |

#### Request

| Parameter    | Required | Data type | Notes                                                |
| ------------ | -------- | --------- | ---------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat that to send the typing indicator to. |
| `visibility` | No       | `string`  | Default: `all`; `agents`                             |
| `is_typing`  | Yes      | `bool`    |                                                      |

#### Response

No response payload (`200 OK`).

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/send_typing_indicator \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
   "chat_id": "PJ0MRSHTDG",
   "is_typing": true
   }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### Multicast

This method serves for the **chat-unrelated communication**. Messages sent using `multicast` are not being saved.

For example, it could be used in an app that sends notifications to Agents or Customers, when a certain condition is met (e.g. an important Customer started the chat).

#### Specifics

|                        |                                                                        |
| ---------------------- | ---------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/multicast`              |
| **Required scopes**    | `multicast:rw`                                                         |
| **RTM API equivalent** | [`multicast`](/messaging/agent-chat-api/v3.5/rtm-reference/#multicast) |
| **Webhook**            | -                                                                      |

#### Request

| Parameter    | Required | Data type | Notes                     |
| ------------ | -------- | --------- | ------------------------- |
| `recipients` | Yes      | `object`  | **\***                    |
| `content`    | Yes      | `any`     | A JSON message to be sent |
| `type`       | No       | `string`  | Multicast message type    |

**\*)** `recipients` can take the following values:

- `agents`:

  - `all` (`bool` - includes all agents)
  - `ids` (`[]string` - an array of agents' IDs)
  - `groups` (`[]string` - an array of groups' IDs)

- `customers`:
  - `ids` (`[]string` - an array of customer's IDs)

At least one `recipients` type (`agents.all`, `agents.ids`, `agents.groups`, `customers.ids`) is required.

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/multicast \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
    "recipients": {
    "agents": {
      "all": true,
      "ids": [
      "smith@example.com",
      "agent@example.com"
      ],
      "groups": [
      1,
      2
      ]
    },
    "customers": {
      "ids": [
      "b7eff798-f8df-4364-8059-649c35c9ed0c"
      ]
    }
    },
    "content": {
    "example": {
      "nested": "json"
    }
    }
  }'
```

</CodeSample>
</Code>
</Section>

<Section>
<Text>

### List Agents For Transfer

It returns the Agents you can transfer a chat to. Agents are sorted ascendingly by the total number of active chats they have. Note that:

- The method only returns Agents with statuses **online** and **not accepting chats**. Offline Agents aren't returned.
- Only chats **with Customers** are taken into account in `total_active_chats`.

#### Specifics

|                        |                                                                                                      |
| ---------------------- | ---------------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.5/agent/action/list_agents_for_transfer`                             |
| **Required scopes**    | -                                                                                                    |
| **RTM API equivalent** | [`list_agents_for_transfer`](/messaging/agent-chat-api/v3.5/rtm-reference/#list-agents-for-transfer) |
| **Webhook**            | -                                                                                                    |

#### Request

| Parameter | Required | Data type | Notes                                   |
| --------- | -------- | --------- | --------------------------------------- |
| `chat_id` | Yes      | `string`  | The ID of the chat you want to transfer |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
https://api.livechatinc.com/v3.5/agent/action/list_agents_for_transfer \
-H 'Authorization: Bearer <your_access_token>' \
-H 'Content-Type: application/json' \
-d '{
  "chat_id": "PJ0MRSHTDG"
  }'
```

</CodeSample>
<CodeResponse path={'RESPONSE'}>

```shell
[{
  "agent_id": "smith@example.com",
  "total_active_chats": 2
}, {
  "agent_id": "agent@example.com",
  "total_active_chats": 5
}]
```

</CodeResponse>
</Code>
</Section>

# Webhooks

Here's what you need to know about **webhooks**:

- Webhooks notify you when specific events are triggered.
- They can be generated by both Web and RTM API actions.
- When using RTM API, you can be also notified about events with [pushes](/messaging/agent-chat-api/rtm-pushes).
- Webhooks and pushes have similar payloads.
- There's a limit of three weebhoks for every action a Client ID can register.

You can create and manage webhooks via the [Configuration API](/management/configuration-api/#webhooks).

<SectionLink to={"/management/configuration-api/v3.5/#webhooks"}>See webhook methods</SectionLink>
<SectionLink to={"/management/webhooks/v3.5/"}>See webhook payloads</SectionLink>

# Errors

<CodeResponse title={'Format of error payload'}>

```json
{
  "error": {
    "type": "misdirected_request",
    "message": "Wrong region",
    "data": {
      // optional
      "region": "dal"
    }
  }
}
```

</CodeResponse>

## Possible errors

<Errors errors="agent_offline,authentication,authorization,chat_inactive,entity_too_large,internal,license_expired,license_not_found,limit_reached,misdirected_request,missing_access,not_found,request_timeout,service_unavailable,too_many_requests,unsupported_version,validation,wrong_product_version"/>

# Contact us

If you found a bug or a typo, you can let us know directly on GitHub.
In case of any questions or feedback, don't hesitate to contact us at [developers@livechat.com](mailto:developers@livechat.com). We'll be happy to hear from you!

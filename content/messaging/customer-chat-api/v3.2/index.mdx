---
weight: 30
category: "messaging"
subcategory: "customer-chat-api"
title: "Web API Reference"
tagline: "Interact with the chat as a Customer."
desc: "Use the Customer Chat Web API to interact as a Customer."
apiVersion: "3.2"
---

# Introduction

## Versioning

This document describes the **Customer Chat Web API v3.2**. This is the **developer preview** version recommended only for the **experimental** use. [Read more about versioning...](/messaging/#api-versioning)

## What is Web API

Web API is similar to REST API. Client can send a **request message** that results in getting a **response message**. It's also possible to get webhooks.

## When to use Web API

If you're wondering which API to use - Customer Chat **RTM API** or **Web API**, keep on reading.

**Web API** allows for building stateless integrations. The communication is done via **XHR requests**. The implementation is easier than with RTM API, but you need to take possible time delays into consideration.

**Not what you're looking for?** Perhaps, you need to use [**Customer Chat RTM API**](rtm-reference) instead.

## Access

**Customer authentication** is handled with access tokens. Find out how to get an **access token** from [Customer authorization flow](/getting-started/authorization/#customer-authorization-flow). Take note **it's not the same** token you would you for the Agent Chat or Configuration API.

## Data centers

LiveChat system operates in two data centers: `dal` (USA) and `fra` (Europe). The default data center is `dal`.

All the LiveChat OAuth2.0 access tokens have a prefix: `dal-` or `fra-`. This prefix indicates the data center they belong to. If you need to specify the data center while making an API call, simply add the `X-Region: <token_prefix>` optional header.

Summing up, if the user token starts with `fra-`, you should add the `X-Region: fra` header. If the token starts with, `dal-` you don‚Äôt have to specify the header.

# Events

One of the data structures are **events**. They are sent to a chat via the `send_event` method.
Apart from events, there are also [Properties](#properties), [Users](#users), and [Other common data structures](#other-common-structures).

These are the available **event types**:

- [File](#file)
- [Filled form](#filled-form)
- [Message](#message)
- [Rich message](#rich-message)
- [Custom](#custom)
- [System message](#system-message)

## File

<Section>

<Text>

File event informs about a file being uploaded.

### Request

| Field        | Required | Data type |                                                                                                                                     Notes |
| ------------ | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------: |
| `custom_id`  | no       | `string`  |                                                                                                                                           |
| `type`       | yes      | `string`  |                                                                                                                                    `file` |
| `properties` | no       | `object`  |                                                                                                                 [Properties](#properties) |
| `url`        | yes      | `string`  | Has to point to the LiveChat CDN. It's recommended to use the URL returned by [`upload_file`](/messaging/customer-chat-api/#upload-file). |

### Response

| Field                              | Returned        |                                                               Notes |
| ---------------------------------- | :-------------- | ------------------------------------------------------------------: |
| `id`                               | always          |                                                                     |
| `custom_id`                        | optionally      |                                                                     |
| `created_at`                       | always          | Date & time format with a resolution of microseconds, `UTC string`. |
| `type`                             | always          |                                                                     |
| `author_id`                        | always          |                                                                     |
| `properties`                       | optionally      |                                                                     |
| `name`                             | always          |                                                                     |
| `url`                              | always          |                                                                     |
| `thumbnail_url`, `thumbnail2x_url` | only for images |                                                                     |
| `content_type`                     | always          |                                                                     |
| `size`, `width`, `height`          | only for images |                                                                     |

</Text>

<Code>

<CodeResponse title={'Sample File in response'}>

```json
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743", // generated server-side
  "custom_id": "31-0C-1C-07-DB-16",
  "created_at": "2017-10-12T15:19:21.010200Z", // generated server-side
  "type": "file",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c", // generated server-side
  "properties": {
    // "Properties" object
  },
  "name": "image25.png", // generated server-side
  "url": "https://example.com/image25.png",
  "thumbnail_url": "https://example.com/thumbnail.png", // generated server-side
  "thumbnail2x_url": "https://example.com/thumbnail2x.png", // generated server-side
  "content_type": "image/png", // generated server-side
  "size": 123444, // generated server-side
  "width": 640, // generated server-side
  "height": 480 // generated server-side
}
```

</CodeResponse>

</Code>

</Section>

## Filled form

<Section>

<Text>

Filled form event contains data from a form (prechat or postchat survey).

### Request

| Field        | Required | Data type | Notes                                                                    |
| ------------ | -------- | --------- | ------------------------------------------------------------------------ |
| `custom_id`  | no       | `string`  |                                                                          |
| `type`       | yes      | `string`  | `filled_form`                                                            |
| `properties` | no       | `object`  | [Properties](#properties)                                                |
| `form_id`    | yes      | `string`  |                                                                          |
| `fields`     | yes      | `array`   | The fields a form contains. See [form fields](#form-fields) for details. |

### Response

| Field        | Returned   | Notes                                                               |
| ------------ | ---------- | ------------------------------------------------------------------- |
| `id`         | always     |                                                                     |
| `custom_id`  | optionally |                                                                     |
| `created_at` | always     | Date & time format with a resolution of microseconds, `UTC string`. |
| `type`       | always     |                                                                     |
| `author_id`  | always     |                                                                     |
| `properties` | optionally |                                                                     |
| `form_id`    | always     |                                                                     |
| `fields`     | always     | An array of [form fields](#form-fields)                             |

</Text>

<Code>

<CodeResponse title={'Sample Filled form in response'}>

```json
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743", // generated server-side
  "custom_id": "31-0C-1C-07-DB-16",
  "created_at": "2017-10-12T15:19:21.010200Z", // generated server-side
  "type": "filled_form",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c", // generated server-side
  "properties": {
    // "Properties" object
  },
  "form_id": "1473433500211",
  "fields": [{
    "type": "name",
    "id": "154417206262603539",
    "label": "Your name",
    "answer": "Thomas Anderson"
  }, {
    "type": "email",
    "id": "154417206262601584",
    "label": "Your email",
    "answer": "t.anderson@example.com"
  }, {
    "type": "radio",
    "id": "154417206262602571",
    "label": "Chat purpose",
    "answer": {
      "id": "0",
      "label": "Support"
    }
  }, {
    "type": "checkbox",
    "id": "154417206262604640",
    "label": "Company industry",
    "answers": [{
      "id": "0"
      "label": "automotive"
    }, {
      "id": "1"
      "label": "it"
    }]
  }, {
    "type": "group_chooser",
    "id": "154417206262605324",
    "label": "Choose department",
    "answer": {
      "id": "2",
      "group_id": 1,
      "label": "Marketing"
    }
  }]
}
```

</CodeResponse>

</Code>

</Section>

## Message

<Section>

<Text>

Message event contains text message to other chat users.

### Request

| Field                | Required | Data type | Notes                                                                                                                         |
| -------------------- | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------- |
| `custom_id`          | no       | `string`  |                                                                                                                               |
| `text`               | yes      | `string`  | Max. raw text size is 16 KB (one UTF-8 char like emoji üòÅ can use up to 4 B); to send more, split text into several messages. |
| `type`               | yes      | `string`  | `message`                                                                                                                     |
| `properties`         | no       | `object`  | [Properties](#properties)                                                                                                     |
| `postback`           | no       | `object`  | Indicates that the message event was generated in response to a rich message event.                                           |
| `postback.id`        | yes      | `string`  | ID of the postback from the rich message event.                                                                               |
| `postback.thread_id` | yes      | `string`  | ID of the thread with the rich message event.                                                                                 |
| `postback.event_id`  | yes      | `string`  | ID of the rich message event.                                                                                                 |
| `postback.type`      | no       | `string`  | Should be used together with `postback.value` (when  one of them is present, the other is required).                                                                                |
| `postback.value`     | no       | `string`  | Should be used together with `postback.type` (when  one of them is present, the other is required).                                                                                 |

### Response

| Field                | Returned   | Notes                                                               |
| -------------------- | ---------- | ------------------------------------------------------------------- |
| `id`                 | always     |                                                                     |
| `custom_id`          | optionally |                                                                     |
| `created_at`         | always     | Date & time format with a resolution of microseconds, `UTC string`. |
| `type`               | always     | `message`                                                           |
| `author_id`          | always     |                                                                     |
| `text`               | always     |                                                                     |
| `postback`           | optionally | Appears in a message only when triggered by a rich message.         |
| `postback.id`        | always     |                                                                     |
| `postback.thread_id` | always     |                                                                     |
| `postback.event_id`  | always     |                                                                     |
| `postback.type`      | optionally | Appears only if `postback.value` is present.                        |
| `postback.value`     | optionally | Appears only if `postback.type` is present.                         |
| `properties`         | optionally | [Properties](#properties)                                           |

</Text>

<Code>

<CodeResponse title={'Sample Message in response'}>

```json
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743", // generated server-side
  "custom_id": "31-0C-1C-07-DB-16",
  "created_at": "2017-10-12T15:19:21.010200Z", // generated server-side
  "type": "message",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c", // generated server-side
  "text": "hello there",
  "postback": {
    "id": "action_call",
    "thread_id": "K600PKZON8",
    "event_id": "75a90b82-e6a4-4ded-b3eb-cb531741ee0d",
    "type": "phone",
    "value": "790034890"
  },
  "properties": {
    // "Properties" object
  }
}
```

</CodeResponse>

</Code>

</Section>

## Rich message

<Section>

<Text>

Rich message event contains rich message data structure. [Read more](/extending-ui/extending-chat-widget/rich-messages/) in a document dedicated to Rich messages.

### Request

| Field                            | Required | Data type | Notes                                                                                             |
| -------------------------------- | -------- | --------- | ------------------------------------------------------------------------------------------------- |
| `custom_id`                      | no       | `string`  | You can give your RM a custom ID.                                                                 |
| `type`                           | yes      | `string`  | Event type: `rich_message`                                                                        |
| `properties`                     | no       | `object`  | The [properties](#properties) data structure                                                      |
| `template_id`                    | yes      | `string`  | Defines how every Rich Message will be presented. Values: `cards`, `sticker`, or `quick_replies`. |
| `elements`                       | no       | `array`   | Can contain up to 10 `element` objects.                                                           |
| `elements.title`                 | yes      | `string`  | Displays formatted text on RMs.                                                                   |
| `elements.subtitle`              | yes      | `string`  | Displays formatted text on RMs.                                                                   |
| `elements.image`                 | yes      | `image`   | Displays images on RMs. Required param: `url`; Optional params: `name`, `content_type`, `size`, `width`, `height`.|
| `elements.buttons`               | no       | `array`   | Displays buttons. Can contain up to 13 `button` objects.                                          |
| `elements.buttons.text`          | yes      | `string`  | Text displayed on a button.                                                                       |
| `elements.buttons.type`          | yes      | `array`   | Defines the behavior after a user clicks the button. Should be used together with `elements.buttons.value`. Possible values: `webview`, `message`, `url`, `phone`. [More...](/extending-ui/extending-chat-widget/rich-messages/#getting-started)  |
| `elements.buttons.value`         | yes      | `string`  | Should be used together with `elements.buttons.type`.                                             |
| `elements.buttons.webview_height`| yes      | `string`  | Required only for the `webview` button`type`. Possible values: `compact`, `full`, `tall`.         |
| `elements.buttons.postback_id`   | yes      | `string`  | A description of the sent action. Describes the action sent via `send_rich_message_postback`. [More...](/extending-ui/extending-chat-widget/rich-messages/#getting-started) |
| `elements.buttons.user_ids`      | yes      | `array`   | Describes users that sent the postback with `"toggled": true`.|

### Response

| Field                            | Returned   | Notes                                                               |
| -------------------------------- | ---------- | ------------------------------------------------------------------- |
| `id`                             | always     | Generated server-side                                               |
| `custom_id`                      | optionally |                                                                     |
| `type`                           | always     |                                                                     |
| `author_id`                      | always     | Generated server-side                                               |
| `created_at`                     | always     | Date & time format with a resolution of microseconds, `UTC string`. Generated server-side. |
| `properties`                     | optionally |                                                                     |
| `template_id`                    | always     |                                                                     |
| `elements`                       | optionally |                                                                     |
| `elements.title`                 | always     |                                                                     |
| `elements.subtitle`              | always     |                                                                     |
| `elements.image`                 | always     |                                                                     |
| `elements.buttons`               | optionally |                                                                     |
| `elements.buttons.text`          | always     |                                                                     |
| `elements.buttons.type`          | always     |                                                                     |
| `elements.buttons.value`         | always     |                                                                     |
| `elements.buttons.webview_height`| always     | Unless button `type` is different than `webview`.                   |
| `elements.buttons.postback_id`   | always     |                                                                     |
| `elements.buttons.user_ids`      | always     |                                                                     |

</Text>

<Code>

<CodeResponse title={'Sample Rich message event'}>

```json
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743",
  "custom_id": "31-0C-1C-07-DB-16",
  "type": "rich_message",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "created_at": "2017-10-12T15:19:21.010200Z",
  "properties": {
    // "Properties" object
  },
  "template_id": "cards",
  "elements": [
    {
      "title": "Lorem ipsum dolor.",
      "subtitle": "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
      "image": {
        "name": "image25.png",
        "url": "https://example.com/image25.png",
        "content_type": "image/png",
        "size": 123444,
        "width": 640,
        "height": 480
      },
      "buttons": [
        {
          "text": "yes",
          "postback_id": "action_yes",
          "user_ids": ["b7eff798-f8df-4364-8059-649c35c9ed0c"]
        },
        {
          "text": "no",
          "postback_id": "action_no",
          "user_ids": []
        },
        {
          "type": "phone",
          "text": "value",
          "value": "790034890",
          "webview_height": "tall",
          "postback_id": "action_call",
          "user_ids": []
        }
      ]
    }
  ]
}
```

</CodeResponse>

</Code>

</Section>

## Custom

<Section>

<Text>

Custom event is an event with customizable payload.

### Request

| Field        | Required | Data type | Notes                                                               |                                                                                   |
| ------------ | -------- | --------- | ------------------------------------------------------------------- |
| `custom_id`  | no       | `string`  | You can give the event a custom ID.                                 |
| `type`       | yes      | `string`  | Event type: `custom`                                                |
| `content`    | no       | `object`  | The content you define                                              |
| `properties` | no       | `object`  | The [properties](#properties) data structure                        |

### Response

| Field        | Returned   | Notes                                                                                     |
| ------------ | ---------- | ----------------------------------------------------------------------------------------- |
| `id`         | always     | Generated server-side                                                                     |
| `custom_id`  | optionally |                                                                                           |
| `type`       | always     |                                                                                           |
| `author_id`  | always     | Generated server-side                                                                     |
| `created_at` | always     | Date & time format with a resolution of microseconds, `UTC string`; generated server-side |
| `content`    | optionally |                                                                                           |
| `properties` | optionally |                                                                                           |

</Text>

<Code>

<CodeResponse title={'Sample Custom event'}>

```json
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743",
  "custom_id": "31-0C-1C-07-DB-16",
  "type": "custom",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "created_at": "2017-10-12T15:19:21.010200Z",
  "content": {
    "custom": {
      "nested": "json"
    }
  },
  "properties": {
    // "Properties" object
  }
}
```

</CodeResponse>

</Code>

</Section>

## System message

<Section>

<Text>

System message event is a native system event sent in specific situations.

### Request

| Field                 | Required | Data type |                                                                                                                            Notes |
| --------------------- | -------- | --------- | -------------------------------------------------------------------------------------------------------------------------------: |
| `custom_id`           | no       | `string`  |                                                                                     You can give the system message a custom ID. |
| `type`                | yes      | `string`  |                                                                                                                 `system_message` |
| `text`                | no       | `string`  |                                                                                                     Text displayed to recipients |
| `system_message_type` | yes      | `string`  |                                                                                [System message type](#available-system-messages) |
| `text_vars`           | no       | `object`  |                                                                                                       Variables used in the text |

### Response

| Field                 | Returned   | Notes                                                                                     |
| --------------------- | ---------- | ----------------------------------------------------------------------------------------- |
| `id`                  | always     | Generated server-side                                                                     |
| `custom_id`           | optionally |                                                                                           |
| `type`                | always     |                                                                                           |
| `created_at`          | always     | Date & time format with a resolution of microseconds, `UTC string`; generated server-side |
| `text`                | optionally |                                                                                           |
| `system_message_type` | always     |                                                                                           |

</Text>

<Code>
<CodeResponse title={'Sample System message event'}>

```json
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743", // generated server-side
  "custom_id": "31-0C-1C-07-DB-16",
  "created_at": "2017-10-12T15:19:21.010200Z", // generated server-side
  "type": "system_message",
  "text": "hello there",
  "system_message_type": "routing.assigned",
  "text_vars": {
    "agent": "John Doe"
  }
}
```

</CodeResponse>
</Code>
</Section>

### Available system messages

Here's the list of all system messages you might come across:

<Section>

|                        |                       |        |
| ---------------------- | --------------------- | ------ |
| <ul><li>[`agent_added`](#agent_added)</li> <li>[`agent_removed`](#agent_removed)</li> <li>[`archived_customer_disconnected`](#archived_customer_disconnected)</li> <li>[`chat_transferred`](#chat_transferred)</li> <li>[`customer_added`](#customer_added)</li> <li>[`customer_banned`](#customer_banned)</li> <li>[`customer_removed`](#customer_removed)</li> <li>[`manual_archived_agent`](#manual_archived_agent)</li> <li>[`manual_archived_customer`](#manual_archived_customer)</li> <li>[`rating.chat_commented`](#ratingchat_commented)</li><li>[`rating.chat_rated`](#ratingchat_rated)</li> </ul> | <ul><li>[`rating.chat_rating_canceled`](#ratingchat_rating_canceled)</li><li>[`routing.archived_deleted`](#routingarchived_deleted)</li><li>[`routing.archived_disconnected`](#routingarchived_disconnected)</li><li>[`routing.archived_inactive`](#routingarchived_inactive)</li><li>[`routing.archived_offline`](#routingarchived_offline)</li><li>[`routing.archived_other`](#routingarchived_other)</li><li>[`routing.archived_remotely_signed_out`](#routingarchived_remotely_signed_out)</li><li>[`routing.archived_signed_out`](#routingarchived_signed_out)</li><li>[`routing.assigned_deleted`](#routingassigned_deleted)</li><li>[`routing.assigned_disconnected`](#routingassigned_disconnected)</li><li>[`routing.assigned_inactive`](#routingassigned_inactive)</li></ul> | <ul><li>[`routing.assigned_other`](#routingassigned_other)</li><li>[`routing.assigned_remotely_signed_out`](#routingassigned_remotely_signed_out)</li><li>[`routing.assigned_signed_out`](#routingassigned_signed_out)</li> <li>[`routing.unassigned_deleted`](#routingunassigned_deleted)</li><li>[`routing.unassigned_disconnected`](#routingunassigned_disconnected)</li><li>[`routing.unassigned_other`](#routingunassigned_other)</li><li>[`routing.unassigned_remotely_signed_out`](#routingunassigned_remotely_signed_out)</li><li>[`routing.unassigned_signed_out`](#routingunassigned_signed_out)</li><li>[`system_archived`](#system_archived)</li><li>[`transcript_requested`](#transcript_requested)</li><li>[`transcript_sent`](#transcript_sent)</li></ul>

</Section>

#### `agent_added`

|                 Content                 |                                                                                      Generated when |
| :-------------------------------------: | --------------------------------------------------------------------------------------------------: |
| _%initiator% added %agent% to the chat_ | Agent was added to chat via the `add_user_to_chat` request and is not the first Agent in that chat. |

#### `agent_removed`

|                   Content                   |                                                       Generated when |
| :-----------------------------------------: | -------------------------------------------------------------------: |
| _%initiator% removed %agent% from the chat_ | Agent was removed from chat via the `remove_user_from_chat` request. |

#### `archived_customer_disconnected`

|          Content           |                              Generated when |
| :------------------------: | ------------------------------------------: |
| _%customer% left the chat_ | Chat ended after Customer left the website. |

#### `chat_transferred`

|                     Content                     |                                        Generated when |
| :---------------------------------------------: | ----------------------------------------------------: |
| _%initiator% transferred the chat to %targets%_ | Chat was transferred via the `transfer_chat` request. |

#### `customer_added`

|                  Content                   |                                                 Generated when |
| :----------------------------------------: | -------------------------------------------------------------: |
| _%initiator% added %customer% to the chat_ | Customer was added to chat via the `add_user_to_chat` request. |

#### `customer_banned`

|                                   Content                                    |                                                        Generated when |
| :--------------------------------------------------------------------------: | --------------------------------------------------------------------: |
| _Chat archived because customer was banned by %agent% for %duration% day(s)_ | Chat ended becaus Customer was banned via the `ban_customer` request. |

#### `customer_removed`

|                    Content                     |                                                          Generated when |
| :--------------------------------------------: | ----------------------------------------------------------------------: |
| _%initiator% removed %customer% from the chat_ | Customer was removed from chat via the `remove_user_from_chat` request. |

#### `manual_archived_agent`

|           Content           |                                    Generated when |
| :-------------------------: | ------------------------------------------------: |
| _%agent% archived the chat_ | Agent closed chat via the `deactivate_chat` request. |

#### `manual_archived_customer`

|            Content             |                                       Generated when |
| :----------------------------: | ---------------------------------------------------: |
| _%customer% archived the chat_ | Customer closed chat via the `deactivate_chat` request. |

#### `rating.chat_commented`

|                      Content                       |                  Generated when |
| :------------------------------------------------: | ------------------------------: |
| _%customer% left the following comment: %comment%_ | Chat was commented by Customer. |

#### `rating.chat_rated`

|                Content                 |              Generated when |
| :------------------------------------: | --------------------------: |
| _%customer% rated the chat as %score%_ | Chat was rated by Customer. |

#### `rating.chat_rating_canceled`

|                Content                |                         Generated when |
| :-----------------------------------: | -------------------------------------: |
| _%customer% canceled the chat rating_ | Chat rating was cancelled by Customer. |

#### `routing.archived_deleted`

|                            Content                             |                                                                                                          Generated when |
| :------------------------------------------------------------: | ----------------------------------------------------------------------------------------------------------------------: |
| _The chat was closed because %agent% account had been deleted_ | Chat was archived after Agent was removed from the license. No other Agent could be selected, and queues were disabled. |

#### `routing.archived_disconnected`

|                              Content                               |                                                                                                          Generated when |
| :----------------------------------------------------------------: | ----------------------------------------------------------------------------------------------------------------------: |
| _The chat was closed because %agent% had lost internet connection_ | Chat was archived after Agent unexpectedly lost connection. No other Agent could be selected, and queues were disabled. |

#### `routing.archived_inactive`

|                         Content                         |                                              Generated when |
| :-----------------------------------------------------: | ----------------------------------------------------------: |
| _Chat archived due to %duration% minutes of inactivity_ | No new messages were posted for an extended amount of time. |

#### `routing.archived_offline`

|                  Content                   |                                                 Generated when |
| :----------------------------------------: | -------------------------------------------------------------: |
| _Chat archived due to no available agents_ | No Agent could be selected after chat was placed in the queue. |

#### `routing.archived_other`

|        Content        |                                                                                                                     Generated when |
| :-------------------: | ---------------------------------------------------------------------------------------------------------------------------------: |
| _The chat was closed_ | Chat was archived after Agent was removed from chat for other reasons. No other Agent could be selected, and queues were disabled. |

#### `routing.archived_remotely_signed_out`

|                              Content                               |                                                                                              Generated when |
| :----------------------------------------------------------------: | ----------------------------------------------------------------------------------------------------------: |
| _The chat was closed because %agent% had been remotely signed out_ | Chat was archived after an Agent was logged out. No other Agent could be selected and queues were disabled. |

#### `routing.archived_signed_out`

|                       Content                        |                                                                                        Generated when |
| :--------------------------------------------------: | ----------------------------------------------------------------------------------------------------: |
| _The chat was closed because %agent% had signed out_ | Chat was archived after Agent logged out. No other Agent could be selected, and queues were disabled. |

#### `routing.assigned_deleted`

|                                      Content                                      |                                                                        Generated when |
| :-------------------------------------------------------------------------------: | ------------------------------------------------------------------------------------: |
| _Chat assigned to %agent_added% because %agent_removed% account had been deleted_ | Chat was assigned to a new Agent after the previous one was removed from the license. |

#### `routing.assigned_disconnected`

|                                        Content                                        |                                                                        Generated when |
| :-----------------------------------------------------------------------------------: | ------------------------------------------------------------------------------------: |
| _Chat assigned to %agent_added% because %agent_removed% had lost internet connection_ | Chat was assigned to a new Agent after the previous one unexpectedly lost connection. |

#### `routing.assigned_inactive`

|                                            Content                                            |                                                                                 Generated when |
| :-------------------------------------------------------------------------------------------: | ---------------------------------------------------------------------------------------------: |
| _Chat assigned to %agent_added% because %agent_removed% hasn't replied in %duration% minutes_ | Chat was assigned to a new Agent after the previous one failed to response in a timely manner. |

#### `routing.assigned_other`

|        Content        |                                                                                                                     Generated when |
| :-------------------: | ---------------------------------------------------------------------------------------------------------------------------------: |
| _The chat was closed_ | Chat was archived after Agent was removed from chat for other reasons. No other Agent could be selected, and queues were disabled. |

#### `routing.assigned_remotely_signed_out`

|                                        Content                                        |                                                          Generated when |
| :-----------------------------------------------------------------------------------: | ----------------------------------------------------------------------: |
| _Chat assigned to %agent_added% because %agent_removed% had been remotely signed out_ | Chat was assigned to a new Agent after the previous one was logged out. |

#### `routing.assigned_signed_out`

|                                 Content                                 |                                                      Generated when |
| :---------------------------------------------------------------------: | ------------------------------------------------------------------: |
| _Chat assigned to %agent_added% because %agent_removed% had signed out_ | Chat was assigned to a new Agent after the previous one logged out. |

#### `routing.unassigned_deleted`

|                            Content                             |                                            Generated when |
| :------------------------------------------------------------: | --------------------------------------------------------: |
| _Customer was queued because %agent% account has been deleted_ | Chat was queued after Agent was removed from the license. |

#### `routing.unassigned_disconnected`

|                              Content                               |                                            Generated when |
| :----------------------------------------------------------------: | --------------------------------------------------------: |
| _Customer was queued because %agent% had lost internet connection_ | Chat was queued after Agent unexpectedly lost connection. |

#### `routing.unassigned_other`

|       Content        |                                                       Generated when |
| :------------------: | -------------------------------------------------------------------: |
| _Chat is unassigned_ | Chat was queued after Agent was removed from chat for other reasons. |

#### `routing.unassigned_remotely_signed_out`

|                              Content                               |                              Generated when |
| :----------------------------------------------------------------: | ------------------------------------------: |
| _Customer was queued because %agent% had been remotely signed out_ | Chat was queued after Agent was logged out. |

#### `routing.unassigned_signed_out`

|                       Content                        |                          Generated when |
| :--------------------------------------------------: | --------------------------------------: |
| _Customer was queued because %agent% had signed out_ | Chat was queued after Agent logged out. |

#### `system_archived`

|     Content     |                                                                     Generated when |
| :-------------: | ---------------------------------------------------------------------------------: |
| _Chat archived_ | License was moved to another lc_serv instance while there were still active chats. |

#### `transcript_requested`

|                             Content                              |               Generated when |
| :--------------------------------------------------------------: | ---------------------------: |
| _%customer% requested the chat transcript to be sent to %email%_ | Customer enables transcript. |

# Users

**Users** are another important data structure. Within this data structure type, we can distinguish:

- [Customer](#customer)
- [Agent](#agent)

## Customer

<CodeResponse title={'Sample Customer data structure'}>

```json
{
  "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "type": "customer",
  "name": "Thomas Anderson",
  "email": "t.anderson@example.com",
  "avatar": "https://example.com/avatars/1.jpg",
  "session_fields": [{
    "custom_key": "custom_value"
  }, {
    "another_custom_key": "another_custom_value"
  }],
  "present": true,
  "events_seen_up_to": "2017-10-12T15:19:21.010200Z"
}
```

</CodeResponse>

| Field            | Req./Opt. | Notes                                                                                     |
| ---------------- | --------- | ----------------------------------------------------------------------------------------- |
| `avatar`         | optional  |                                                                                           |
| `email`          | optional  |                                                                                           |
| `name`           | optional  |                                                                                           |
| `session_fields` | optional  | An array of custom object-enclosed `key:value` pairs. Available for the session duration. |

## Agent

<CodeResponse title={'Sample Agent data structure'}>

```json
{
  "id": "b5657aff34dd32e198160d54666df9d8",
  "type": "agent",
  "name": "Agent Smith",
  "avatar": "cdn.livechatinc.com/avatars/1.png",
  "present": true,
  "events_seen_up_to": "2017-10-12T15:19:21.010200Z"
}
```

</CodeResponse>

# Other common structures

Apart from [Events](#events) and [Users](#users), there are also other common data structures you might work with. Those are:

- [Access](#access)
- [Chats](#chats)
- [Chat summaries](#chat-summaries)
- [Form fields](#form-fields)
- [Properties](#properties)
- [Threads](#threads)

## Access

<CodeResponse title={'Sample Access data structure'}>

```json
{
  "access": {
    "group_ids": [1, 2]
  }
}
```

</CodeResponse>

| Field       | Req./Opt. |                                        Note |
| ----------- | :-------: | ------------------------------------------: |
| `group_ids` | required  | `group 0` means that all agents can see it. |

## Chats

<CodeResponse title={'Sample Chat data structure'}>

```json
{
  "id": "PJ0MRSHTDG",
  "users": [
    // array of "User" objects
  ],
  "threads": [
    // optional
    // "Thread" object
  ],
  "properites": {
    // "Properites" object
  },
  "access": {
    // "Access" object
  }
}
```

</CodeResponse>

| Field        | Req./Opt. | Note |
| ------------ | :-------: | ---: |
| `properties` | optional  |      |
| `access`     | optional  |      |

## Chat summaries

**Chat summary** is similar to the **Chat** data structure. The difference is that **Chat** contains a `thread` object, while **Chat summary** includes `last_thread_summary` and `last_event_per_type`.

<CodeResponse title={'Sample Chat summary data structure'}>

```json
{
  "id": "PJ0MRSHTDG",
  "users": [
    // array of "User" objects
  ],
  "last_event_per_type": {
    // last event of each type in chat
    "message": {
      "thread_id": "K600PKZON8",
      "thread_created_at": "2020-05-07T07:11:28.288340Z"
      "event": {
        // "restricted_access": true
        // or
        // "Event > Message" object
      }
    },
    "system_message": {
      "thread_id": "K600PKZON6",
      "thread_created_at": "2020-05-07T07:11:28.288340Z"
      "event": {
        // "restricted_access": true
        // or
        // "Event > System message" object
      }
    }
    // ...
  },
  "last_thread_summary": {
    "id": "K600PKZON8",
    "created_at": "2020-05-07T07:11:28.288340Z"
    "user_ids": ["b5657aff34dd32e198160d54666df9d8"],
    "properites": {
      // "Properites" object
    },
    "tags": ["bug_report"]
  },
  "properites": {
    // "Properites" object
  },
  "access": {
    // "Access" object
  },
  "is_followed": false
}
```

</CodeResponse>

## Form fields

A component of the [Filled form](#filled-form) event.

| Field             | Required | Data type          |                                                                                                    Notes |
| ----------------- | -------- | ------------------ | -------------------------------------------------------------------------------------------------------: |
| `fields`          | yes      | `array of objects` |                                                                              The fields a form contains. |
| `type`            | yes      | `string`           | Possible values: `checkbox`, `email`, `name`, `question`, `textarea`, `group_chooser`, `radio`, `select` |
| `id`              | yes      | `string`           |                                                                            Field id, for all field types |
| `label`           | yes      | `string`           |                                                                         Field label; for all field types |
| `answer`          | yes      | `any`              |                                                                                      For all field types |
| `answer.id`       | yes      | `string`           |                                 An identifier of each option a Customer can choose. For all field types. |
| `answer.label`    | yes      | `string`           |                                                                        Answer label; for all field types |
| `answer.group_id` | yes      | `number`           |                                                                                      For `group_chooser` |

<CodeResponse>

```json
{
  "fields": [{
    "type": "name",
    "id": "154417206262603539",
    "label": "Your name",
    "answer": "Thomas Anderson"
  }, {
    "type": "email",
    "id": "154417206262601584",
    "label": "Your email",
    "answer": "t.anderson@example.com"
  }, {
    "type": "radio",
    "id": "154417206262602571",
    "label": "Chat purpose",
    "answer": {
      "id": "0",
      "label": "Support"
    }
  }, {
    "type": "checkbox",
    "id": "154417206262604640",
    "label": "Company industry",
    "answers": [{
      "id": "0"
      "label": "automotive"
    }, {
      "id": "1"
      "label": "it"
    }]
  }, {
    "type": "group_chooser",
    "id": "154417206262605324",
    "label": "Choose department",
    "answer": {
      "id": "2",
      "group_id": 1,
      "label": "Marketing"
    }
  }]
}
```

</CodeResponse>


## Properties

Properties are **key-value storages**. They can be set within a chat, a thread, or an event. You can read more about properties in the [Configuration API](/management/configuration-api/#properties) document.

<CodeResponse title={'Sample Properties data structure'}>

```json
{
  "properties": {
    "0805e283233042b37f460ed8fbf22160": {
      // <property_namespace>
      "string_property": "string value"
      // <property_name> : <property_value>
    }
  }
}
```

</CodeResponse>

## Threads

<CodeResponse title={'Sample Thread data structure'}>

```json
{
  "id": "K600PKZON8",
  "active": true,
  "user_ids": ["b5657aff34dd32e198160d54666df9d8"],
  "restricted_access": true,
  "events": [
    // array of "Event" objects
  ],
  "properties": {
    // "Properties" object
  },
  "access": {
    // "Access" object
  },
  "previous_thread_id": "K600PKZOM8",
  "next_thread_id": "K600PKZOO8",
  "created_at": "2020-05-07T07:11:28.288340Z"
}
```

</CodeResponse>

| Field                | Req./Opt. | Note                                                                                       |
| -------------------- | --------- | ------------------------------------------------------------------------------------------ |
| `access`             | optional  |                                                                                            |
| `active`             | required  | Possible values: `true` (thread is still active) or `false`(thread no longer active).      |
| `events`             | optional  | Doesn't exists if `restricted_access` is `true`.                                           |
| `properties`         | optional  |                                                                                            |
| `restricted_access`  | optional  |                                                                                            |
| `previous_thread_id` | optional  | Present only if there is a preceding thread.                                               |
| `next_thread_id`     | optional  | Present only if there is a following thread.                                               |
| `created_at`         | required  | Date & time format with a resolution of microseconds, `UTC string`. Generated server-side. |

# Methods

<Section>

<Text>

| HTTP method | The API endpoint                                            | Methods                                                                                                     |
| ----------- | ----------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| **POST**    | `https://api.livechatinc.com/v3.2/customer/action/<action>` | All except for **Get License Properties** and **Get Group Properties**                                      |
| **GET**     | `https://api.livechatinc.com/v3.2/customer/action/<action>` | [**Get License Properties**](#list-license-properties) and [**Get Group Properties**](#list-group-properties) |

| Header          |                   Value                    |                                                                                                                                                                                                         Notes |
| --------------- | :----------------------------------------: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
| `X-API-Version` |                   `3.2`                    |                                                                                                                                                         Not needed if you sepcify the API version in the URL. |
| `Content-Type`  | `multipart/form-data; boundary=<boundary>` |                                                                                                                                                          Valid for the [**Upload File**](#upload-file) method |
| `Content-Type`  |             `application/json`             |                                                                                                                                                             Valid for every method except for **Upload File** |
| `Authorization` |              `Bearer <token>`              | Customer access token. It's not the same token you would use for the Agent Chat or Configuration API. Not needed for **Get License Properties** and **Get Group Properties**. [Read more...](#authentication) |

Every request to Customer Chat API needs to have the following **query string parameters**:

| Query string parameter | Data type |               Notes | Methods |
| ---------------------- | :-------: | ------------------: | ------- |
| `license_id`           | `integer` | LiveChat account ID | All     |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.2/customer/action?license_id=<license_id> \
  -H 'Content-Type: <content-type>' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
		// payload
      }'
```

</CodeSample>

</Code>

</Section>

## Available methods

|                |                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| -------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Chats**      | [`list_chats`](#list-chats) [`list_threads`](#list-threads) [`get_chat_threads_summary`](#get-chat-threads-summary) [`get_chat_threads`](#get-chat-threads) [`start_chat`](#start-chat) [`activate_chat`](#activate-chat) [`deactivate_chat`](#deactivate-chat)                                                                                                                                                                                                                     |
| **Events**     | [`send_event`](#send-event) [`upload_file`](#upload-file) [`send_rich_message_postback`](#send-rich-message-postback) [`send_sneak_peek`](#send-sneak-peek)                                                                                                                                                                                                                                                                                                 |
| **Properties** | [`update_chat_properties`](#update-chat-properties) [`delete_chat_properties`](#delete-chat-properties) [`update_thread_properties`](#update-thread-properties) [`delete_thread_properties`](#delete-thread-properties) [`update_event_properties`](#update-event-properties) [`delete_event_properties`](#delete-event-properties) [`list_license_properties`](#list-license-properties) [`list_group_properties`](#list-group-properties) |
| **Customers**  | [`update_customer`](#update-customer) [`set_customer_session_fields`](#set-customer-session-fields) [`get_customer`](#get-customer)                                                                                                                                                                                                                                                                                                                         |
| **Status**     | [`list_group_statuses`](#list-group-statuses)                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Other**      | [`check_goals`](#check-goals) [`get_form`](#get-form) [`get_predicted_agent`](#get-predicted-agent) [`get_url_info`](#get-url-info) [`mark_events_as_seen`](#mark-events-as-seen) [`accept_greeting`](#accept-greeting) [`cancel_greeting`](#cancel-greeting)                                                                                                                                                                                         |

## Chats

<Section>

<Text>

### List Chats

It returns [summaries](#chat-summaries) of the chats a Customer participated in.

#### Specifics

|                        |                                                               |
|------------------------|---------------------------------------------------------------|
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/list_chats` |
| **RTM API equivalent** | [`list_chats`](rtm-reference/#list-chats)                     |
| **Webhook**            | -                                                             |

#### Request

| Parameter    | Required | Type     | Notes                                                                                                        |
| ------------ | -------- | -------- | ------------------------------------------------------------------------------------------------------------ |
| `limit`      | No       | `number` | Default: 10, maximum: 25                                                                                     |
| `sort_order` | No       | `string` | Possible values: `asc`, `desc` (default). Chat summaries are sorted by the creation date of its last thread. |
| `page_id`    | No       | `string` |                                                                                                              |

#### Response

| Parameter          | Data type | Notes                                                                                                           |
| ------------------ | --------- | --------------------------------------------------------------------------------------------------------------- |
| `total_chats`      | `number`  | An estimated number. The real number of found chats can slightly differ.                                        |
| `next_page_id`     | `string`  | In relation to `page_id` specified in the request. Appears in the response only when there's the next page.     |
| `previous_page_id` | `string`  | In relation to `page_id` specified in the request. Appears in the response only when there's the previous page. |
| `chats_summary`    | `array`   | Array of [Chat summary](#chat-summaries) data structures.                                                       |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.2/customer/action/list_chats?license_id=<license_id> \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{}'
```

</CodeSample>

<CodeResponse>

```json
{
  "next_page_id": "MTUxNzM5ODEzMTQ5Ng==",
  "chats_summary": [{
      "id": "PJ0MRSHTDG",
      "order": 1575892853242000,
      "last_thread_id": "K600PKZON8",
      "last_event_per_type": {
        "message": {
          "thread_id": "K600PKZON9",
          "thread_created_at": "2020-05-07T07:11:28.288340Z",
          "event": {
            "id": "Q298LUVPRH_1",
            "created_at": "2019-12-09T12:01:18.909000Z",
            "type": "message",
            "text": "hello world",
            "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
          }
        }
      },
      "users": [{
        "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
        "type": "customer",
        "present": true
      }, {
        "id": "b5657aff34dd32e198160d54666df9d8",
        "name": "Agent Smith",
        "type": "agent",
        "present": true,
        "avatar": "https://example.com/avatar.png",
        "job_title": "Support Agent"
      }],
      "access": {
        "group_ids": [0]
      },
      "properties": {
        // "Properties" object
      }
    },
    "active": true
  }
],
"total_chats": 1
}
```

</CodeResponse>

</Code>

</Section>

<Section>
<Text>

### List Threads

It returns threads that the current Agent has access to in a given chat.

#### Specifics

|                        |                                                                  |
| ---------------------- | ---------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/agent/action/list_threads` |
| **RTM API equivalent** | [`list_threads`](rtm-reference/#list-threads)            |
| **Webhook**            | -                                                                |

#### Request

| Parameter          | Required | Data type | Notes                                                                                      |
| ------------------ | -------- | --------- | ------------------------------------------------------------------------------------------ |
| `chat_id`          | Yes      | `string`  |                                                                                            |
| `sort_order` 		 | No       | `string`  | Possible values: `asc` - oldest threads first and `desc` - newest threads first (default). |
| `limit`            | No       | `number`  | Default: 3, maximum: 100                                                                  |
| `page_id`    		 | No       | `string`  | 		                                                                                     |
| `min_events_count` | No       | `number`  | Range: 1-100; Specifies the minimum number of events to be returned in the response. It's the **total** number of events, so they can come from more than one thread. You'll get as many latest threads as needed to meet the `min_events_count` condition. |

You cannot use both `limit` and `min_events_count` at the same time.

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.2/agent/action/list_threads \
  -H 'Authorization: Bearer <your_access_token>' \
  -H 'Content-Type: application/json' \
  -d '{
          "chat_id": "PWJ8Y4THAV",
      }'
```

</CodeSample>

<CodeResponse>

```json
{
    "threads": [{
      "id": "K600PKZON8",
      "active": true,
      "user_ids": [
        "b7eff798-f8df-4364-8059-649c35c9ed0c",
        "bbb67d600796e9f277e360e842418833"
      ],
      "events": [{
        "id": "Q20N9CKRX2_1",
        "created_at": "2019-12-17T07:57:41.512000Z",
        "recipients": "all",
        "type": "message",
        "text": "Hello",
        "author_id": "bbb67d600796e9f277e360e842418833"
      }],
      "properties": {
        // "Property" object
      },
      "access": {
        "group_ids": [0]
      },
	  "created_at": "2019-12-17T07:57:41.512000Z",
      "previous_thread_id": "K600PKZOM8", // optional
      "next_thread_id": "K600PKZOO8" // optional
    }],
	"found_threads": 42,
    "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
    "previous_page_id": "MTUxNzM5ODEzMTQ5Nw==" // optional
}
```

</CodeResponse>

</Code>
</Section>

<Section>

<Text>

### Get Chat Threads Summary

#### Specifics

|                        |                                                                             |
| ---------------------- | --------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/get_chat_threads_summary` |
| **RTM API equivalent** | [`get_chat_threads_summary`](rtm-reference/#get-chat-threads-summary)       |
| **Webhook**            | -                                                                           |

#### Request

| Parameter | Required | Data type | Notes                     |
| --------- | -------- | --------- | ------------------------- |
| `chat_id` | Yes      | `string`  |                           |
| `offset`  | No       | `number`  | Default: 0                |
| `limit`   | No       | `number`  | Default: 25, maximum: 100 |

#### Response

| Parameter         | Notes                           |     |
| ----------------- | ------------------------------- | --- |
| `threads_summary` | Sorted descendingly by `order`. |     |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.2/customer/action/get_chat_threads_summary?license_id=<license_id> \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
		  "chat_id": "PJ0MRSHTDG"
      }'
```

</CodeSample>

<CodeResponse>

```json
{
  "threads_summary": [
    {
      "id": "Q298LUVPRH",
      "order": 1,
      "total_events": 1,
      "active": true
    }
  ],
  "total_threads": 1
}
```

</CodeResponse>

</Code>

</Section>

<Section>

<Text>

### Get Chat Threads

#### Specifics

|                        |                                                                     |
| ---------------------- | ------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/get_chat_threads` |
| **RTM API equivalent** | [`get_chat_threads`](rtm-reference/#get-chat-threads)               |
| **Webhook**            | -                                                                   |

#### Request

| Parameter    | Required | Data type |     |
| ------------ | -------- | --------- | --- |
| `chat_id`    | Yes      | `string`  |     |
| `thread_ids` | Yes      | `array`   |     |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.2/customer/action/get_chat_threads?license_id=<license_id> \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "chat_id": "PJ0MRSHTDG",
      "thread_ids": ["K600PKZON8"]
      }'
```

</CodeSample>

<CodeResponse>

```json
{
  "chat": {
    "id": "PJ0MRSHTDG",
    "order": 1576569422,
    "threads": [{
      "id": "K600PKZON8",
      "active": true,
      "user_ids": [
        "b7eff798-f8df-4364-8059-649c35c9ed0c",
        "b5657aff34dd32e198160d54666df9d8"
      ],
      "events": [{
        "id": "Q20N9CKRX2_1",
        "created_at": "2019-12-17T07:57:41.512000Z",
        "type": "message",
        "text": "Hello",
        "author_id": "b5657aff34dd32e198160d54666df9d8"
      }],
      "properties": {
        // "Property" object
      },
      "access": {
        "group_ids": [0]
      },
      "previous_thread_id": "K600PKZOM8",
      "next_thread_id": "K600PKZOO8",
      "created_at": "2020-05-07T07:11:28.288340Z"
    }],
    "users": [{
      "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
      "type": "customer",
      "present": true
    }, {
      "id": "b5657aff34dd32e198160d54666df9d8",
      "name": "Agent Smith",
      "type": "agent",
      "present": true,
      "avatar": "https://example.com/avatar.jpg",
      "job_title": "Support Agent"
    }],
    "access": {
      "group_ids": [0]
    },
    "properties": {
      // "Property" object
    }
  }
}
```

</CodeResponse>

</Code>

</Section>

<Section>

<Text>

### Start Chat

Starts a chat.

#### Specifics

|                        |                                                                 |
|------------------------|-----------------------------------------------------------------|
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/start_chat`   |
| **RTM API equivalent** | [`start_chat`](rtm-reference/#start-chat)                       |
| **Webhook**            | [`incoming_chat`](/management/configuration-api/#incoming_chat) |

#### Request

| Parameters               | Required | Data type | Notes                                                                       |
|--------------------------|----------|-----------|-----------------------------------------------------------------------------|
| `chat`                   | No       | `object`  |                                                                             |
| `chat.properties`        | No       | `object`  | Initial chat properties                                                     |
| `chat.access`            | No       | `object`  | Chat access to set; default: all agents.                                    |
| `chat.thread`            | No       | `object`  |                                                                             |
| `chat.thread.events`     | No       | `array`   | Initial chat events array                                                   |
| `chat.thread.properties` | No       | `object`  | Initial thread properties                                                   |
| `continuous`             | No       | `bool`    | Starts chat as continuous (online group is not required); default: `false`. |

#### Response

| Parameter   | Data type  | Notes                                                                                                                                                                   |
| ----------- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`   | `string`   |                                                                                                                                                                         |
| `thread_id` | `string`   |                                                                                                                                                                         |
| `event_ids` | `[]string` | Returned only when the chat was started with initial events. Returns only the IDs of user-generated events; server-side generated events are not included in the array. |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.2/customer/action/start_chat?license_id=<license_id> \
  -H 'Content-Type: <content-type>' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{}'
```

</CodeSample>

<CodeResponse>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "PGDGHT5G"
}
```

</CodeResponse>

</Code>

</Section>

<Section>

<Text>

### Activate Chat

Used to restart an archived chat.

#### Specifics

|                        |                                                                  |
|------------------------|------------------------------------------------------------------|
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/activate_chat` |
| **RTM API equivalent** | [`activate_chat`](rtm-reference/#activate-chat)                  |
| **Webhook**            | [`incoming_chat`](/management/configuration-api/#incoming_chat)  |

#### Request

| Request object           | Required | Type     | Notes                                                                      |
|--------------------------|----------|----------|----------------------------------------------------------------------------|
| `chat`                   | Yes      | `object` |                                                                            |
| `chat.id`                | Yes      | `string` | ID of the chat that will be activated.                                     |
| `chat.access`            | No       | `object` | Chat access to set; default: all agents.                                   |
| `chat.properties`        | No       | `object` | Initial chat properties                                                    |
| `chat.thread`            | No       | `object` |                                                                            |
| `chat.thread.events`     | No       | `array`  | Initial chat events array                                                  |
| `chat.thread.properties` | No       | `object` | Initial thread properties                                                  |
| `continuous`             | No       | `bool`   | Sets a chat to the continuous mode. When unset, leaves the mode unchanged. |

#### Response

| Parameter   | Data type  | Notes                                                                                                                                                                     |
| ----------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `thread_id` | `string`   |                                                                                                                                                                           |
| `event_ids` | `[]string` | Returned only when the chat was activated with initial events. Returns only the IDs of user-generated events; server-side generated events are not included in the array. |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.2/customer/action/activate_chat?license_id=<license_id> \
  -H 'Content-Type: <content-type>' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "chat": {
            "id": "PWLW03ICW7"
          }
      }'
```

</CodeSample>

<CodeResponse>

```json
{
  "thread_id": "Z8AGR5OUW"
}
```

</CodeResponse>

</Code>

</Section>

<Section>

<Text>

### Deactivate Chat

Deactivates a chat by closing the currently open thread. Sending messages to this thread will no longer be possible.

#### Specifics

|                        |                                                                                                                                             |
|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/deactivate_chat`                                                                          |
| **RTM API equivalent** | [`deactivate_chat`](rtm-reference/#deactivate-chat)                                                                                         |
| **Webhook**            | [`incoming_event`](/management/configuration-api/#incoming_event) and [`chat_deactivated`](/management/configuration-api/#chat_deactivated) |

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `chat_id` | Yes      | `string`  |     |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/deactivate_chat?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
        "chat_id": "PWLW03ICW7"
      }'
```

</CodeSample>

</Code>

</Section>

## Events

<Section>

<Text>

### Send Event

Sends an [Event](#events) object. Use this method to send a message by specifing the [Message](#message) event type in the request.

#### Specifics

|                        |
| ---------------------- | ----------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/send_event`     |
| **RTM API equivalent** | [`send_event`](rtm-reference/#send-event)                         |
| **Webhook**            | [`incoming_event`](/management/configuration-api/#incoming_event) |

#### Request

| Parameters              | Required | Data type | Notes                                                                                                          |
| ----------------------- | -------- | --------- | -------------------------------------------------------------------------------------------------------------- |
| `chat_id`               | Yes      | `string`  | Id of the chat that you to send a message to.                                                                  |
| `event`                 | Yes      | `object`  | The event object                                                                                               |
| `attach_to_last_thread` | No       | `bool`    | If `true`, adds an event to last (inactive) thread. Otherwise, it doesn't creates a new one; default: `false`. |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/send_event?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -d '{
      "chat_id": "PWLW03ICW7",
      "event": {
          "type": "message",
          "text": "hello world",
          "recipients": "all"
        }
    }'
```

</CodeSample>

<CodeResponse>

```json
{
  "event_id": "K600PKZON8"
}
```

</CodeResponse>

</Code>

</Section>

<!-- > **`send_event`** sample **request** with optional params

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/send_event?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -d '{
      "chat_id": "PWLW03ICW7",
      "event": {
          "type": "message",
          "text": "hello world",
          "recipients": "all"
          }
      }'
``` -->

<Section>
<Text>

### Upload File

Uploads a file to the server as a temporary file. It returns a URL that expires after 24 hours unless the URL is used in [`send_event`](#send-event).

#### Specifics

|                        |                                                                          |
| ---------------------- | ------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/upload_file`           |
| **RTM API equivalent** | -                                                                        |
| **Webhook**            | [`incoming_event`](/management/configuration-api/#incoming_event) **\*** |

**\*)**
`incoming_event` returns a URL that never expires.

#### Request

| Parameter | Required | Data type | Notes              |
| --------- | -------- | --------- | ------------------ |
| `file`    | Yes      | `binary`  | Maximum size: 10MB |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  https://api.livechatinc.com/v3.2/customer/action/upload_file?license_id=<license_id> \
  -H 'Authorization: Bearer <customer_access_token>' \
  -H 'Content-Type: multipart/form-data; boundary=--------------------------210197025774705439685896' \
  -H 'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW' \
  -F file=@/Users/MyAccount/Desktop/image.png
```

</CodeSample>
<CodeResponse>

```json
{
  "url": "https://cdn.livechat-files.com/api/file/lc/att/8948324/45a3581b59a7295145c3825c86ec7ab3/image.png"
}
```

</CodeResponse>
</Code>
</Section>

<Section>

<Text>

### Send Rich Message Postback

#### Specifics

|                        |                                                                                                         |
| ---------------------- | ------------------------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/send_rich_message_postback`                           |
| **RTM API equivalent** | [`send_rich_message_postback`](rtm-reference/#send-rich-message-postback)                               |
| **Webhook**            | [`incoming_rich_message_postback`](/management/configuration-api/#incoming_rich_message_postback)**\*** |

**\*)** `incoming_rich_message_postback` will be sent only for active threads.

#### Request

| Parameter          | Required | Data type | Notes                               |
| ------------------ | -------- | --------- | ----------------------------------- |
| `chat_id`          | Yes      | `string`  |                                     |
| `event_id`         | Yes      | `string`  |                                     |
| `postback`         | Yes      | `object`  |                                     |
| `postback.id`      | Yes      | `string`  | Postback name of the button         |
| `postback.toggled` | Yes      | `bool`    | Postback toggled; `true` or `false` |
| `thread_id`        | Yes      | `string`  |                                     |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/send_rich_message_postback?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "chat_id": "PJ0MRSHTDG",
      "thread_id": "K600PKZON8",
      "event_id": "a0c22fdd-fb71-40b5-bfc6-a8a0bc3117f7",
      "postback": {
          "id": "Method URL_yes",
          "toggled": true
          }
      }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Send Sneak Peek

Sends a sneak peek to a chat.

#### Specifics

|                        |                                                                    |
| ---------------------- | ------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/send_sneak_peek` |
| **RTM API equivalent** | [`send_sneak_peek`](rtm-reference/#send-sneak-peek)                |
| **Webhook**            | -                                                                  |

#### Request

| Parameter         | Required | Data type | Notes                                   |
| ----------------- | -------- | --------- | --------------------------------------- |
| `chat_id`         | Yes      | `string`  | Id of the chat to send a sneak peek to. |
| `sneak_peek_text` | Yes      | `string`  | Sneak peek text                         |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/send_sneak_peek?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
        "chat_id": "PJ0MRSHTDG",
        "sneak_peek_text": "hello world"
      }'
```

</CodeSample>

</Code>

</Section>

## Properties

<Section>

<Text>

### Update Chat Properties

#### Specifics

|                        |                                                                                     |
| ---------------------- | ----------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/update_chat_properties`           |
| **RTM API equivalent** | [`update_chat_properties`](rtm-reference/#update-chat-properties)                   |
| **Webhook**            | [`chat_properties_updated`](/management/configuration-api/#chat_properties_updated) |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                        |
| ------------ | -------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you to set a property for.                                                                                                                                    |
| `properties` | Yes      | `object`  | Chat properties to set. You should stick to the [general properties format](/management/configuration-api/#properties) and include _namespace_, _property name_ and _value_. |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/update_chat_properties?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "chat_id": "Q1GZ3FNAT9",
      "properties": {
          "0805e283233042b37f460ed8fbf22160": {
              "string_property": "Chat property value updated by Customer"
              }
          }
      }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Delete Chat Properties

#### Specifics

|                        |                                                                                     |
| ---------------------- | ----------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/delete_chat_properties`           |
| **RTM API equivalent** | [`delete_chat_properties`](rtm-reference/#delete-chat-properties)                   |
| **Webhook**            | [`chat_properties_deleted`](/management/configuration-api/#chat_properties_deleted) |

#### Request

| Parameter    | Required | Data type | Notes                                            |
| ------------ | -------- | --------- | ------------------------------------------------ |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete properties of. |
| `properties` | Yes      | `object`  | Chat properties to delete.                       |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/delete_chat_properties?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "chat_id": "Q1GZ3FNAT9",
      "properties": {
          "0805e283233042b37f460ed8fbf22160": [
              "string_property"
              ]
          }
      }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Update Thread Properties

#### Specifics

|                        |                                                                                         |
|------------------------|-----------------------------------------------------------------------------------------|
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/update_thread_properties`             |
| **RTM API equivalent** | [`update_thread_properties`](rtm-reference/#update-thread-properties)                   |
| **Webhook**            | [`thread_properties_updated`](/management/configuration-api/#thread_properties_updated) |

#### Request

| Parameter    | Required | Data type | Notes                                            |
| ------------ | -------- | --------- | ------------------------------------------------ |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to set properties for.   |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to set properties for. |
| `properties` | Yes      | `object`  | Chat properties to set.                          |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/update_thread_properties?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "chat_id": "Q1GZ3FNAT9",
	    "thread_id": "Q1GZ3FNAU9",
      "properties": {
          "0805e283233042b37f460ed8fbf22160": {
              "string_property": "Thread property value updated by Customer"
              }
          }
      }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Delete Thread Properties

#### Specifics

|                        |                                                                                         |
|------------------------|-----------------------------------------------------------------------------------------|
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/delete_thread_properties`             |
| **RTM API equivalent** | [`delete_thread_properties`](rtm-reference/#delete-thread-properties)                   |
| **Webhook**            | [`thread_properties_deleted`](/management/configuration-api/#thread_properties_deleted) |

#### Request

| Parameter    | Required | Data type | Notes                                                  |
|--------------|----------|-----------|--------------------------------------------------------|
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete the properties of.   |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to delete the properties of. |
| `properties` | Yes      | `object`  | Thread properties to delete.                           |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/delete_thread_properties?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
    	"chat_id": "Q1GZ3FNAT9",
      "thread_id": "Q1GZ3FNAU9",
      "properties": {
          "0805e283233042b37f460ed8fbf22160": [
              "string_property"
            ]
        }
    }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Update Event Properties

#### Specifics

|                        |                                                                                       |
| ---------------------- | ------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/update_event_properties`            |
| **RTM API equivalent** | [`update_event_properties`](rtm-reference/#update-event-properties)                   |
| **Webhook**            | [`event_properties_updated`](/management/configuration-api/#event_properties_updated) |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                        |
| ------------ | -------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to set properties for.                                                                                                                               |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to set properties for.                                                                                                                             |
| `event_id`   | Yes      | `string`  | Id of the event you want to set properties for.                                                                                                                              |
| `properties` | Yes      | `object`  | Chat properties to set. You should stick to the [general properties format](/management/configuration-api/#properties) and include _namespace_, _property name_ and _value_. |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/update_event_properties?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
    	"chat_id": "Q1GZ3FNAT9",
    	"thread_id": "Q1GZ3FNAU9",
      "event_id": "Q1GZ3FNAU9_1",
      "properties": {
          "0805e283233042b37f460ed8fbf22160": {
            "string_property": "Event property value updated by Customer"
              }
          }
      }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Delete Event Properties

#### Specifics

|                        |                                                                                       |
| ---------------------- | ------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/delete_event_properties`            |
| **RTM API equivalent** | [`delete_event_properties`](rtm-reference/#delete-event-properties)                   |
| **Webhook**            | [`event_properties_deleted`](/management/configuration-api/#event_properties_deleted) |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                            |
| ------------ | -------- | --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete the properties of.                                                                                                                             |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to delete the properties of.                                                                                                                           |
| `event_id`   | Yes      | `string`  | Id of the event you want to delete the properties of.                                                                                                                            |
| `properties` | Yes      | `object`  | Event properties to delete. You should stick to the [general properties format](/management/configuration-api/#properties) and include _namespace_, _property name_ and _value_. |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/delete_event_properties?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
    	"chat_id": "Q1GZ3FNAT9",
    	"thread_id": "Q1GZ3FNAU9",
      "event_id": "Q1GZ3FNAU9_1",
      "properties": {
          "0805e283233042b37f460ed8fbf22160": [
              "string_property"
              ]
          }
      }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### List License Properties

Returns the properties of a given license. It only returns the properties a Customer has access to.

#### Specifics

|                        |                                                                            |
|------------------------|----------------------------------------------------------------------------|
| **HTTP Method**        | **GET**                                                                    |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/list_license_properties` |
| **RTM API equivalent** | -                                                                          |
| **Webhook**            | -                                                                          |

#### Request

| Query string parameter | Required | Data type | Notes                                                   |
| ---------------------- | -------- | --------- | ------------------------------------------------------- |
| `license_id`           | Yes      | `number`  | Id of the license you want to return the properties of. |
| `namespace`            | No       | `string`  | Property namespace to retrieve                          |
| `name`                 | No       | `string`  | Property name                                           |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X GET \
  'https://api.livechatinc.com/v3.2/customer/action/list_license_properties?license_id=123&namespace=0805e283233042b37f460ed8fbf22160&name=string_property' \
  -H 'Content-Type: application/json'
```

</CodeSample>

<CodeResponse>

```json
{
    "0805e283233042b37f460ed8fbf22160": {
        "string_property": "string value"
    }
}
```

</CodeResponse>

</Code>

</Section>

<Section>

<Text>

### List Group Properties

Returns the properties of a given group. It only returns the properties a Customer has access to.

#### Specifics

|                        |                                                                          |
|------------------------|--------------------------------------------------------------------------|
| **HTTP Method**        | **GET**                                                                  |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/list_group_properties` |
| **RTM API equivalent** | -                                                                        |
| **Webhook**            | -                                                                        |

#### Request

| Query string parameter | Required | Data type | Notes                                                   |
| ---------------------- | -------- | --------- | ------------------------------------------------------- |
| `license_id`           | Yes      | `number`  | Id of the license you want to return the properties of. |
| `group_id`             | Yes      | `number`  | Id of the group you want to return the properties of.   |
| `namespace`            | No       | `string`  | Property namespace to retrieve                          |
| `name`                 | No       | `string`  | Property name                                           |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X GET \
  'https://api.livechatinc.com/v3.2/customer/action/list_group_properties?license_id=11069052&group_id=1&namespace=0805e283233042b37f460ed8fbf22160&name=string_property' \
  -H 'Content-Type: application/json'
```

</CodeSample>

<CodeResponse>

```json
{
  "0805e283233042b37f460ed8fbf22160": {
      "string_property": "string value"
  }
}
```

</CodeResponse>

</Code>

</Section>

## Customers

<Section>

<Text>

### Update Customer

#### Specifics

|                        |                                                                    |
| ---------------------- | ------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/update_customer` |
| **RTM API equivalent** | [`update_customer`](rtm-reference/#update-customer)                |
| **Webhook**            | -                                                                  |

#### Request

| Parameter        | Required | Data type  | Notes                                                                              |
| ---------------- | -------- | ---------- | ---------------------------------------------------------------------------------- |
| `name`           | No       | `string`   |                                                                                    |
| `email`          | No       | `string`   |                                                                                    |
| `avatar`         | No       | `string`   | The URL of the Customer's avatar                                                   |
| `session_fields` | No       | `[]object` | An array of custom object-enclosed `key:value` pairs. Respects the order of items. |

At least one optional parameter needs to be included in the request.

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
'https://api.livechatinc.com/v3.2/customer/action/update_customer?license_id=<license_id>' \
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer <customer_access_token>' \
-d '{
      "name": "Thomas Anderson",
      "email": "t.anderson@example.com",
      "avatar": "example.com/avatars/1.png",
      "session_fields": [{
        "custom_key": "custom_value"
      }, {
        "another_custom_key": "another_custom_value"
      }]
    }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Set Customer Session Fields

#### Specifics

|                        |                                                                                |
| ---------------------- | ------------------------------------------------------------------------------ |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/set_customer_session_fields` |
| **RTM API equivalent** | [`set_customer_session_fields`](rtm-reference/#set-customer-session-fields)    |
| **Webhook**            | [`customer_updated`](/management/configuration-api/#customer_updated)          |

#### Request

| Parameter        | Required | Data type  | Notes                                                                                            |
| ---------------- | -------- | ---------- | ------------------------------------------------------------------------------------------------ |
| `session_fields` | Yes      | `[]object` | An array of custom object-enclosed `key:value` pairs. Respects the order of items. Max keys: 100 |

Users Agent and referrer are updated by default using the browser‚Äôs headers.

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
'https://api.livechatinc.com/v3.2/customer/action/set_customer_session_fields?license_id=<license_id>' \
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer <customer_access_token>' \
-d '{
      "session_fields": [{
        "custom_key": "custom_value"
      }, {
        "another_custom_key": "another_custom_value"
      }]
    }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Get Customer

Returns the info about the Customer requesting it.

#### Specifics

|                        |                                                                 |
| ---------------------- | --------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/get_customer` |
| **RTM API equivalent** | [`get_customer`](rtm-reference/#get-customer)                   |
| **Webhook**            | -                                                               |

#### Response

|                  |                                                                                                                 |
| ---------------- | --------------------------------------------------------------------------------------------------------------- |
| `name`           | [Customer's](#customer) name. Returned only if set.                                                             |
| `email`          | [Customer's](#customer) email. Returned only if set.                                                            |
| `avatar`         | [Customer's](#customer) avatar. Returned only if set.                                                           |
| `session_fields` | An array of custom object-enclosed `key:value` pairs. Returned only if set. Available for the session duration. |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
'https://api.livechatinc.com/v3.2/customer/action/get_customer?license_id=<license_id>' \
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer <customer_access_token>' \
-d '{}'
```

</CodeSample>

<CodeResponse>

```json
{
  "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "type": "customer",
  "name": "Thomas Anderson", // optional
  "email": "t.anderson@example.com", // optional
  "avatar": "https://example.com/avatars/1.jpg", // optional
  "session_fields": [{ // optional
    "custom_key": "custom_value"
  }, {
    "another_custom_key": "another_custom_value"
  }]
}
```

</CodeResponse>

</Code>

</Section>

## Status

<Section>

<Text>

### List Group Statuses

#### Specifics

|                        |                                                                        |
|------------------------|------------------------------------------------------------------------|
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/list_group_statuses` |
| **RTM API equivalent** | [`list_group_statuses`](rtm-reference/#list-group-statuses)            |
| **Webhook**            | -                                                                      |

#### Request

| Parameter   | Required | Data type | Notes                                                      |
| ----------- | -------- | --------- | ---------------------------------------------------------- |
| `all`       | No       | `bool`    | If set to `true`, you will get statuses of all the groups. |
| `group_ids` | No       | `array`   | A table of groups' IDs                                     |

One of the optional parameters needs to be included in the request.

#### Response

No response payload (`200 OK`).

#### Response

|                   |                                                                                                  |     |
| ----------------- | ------------------------------------------------------------------------------------------------ | --- |
| `Group Not Found` | If you send `group_id` of a group that doesn't exists, the id won't be included in the resposne. |     |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/list_group_statuses?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "all": true
      }'
```

</CodeSample>

<CodeResponse>

```json
{
  "groups_status": {
    //1,2,3 are group ids, online/offline/online_for_queue are statuses of the groups

    1: "online",
    2: "offline",
    3: "online_for_queue"
  }
}
```

</CodeResponse>

</Code>

</Section>

## Other

<Section>

<Text>

### Check Goals

Customer can use this method to trigger checking if [goals](https://www.livechatinc.com/help/goals-set-up-and-use/) were achieved. Then, Agents receive the information. You should call this method to provide goals parameters for the server when the customers limit is reached. Works only for offline Customers.

#### Specifics

|                        |                                                                |
| ---------------------- | -------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/check_goals` |
| **RTM API equivalent** | -                                                              |
| **Webhook**            | -                                                              |

#### Request

| Parameter        | Required | Data type  | Notes                                                |
| ---------------- | -------- | ---------- | ---------------------------------------------------- |
| `session_fields` | Yes      | `[]object` | An array of custom object-enclosed `key:value` pairs |
| `group_id`       | Yes      | `number`   |                                                      |
| `page_url`       | Yes      | `string`   |                                                      |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
'https://api.livechatinc.com/v3.2/customer/action/check_goals?license_id=<license_id>' \
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer <customer_access_token>' \
-d '{
      "page_url": "https://mypage.com",
      "session_fields": [{
        "custom_key": "custom_value"
      }, {
        "another_custom_key": "another_custom_value"
      }],
      "group_id": 0
    }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Get Form

Returns an empty ticket form of a <a href="https://www.livechatinc.com/help/chat-surveys/" target="_blank">prechat or postchat survey</a>.

#### Specifics

|                        |                                                             |
| ---------------------- | ----------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/get_form` |
| **RTM API equivalent** | [`get_form`](rtm-reference/#get-form)                       |
| **Webhook**            | -                                                           |

#### Request

| Parameter  | Required | Data type | Notes                                               |
| ---------- | -------- | --------- | --------------------------------------------------- |
| `group_id` | Yes      | `number`  | Id of the group from which you want the form.       |
| `type`     | Yes      | `string`  | Form type; possible values: `prechat` or `postchat` |

#### Response

| Parameter | Notes                                                                                                                  |
| --------- | ---------------------------------------------------------------------------------------------------------------------- |
| `enabled` | If `enabled: false`, the `form` object is not returned. Prechat/postchat survey disabled in the LiveChat Agent App UI. |
| `header`  | For headers; the field has no `answer`, therefore is not sent in the [Filled form](#filled-form) event.                |
| `rating`  | For rating; the field has no `answer`, therefore is not sent in the [Filled form](#filled-form) event.                 |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/get_form?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
        "group_id": 0,
        "type": "prechat"
      }'
```

</CodeSample>

<CodeResponse>

```json
{
    "form": {
        "id": "157986144052005549",
        "fields": [
            {
                "id": "157986144052003238",
                "type": "header",
                "label": "Welcome to our LiveChat! Please fill in the form below before starting the chat."
            },
            {
                "id": "157986144052008371",
                "type": "name",
                "label": "Name:",
                "required": false
            },
            {
                "id": "157986144052005782",
                "type": "email",
                "label": "E-mail:",
                "required": false
            },
            {
                "id": "157986144052009331",
                "type": "group_chooser",
                "label": "Choose a department:",
                "required": true,
                "options": [
                    {
                        "id": "0",
                        "group_id": 1,
                        "label": "Marketing"
                    },
                    {
                        "id": "1",
                        "group_id": 2,
                        "label": "Sales"
                    },
                    {
                        "id": "2",
                        "group_id": 0,
                        "label": "General"
                    }
                ]
            }
        ]
    },
    "enabled": true
}
```

</CodeResponse>

</Code>

</Section>

<Section>

<Text>

### Get Predicted Agent

Gets the predicted Agent - the one the Customer will chat with when the chat starts. To use this method, the Customer needs to be logged in, which can be done via the [`login`](rtm-reference/#login) method.

#### Specifics

|                        |                                                                        |
| ---------------------- | ---------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/get_predicted_agent` |
| **RTM API equivalent** | [`get_predicted_agent`](rtm-reference/#get-predicted-agent)            |
| **Webhook**            | -                                                                      |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/get_predicted_agent?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{}'
```

</CodeSample>

<CodeResponse>

```json
{
  "id": "b5657aff34dd32e198160d54666df9d8",
  "name": "Agent Smith",
  "avatar": "https://example.avatar/example.com",
  "is_bot": false,
  "job_title": "support hero",
  "type": "agent"
}
```

</CodeResponse>

</Code>

</Section>

<Section>

<Text>

### Get URL Info

It returns the info on a given URL.

#### Specifics

|                        |                                                                 |
|------------------------|-----------------------------------------------------------------|
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/get_url_info` |
| **RTM API equivalent** | [`get_url_info`](rtm-reference/#get-url-info)                   |
| **Webhook**            | -                                                               |

#### Request

| Parameter | Required | Data type | Notes             |
| --------- | -------- | --------- | ----------------- |
| `url`     | Yes      | `string`  | Valid website URL |

#### Response

| Parameter            | Data type | Notes                                                  |
| -------------------- | --------- | ------------------------------------------------------ |
| `image_url`          | `string`  | URL of the minified image hosted on the LiveChat's CDN |
| `image_original_url` | `string`  | URL of the original image                              |

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/get_url_info?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "url": "https://livechatinc.com"
      }'
```

</CodeSample>

<CodeResponse>

```json
{
  "title": "LiveChat | Live Chat Software and Help Desk Software",
  "description": "LiveChat - premium live chat software and help desk software for business. Over 24 000 companies from 150 countries use LiveChat. Try now, chat for free!",
  "image_url": "https://example.com/image.png",
  "image_original_url": "https://example-original-url.com/image.png",
  "image_width": 200,
  "image_height": 200,
  "url": "https://livechatinc.com"
}
```

</CodeResponse>

</Code>

</Section>

<Section>

<Text>

### Mark Events As Seen

#### Specifics

|                        |                                                                                 |
| ---------------------- | ------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/mark_events_as_seen`          |
| **RTM API equivalent** | [`mark_events_as_seen`](rtm-reference/#mark-events-as-seen)                     |
| **Webhook**            | [`events_marked_as_seen`](/management/configuration-api/#events_marked_as_seen) |

#### Request

| Parameter    | Required | Data type | Notes                     |
| ------------ | -------- | --------- | ------------------------- |
| `chat_id`    | Yes      | `string`  |                           |
| `seen_up_to` | Yes      | `string`  | RFC 3339 date-time format |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/mark_events_as_seen?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "chat_id": "PJ0MRSHTDG",
      "seen_up_to": "2017-10-12T15:19:21.010200Z"
      }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Accept Greeting

Marks an incoming greeting as seen.

**How it's implemented in LiveChat:**

The Chat Widget uses this method to inform that a Customer has seen a greeting. Based on that, the Reports section displays the greetings
that were actually seen by Customers, not all the sent greetings. If a Customer started a chat from a greeting, but the **Accept Method** wasn't executed,
the greeting is still counted as seen in Reports.


#### Specifics

|                        |                                                                                       |
| ---------------------- | ------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/accept_greeting`                    |
| **RTM API equivalent** | [`accept_greeting`](/messaging/customer-chat-api/v3.2/rtm-reference/#accept-greeting) |
| **Webhook**            | -                                                                                     |

#### Request

| Parameter     | Required | Data type | Notes                                                                                                                                                 |
| ------------- | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| `greeting_id` | Yes      | `number`  | ID of the greeting configured within the license to accept.                                                                                           |
| `unique_id`   | Yes      | `string`  | ID of the greeting to accept. You can get it from the [`incoming_greeting`](/messaging/customer-chat-api/v3.2/rtm-reference/#incoming_greeting) push. |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/accept_greeting?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "greeting_id": 7,
      "unique_id": "Q10X0W041P"
      }'
```

</CodeSample>

</Code>

</Section>

<Section>

<Text>

### Cancel Greeting
Cancels a greeting (an invitation to the chat). For example, Customers could cancel greetings by minimalizing the chat widget with a greeting.

#### Specifics

|                        |                                                                                       |
| ---------------------- | ------------------------------------------------------------------------------------- |
| **Method URL**         | `https://api.livechatinc.com/v3.2/customer/action/cancel_greeting`                    |
| **RTM API equivalent** | [`cancel_greeting`](/messaging/customer-chat-api/v3.2/rtm-reference/#cancel-greeting) |
| **Webhook**            | -                                                                                     |

#### Request

| Parameter   | Required | Data type | Notes                                                                                                                                                 |
| ----------- | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| `unique_id` | Yes      | `string`  | ID of the greeting to cancel. You can get it from the [`incoming_greeting`](/messaging/customer-chat-api/v3.2/rtm-reference/#incoming_greeting) push. |

#### Response

No response payload (`200 OK`).

</Text>

<Code>

<CodeSample path={'REQUEST'}>

```shell
curl -X POST \
  'https://api.livechatinc.com/v3.2/customer/action/cancel_greeting?license_id=<license_id>' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <customer_access_token>' \
  -d '{
      "unique_id": "Q10X0W041P"
      }'
```

</CodeSample>

</Code>

</Section>

# Webhooks

Here's what you need to know about **webhooks**:

- Webhooks notify you when specific events are triggered.
- They can be generated by both Web and RTM API actions.
- When using RTM API, you can be also notified about events with [pushes](/messaging/customer-chat-api/rtm-reference/#pushes).
- Webhooks and pushes have similar payloads.

You can create and manage webhooks via the [Configuration API](/management/configuration-api/#webhooks). Refer to this document to see the list of **available webhooks**, as well as **sample payloads**.

# Errors

<CodeResponse title={'General error format'}>

```json
{
  "error": {
    "type": "misdirected_request",
    "message": "Wrong region",
    "data": {
      // optional
      "region": "dal"
    }
  }
}
```

</CodeResponse>

<Section>

<Text>

#### Possible errors

| Type                    | Default Message               | Notes                                                                                                                      |
| ----------------------- | ----------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| `authentication`        | Authentication error          | An invalid or expired access token.                                                                                        |
| `authorization`         | Authorization error           | Agent is not allowed to perform the action.                                                                                |
| `customer_banned`       | Customer is banned            | The customer had been banned.                                                                                              |
| `entity_too_large`      | Upload limit exceeded (10MB). | Client's request is too large.                                                                                             |
| `greeting_not_found`    | Greeting not found            |
| `group_not_found`       | Group not found               |
| `group_offline`         | Group is offline              | Thrown in response to [Get Predicted Agent](#get-predicted-agent).                                                         |
| `group_unavailable`     | No agent available for group  | Thrown in response to [Get Predicted Agent](#get-predicted-agent). The group is online, but there are no available Agents. |
| `groups_offline`        | Groups offline                |
| `internal`              | Internal server error         |
| `license_expired`       | License expired               | The end of license trial or subcription.                                                                                   |
| `license_not_found`     | License not found             | License with the specified ID doesn't exist.                                                                               |
| `misdirected_request`   | Wrong region                  | Client's request should be performed to another region.  It returns the correct `region` in the optional `data` object.    |
| `validation`            | Wrong format of request       |
| `request_timeout`       | Request timed out             | Timeout threshold is 15 seconds.                                                                                           |
| `unsupported_version`   | Unsupported version           | Unsupported protocol version.                                                                                              |
| `wrong_product_version` | Wrong product version         | License is not LiveChat 3 (probably still LiveChat 2).                                                                     |

</Text>

</Section>

# Contact us

If you found a bug or a typo, you can let us know directly on GitHub.
In case of any questions or feedback, don't hesitate to contact us at [developers@livechatinc.com](mailto:developers@livechatinc.com). We'll be happy to hear from you!

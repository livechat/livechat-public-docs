---
weight: 21
category: "messaging"
subcategory: "agent-chat-api"
title: "RTM API Reference"
tagline: "Interact with the chat as an Agent."
desc: "Build powerful LiveChat integrations with an open messaging protocol. Use the Agent Chat RTM API to send messages, manage access and properties."
apiVersion: "3.2"
---

# Introduction

## Versioning

This documentation describes the **Agent Chat Real-Time Messaging API v3.2**. This is the **legacy** version. We encourage you to migrate to the latest stable version. [Read more about versioning...](/messaging/#api-versioning)

## What is RTM API

Real-Time Messaging API (RTM API) is based on a websocket-like connection. Client can send a **request message** that results in getting a **response message**. It's also possible to get **push messages**.

## When to use RTM API

If you're wondering which API to use - Agent Chat **RTM API** or **Web API**, keep on reading.

**Real-Time Messaging API** allows for building stateful integrations that require **logging in** and **maintaining the connection**. Since connection maintenance is required, the implementation might be more challenging than with Web API.

Agent Chat RTM API enables communication in real time. It supports pushes like `sneak peek`, `typing indicator`, and other. Web API doesn’t have equivalent webhooks, which means you won't be informed about certain events using Web API.

Also, the RTM API will be a better choice if you want to avoid time delays or presume significant traffic.
**Not what you're looking for?** Perhaps, you need to use [**Agent Chat Web API**](..) instead.

## Access

The basics on authorization, server pinging, and scopes in the Agent Chat RTM API.

### Authorization

**Agent authorization** is handled with access tokens. Find out how to get an **access token** from [Agent authorization flows](/authorization/authorizing-api-calls/#agent-authorization-flows). You need to authorize within 30 seconds from establishing the connection. Otherwise, the connection will be closed. Given that the connection is continuosly maintained, you only need to authorize once.

### Server pinging

After successful authorization, the client needs to **ping the server** every 15 seconds. Otherwise, the connection will be closed after about 30 seconds of inactivity. Until authorization is completed, ping is a no-op.

Use one of these 2 ways of pinging the server:

- **Protocol message with the ping action**

For web applications and backend integrations (e.g. in Python, Go). Send the following request every 15 seconds:

```json
{
  "action": "ping",
  "payload": {}
}
```

After pinging the server, the client will receive a response with the `ping` action. Thanks to that, the client can make sure the connection is still alive.

- **The control frame ping in the websocket protocol**

For backend integrations; unavailable in web browsers. Read more about the [control frame ping](https://tools.ietf.org/html/rfc6455#section-5.5.2).

### Scopes

All authorization scopes are listed in the [Scopes](/getting-started/authorization/scopes/) document. If a method requires particular authorization scopes, you'll find them included in the method description.

## Data centers

LiveChat system operates in two data centers: `dal` (USA) and `fra` (Europe). The default data center is `dal`.

For backend applications, you can specify the region in the request header. The mechanism is the same as in [Agent Chat Web API reference](../#data-centers). It doesn't work for frontend applications, though.
Instead, frontend apps connect to a region different than the default one by specifying the region suffix in the URL.

**`fra`:** `wss://api-fra.livechatinc.com/v3.2/agent/rtm/ws`

**`dal`:** `wss://api.livechatinc.com/v3.2/agent/rtm/ws`

## Rate limits

To prevent sending a massive number of requests, there are rate limits for method calls. After exceeding those limits, the requester will get a `Too many requests` error in the response of a specific request. After some time, the request will be unblocked so it can be sent again.

# Events

One of the data structures are **events**. They are sent to a chat via the `send_event` method.
Apart from events, there are also [Properties](#properties), [Users](#users), and [Other data structures](#other-common-structures).

These are the available **event types**:

- [File](#file)
- [Filled form](#filled-form)
- [Message](#message)
- [Rich message](#rich-message)
- [Custom](#custom)
- [System message](#system-message)

## File

<Section>
<Text>

The **File** event informs about an uploaded file.

### Request

| Parameter    | Required | Data type |                                                                                                                                     Notes |
| ------------ | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------: |
| `custom_id`  | no       | `string`  |                                                                                                                                           |
| `type`       | yes      | `string`  |                                                                                                                                    `file` |
| `recipients` | yes      | `string`  |                                                                                                Possible values: `all` (default), `agents` |
| `properties` | no       | `object`  |                                                                                                                 [Properties](#properties) |
| `url`        | yes      | `string`  | Has to point to the LiveChat CDN. It's recommended to use the URL returned by [`upload_file`](/messaging/customer-chat-api/#upload-file). |

### Response

| Field                              | Returned        |                                                               Notes |
| ---------------------------------- | :-------------- | ------------------------------------------------------------------: |
| `id`                               | always          |                                                                     |
| `custom_id`                        | optionally      |                                                                     |
| `created_at`                       | always          | Date & time format with a resolution of microseconds, `UTC string`. |
| `type`                             | always          |                                                                     |
| `author_id`                        | always          |                                                                     |
| `recipients`                       | always          |                                                                     |
| `properties`                       | optionally      |                                                                     |
| `name`                             | always          |                                                                     |
| `url`                              | always          |                                                                     |
| `thumbnail_url`, `thumbnail2x_url` | only for images |                                                                     |
| `content_type`                     | always          |                                                                     |
| `size`, `width`, `height`          | only for images |                                                                     |

</Text>
<Code>
<CodeResponse version="v3.2" type="agent" title={'Sample File in response'} json="file"/>
</Code>
</Section>

## Filled form

<Section>
<Text>

The **Filled form** event contains data from a form (prechat or postchat survey).

### Request

| Parameter    | Required | Data type | Notes                                                                                  |
| ------------ | -------- | --------- | -------------------------------------------------------------------------------------- |
| `custom_id`  | no       | `string`  |                                                                                        |
| `type`       | yes      | `string`  | `filled_form`                                                                          |
| `recipients` | yes      | `string`  | Possible values: `all` (default), `agents`                                             |
| `properties` | no       | `object`  | [Properties](#properties)                                                              |
| `form_id`    | yes      | `string`  |                                                                                        |
| `fields`     | yes      | `array`   | The fields a form contains. See [filled form fields](#filled-form-fields) for details. |

### Response

| Field        | Returned   | Notes                                                               |
| ------------ | ---------- | ------------------------------------------------------------------- |
| `id`         | always     |                                                                     |
| `custom_id`  | optionally |                                                                     |
| `created_at` | always     | Date & time format with a resolution of microseconds, `UTC string`. |
| `type`       | always     |                                                                     |
| `author_id`  | always     |                                                                     |
| `recipients` | always     |                                                                     |
| `properties` | optionally |                                                                     |
| `form_id`    | always     |                                                                     |
| `fields`     | always     | An array of [filled form fields](#filled-form-fields)               |

</Text>

<Code>
<CodeResponse version="v3.2" type="agent" title={'Sample Filled form in response'} json="filledForm"/>
</Code>
</Section>

## Message

<Section>
<Text>

The **Message** event contains text message to other chat users.

### Request

| Parameter            | Required | Data type | Notes                                                                                                                        |
| -------------------- | -------- | --------- | ---------------------------------------------------------------------------------------------------------------------------- |
| `custom_id`          | no       | `string`  |                                                                                                                              |
| `text`               | yes      | `string`  | Max. raw text size is 16 KB (one UTF-8 char like emoji 😁 can use up to 4 B); to send more, split text into several messages. |
| `type`               | yes      | `string`  | `message`                                                                                                                    |
| `recipients`         | yes      | `string`  | Possible values: `all` (default), `agents`                                                                                   |
| `properties`         | no       | `object`  | [Properties](#properties)                                                                                                    |
| `postback`           | no       | `object`  | Indicates that the message event was generated in response to a rich message event.                                          |
| `postback.id`        | yes      | `string`  | ID of the postback from the rich message event.                                                                              |
| `postback.thread_id` | yes      | `string`  | ID of the thread with the rich message event.                                                                                |
| `postback.event_id`  | yes      | `string`  | ID of the rich message event.                                                                                                |
| `postback.type`      | no       | `string`  | Should be used together with `postback.value` (when  one of them is present, the other is required).                         |
| `postback.value`     | no       | `string`  | Should be used together with `postback.type` (when  one of them is present, the other is required).                          |

### Response

| Field                | Returned   | Notes                                                               |
| -------------------- | ---------- | ------------------------------------------------------------------- |
| `id`                 | always     |                                                                     |
| `custom_id`          | optionally |                                                                     |
| `created_at`         | always     | Date & time format with a resolution of microseconds, `UTC string`. |
| `type`               | always     | `message`                                                           |
| `author_id`          | always     |                                                                     |
| `recipients`         | always     |                                                                     |
| `text`               | always     |                                                                     |
| `postback`           | optionally | Appears in a message only when triggered by a rich message.         |
| `postback.id`        | always     |                                                                     |
| `postback.thread_id` | always     |                                                                     |
| `postback.event_id`  | always     |                                                                     |
| `postback.type`      | optionally | Appears only if `postback.value` is present.                        |
| `postback.value`     | optionally | Appears only if `postback.type` is present.                         |
| `properties`         | optionally | [Properties](#properties)                                           |

</Text>
<Code>
<CodeResponse version="v3.2" type="agent" title={'Sample Message in response'} json="message"/>
</Code>
</Section>

## Rich message

<Section>
<Text>

Rich message (RM) event contains a rich message data structure. [Read more](/extending-ui/extending-chat-widget/rich-messages/) about rich messages.

### Request

| Parameter                         | Required | Data type | Notes                                                                                                                                                                                                                                                                                                  |
| --------------------------------- | -------- | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `custom_id`                       | no       | `string`  | You can give your RM a custom ID.                                                                                                                                                                                                                                                                      |
| `type`                            | yes      | `string`  | Event type: `rich_message`                                                                                                                                                                                                                                                                             |
| `recipients`                      | yes      | `string`  | Those who can display the rich message: `all` (default) or `agents`                                                                                                                                                                                                                                    |
| `properties`                      | no       | `object`  | The [properties](#properties) data structure                                                                                                                                                                                                                                                           |
| `template_id`                     | yes      | `string`  | Defines how every Rich Message will be presented. Values: `cards`, `sticker`, or `quick_replies`.                                                                                                                                                                                                      |
| `elements`                        | no       | `array`   | Can contain up to 10 `element` objects.                                                                                                                                                                                                                                                                |
| `elements.title`                  | yes      | `string`  | Displays formatted text on RMs.                                                                                                                                                                                                                                                                        |
| `elements.subtitle`               | yes      | `string`  | Displays formatted text on RMs.                                                                                                                                                                                                                                                                        |
| `elements.image`                  | yes      | `image`   | Displays images on RMs. Required param: `url`; Optional params: `name`, `content_type`, `size`, `width`, `height`.                                                                                                                                                                                     |
| `elements.buttons`                | no       | `array`   | Displays buttons. Can contain up to 13 `button` objects.                                                                                                                                                                                                                                               |
| `elements.buttons.text`           | yes      | `string`  | Text displayed on a button.                                                                                                                                                                                                                                                                            |
| `elements.buttons.type`           | yes      | `string`  | Defines the behavior after a user clicks the button. Should be used together with `elements.buttons.value` (when  one of them is present, the other is required). Possible values: `webview`, `message`, `url`, `phone`. [More...](/extending-ui/extending-chat-widget/rich-messages/#getting-started) |
| `elements.buttons.value`          | yes      | `string`  | Should be used together with `elements.buttons.type` (when  one of them is present, the other is required). You can use this field to give the rich message of a `webview` type (a Moment) a custom title. [More...](/extending-chat-widget/chat-widget-moments/#how-to-start)                         |
| `elements.buttons.webview_height` | yes      | `string`  | Required only for the `webview` button`type`. Possible values: `compact`, `full`, `tall`.                                                                                                                                                                                                              |
| `elements.buttons.postback_id`    | yes      | `string`  | A description of the sent action. Describes the action sent via `send_rich_message_postback`. [More...](/extending-ui/extending-chat-widget/rich-messages/#getting-started)                                                                                                                            |
| `elements.buttons.user_ids`       | yes      | `array`   | Describes users that sent the postback with `"toggled": true`.                                                                                                                                                                                                                                         |

### Response

| Field                             | Returned   | Notes                                                                                      |
| --------------------------------- | ---------- | ------------------------------------------------------------------------------------------ |
| `id`                              | always     | Generated server-side                                                                      |
| `custom_id`                       | optionally |                                                                                            |
| `type`                            | always     |                                                                                            |
| `author_id`                       | always     | Generated server-side                                                                      |
| `created_at`                      | always     | Date & time format with a resolution of microseconds, `UTC string`. Generated server-side. |
| `recipients`                      | always     |                                                                                            |
| `properties`                      | optionally |                                                                                            |
| `template_id`                     | always     |                                                                                            |
| `elements`                        | optionally |                                                                                            |
| `elements.title`                  | always     |                                                                                            |
| `elements.subtitle`               | always     |                                                                                            |
| `elements.image`                  | always     |                                                                                            |
| `elements.buttons`                | optionally |                                                                                            |
| `elements.buttons.text`           | always     |                                                                                            |
| `elements.buttons.type`           | always     |                                                                                            |
| `elements.buttons.value`          | always     |                                                                                            |
| `elements.buttons.webview_height` | always     | Unless button `type` is different than `webview`.                                          |
| `elements.buttons.postback_id`    | always     |                                                                                            |
| `elements.buttons.user_ids`       | always     |                                                                                            |

</Text>
<Code>
<CodeResponse version="v3.2" type="agent" title={'Sample Rich message in response'} json="richMessage"/>
</Code>
</Section>

## Custom

<Section>
<Text>

Custom event is an event with customizable payload.

### Request

| Parameter    | Required | Data type | Notes                                                               |  |
| ------------ | -------- | --------- | ------------------------------------------------------------------- |
| `custom_id`  | no       | `string`  | You can give the event a custom ID.                                 |
| `type`       | yes      | `string`  | Event type: `custom`                                                |
| `content`    | no       | `object`  | The content you define                                              |
| `recipients` | yes      | `string`  | Those who can receive the custom event: `all` (default) or `agents` |
| `properties` | no       | `object`  | The [properties](#properties) data structure                        |

### Response

| Field        | Returned   | Notes                                                                                     |
| ------------ | ---------- | ----------------------------------------------------------------------------------------- |
| `id`         | always     | Generated server-side                                                                     |
| `custom_id`  | optionally |                                                                                           |
| `type`       | always     |                                                                                           |
| `author_id`  | always     | Generated server-side                                                                     |
| `created_at` | always     | Date & time format with a resolution of microseconds, `UTC string`; generated server-side |
| `content`    | optionally |                                                                                           |
| `recipients` | always     |                                                                                           |
| `properties` | optionally |                                                                                           |

</Text>
<Code>
<CodeResponse version="v3.2" type="agent" title={'Sample Custom event in response'} json="custom"/>
</Code>
</Section>

## System message

<Section>
<Text>

System message event is native system event sent in specific situations.

### Request

| Parameter             | Required | Data type |                                                                                                                            Notes |
| --------------------- | -------- | --------- | -------------------------------------------------------------------------------------------------------------------------------: |
| `custom_id`           | no       | `string`  |                                                                                     You can give the system message a custom ID. |
| `type`                | yes      | `string`  |                                                                                                                 `system_message` |
| `text`                | no       | `string`  |                                                                                                     Text displayed to recipients |
| `system_message_type` | yes      | `string`  |                                                                    [System message type](/messaging/references/system-messages/) |
| `recipients`          | no       | `string`  | It can be specified when sending system messages via the [**Send Event**](#send-event) method. Possible values: `all`, `agents`. |
| `text_vars`           | no       | `object`  |                                                                                                       Variables used in the text |

### Response

| Field                 | Returned   | Notes                                                                                     |
| --------------------- | ---------- | ----------------------------------------------------------------------------------------- |
| `id`                  | always     | Generated server-side                                                                     |
| `custom_id`           | optionally |                                                                                           |
| `type`                | always     |                                                                                           |
| `created_at`          | always     | Date & time format with a resolution of microseconds, `UTC string`; generated server-side |
| `text`                | optionally |                                                                                           |
| `system_message_type` | always     |                                                                                           |
| `recipients`          | optionally |                                                                                           |

</Text>

<Code>
<CodeResponse version="v3.2" type="agent" title={'Sample System message in response'} json="systemMessage"/>
</Code>
</Section>

# Users

**Users** are another important data structure. Within this data structure type, we can distinguish:

- [Agent](#agent)
  - [My profile](#my-profile)
- [Customer](#customer)

## Agent

<CodeResponse version="v3.2" type="agent" title={'Sample Agent data structure'} json="agent"/>

| Field               | Req./Opt. |                                                                                                                            Note |
| ------------------- | :-------: | ------------------------------------------------------------------------------------------------------------------------------: |
| `routing_status`    | optional  |                                                                               Returned only if the Agent's currently logged in. |
| `events_seen_up_to` | optional  | RFC 3339 datetime string; the timestamp of the most recent event seen by the Agent—all the previous events are considered seen. |

### My profile

<CodeResponse version="v3.2" type="agent" title={'Sample My profile data structure'} json="myProfile"/>

| Field               | Req./Opt. | Notes                                                                                                                           |
| ------------------- | --------- | ------------------------------------------------------------------------------------------------------------------------------- |
| `events_seen_up_to` | optional  | RFC 3339 datetime string; the timestamp of the most recent event seen by the Agent—all the previous events are considered seen. |

## Customer

<CodeResponse version="v3.2" type="agent" title={'Sample Customer data structure'} json="customer"/>

| Field                            | Req./Opt. | Notes                                                                                 |
| -------------------------------- | --------- | ------------------------------------------------------------------------------------- |
| `agent_last_event_created_at`    | optional  |                                                                                       |
| `avatar`                         | optional  |                                                                                       |
| `customer_last_event_created_at` | optional  |                                                                                       |
| `created_at`                     | optional  |                                                                                       |
| `email`                          | optional  |                                                                                       |
| `session_fields`                 | optional  | An array of custom object-enclosed `key:value` pairs. Expires along with the session. |
| `name`                           | optional  |                                                                                       |
| `events_seen_up_to`              | optional  | RFC 3339 datetime string                                                              |
| `last_visit`                     | optional  |                                                                                       |
| `present`                        | optional  |                                                                                       |
| `statistics`                     | optional  |                                                                                       |

# Other common structures

Apart from [Events](#events) and [Users](#users), there are also other common data structures you might work with. Those are:

- [Access](#access)
- [Chats](#chats)
- [Chat summaries](#chat-summaries)
- [Filled form fields](#filled-form-fields)
- [Properties](#properties)
- [Threads](#threads)

## Access

<CodeResponse version="v3.2" type="agent" title={'Sample Access data structure'} json="access"/>

| Field       | Req./Opt. |                                        Note |
| ----------- | :-------: | ------------------------------------------: |
| `group_ids` | required  | `group 0` means that all agents can see it. |

## Chats

<CodeResponse version="v3.2" type="agent" title={'Sample Chat data structure'} json="chat"/>

| Field        | Req./Opt. | Note |
| ------------ | :-------: | ---: |
| `properties` | optional  |      |
| `access`     | optional  |      |

## Chat summaries

**Chat summary** is similar to the **Chat** data structure. The difference is that **Chat** contains a `thread` object, while **Chat summary** includes `last_thread_summary` and `last_event_per_type`.

<CodeResponse version="v3.2" type="agent" title={'Sample Chat summary data structure'} json="chatSummary"/>

## Filled form fields

A component of the [Filled form](#filled-form) event.

<CodeResponse version="v3.2" type="agent" title={'Sample Filled form fields'} json="filledFormFields"/>

| Field             | Required | Data type          | Notes                                                                                                    |
| ----------------- | -------- | ------------------ | -------------------------------------------------------------------------------------------------------- |
| `fields`          | yes      | `array of objects` | The fields a form contains.                                                                              |
| `type`            | yes      | `string`           | Possible values: `checkbox`, `email`, `name`, `question`, `textarea`, `group_chooser`, `radio`, `select` |
| `id`              | yes      | `string`           | Field id, for all field types                                                                            |
| `label`           | yes      | `string`           | Field label; for all field types                                                                         |
| `answer`          | yes      | `any`              | For all field types                                                                                      |
| `answer.id`       | yes      | `string`           | An identifier of each option a Customer can choose. For all field types.                                 |
| `answer.label`    | yes      | `string`           | Answer label; for all field types                                                                        |
| `answer.group_id` | yes      | `number`           | For `group_chooser`                                                                                      |

## Properties

Properties are **key-value storages**. They can be set within a chat, a thread, or an event. You can read more about properties in the [Configuration API](https://developers.livechat.com/docs/management/configuration-api/#properties) document.

<CodeResponse version="v3.2" type="agent" title={'Sample Properties data structure'} json="properties"/>

## Threads

<CodeResponse version="v3.2" type="agent" title={'Sample Thread data structure'} json="thread"/>

| Field                | Req./Opt. | Note                                                                                                       |
| -------------------- | --------- | ---------------------------------------------------------------------------------------------------------- |
| `access`             | optional  |                                                                                                            |
| `active`             | required  | Possible values: `true` (thread is still active) or `false`(thread no longer active)                       |
| `events`             | optional  | Doesn't exists if `restricted_access` is present.                                                          |
| `properties`         | optional  |                                                                                                            |
| `restricted_access`  | optional  | Contains the reason for access restriction.                                                                |
| `queue`              | optional  | Present only if the chat is in the queue. The wait time for an available agent is approximated in seconds. |
| `queues_duration`    | optional  | Present only in the [List Archives](#list-archives) responses if the chat was queued.                      |
| `previous_thread_id` | optional  | Present only if there is a preceding thread.                                                               |
| `next_thread_id`     | optional  | Present only if there is a following thread.                                                               |
| `created_at`         | required  | Date & time format with a resolution of microseconds, `UTC string`. Generated server-side.                 |

# Methods

<Section>
<Text>

| The API endpoint                              |
| --------------------------------------------- |
| `wss://api.livechatinc.com/v3.2/agent/rtm/ws` |

## Available methods

|                 |                                                                                                                                                                                                                                                                                                                                     |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Chats**       | [`list_chats`](#list-chats) [`list_threads`](#list-threads) [`get_chat`](#get-chat) [`list_archives`](#list-archives) [`start_chat`](#start-chat) [`activate_chat`](#activate-chat) [`deactivate_chat`](#deactivate-chat) [`follow_chat`](#follow-chat) [`unfollow_chat`](#unfollow-chat)                                           |
| **Chat access** | [`grant_chat_access`](#grant-chat-access) [`revoke_chat_access`](#revoke-chat-access) [`transfer_chat`](#transfer-chat)                                                                                                                                                                                                             |
| **Chat users**  | [`add_user_to_chat`](#add-user-to-chat) [`remove_user_from_chat`](#remove-user-from-chat)                                                                                                                                                                                                                                           |
| **Events**      | [`send_event`](#send-event) [`send_rich_message_postback`](#send-rich-message-postback)                                                                                                                                                                                                                                             |
| **Properties**  | [`update_chat_properties`](#update-chat-properties) [`delete_chat_properties`](#delete-chat-properties) [`update_thread_properties`](#update-thread-properties) [`delete_thread_properties`](#delete-thread-properties) [`update_event_properties`](#update-event-properties) [`delete_event_properties`](#delete-event-properties) |
| **Thread tags** | [`tag_thread`](#tag-thread) [`untag_thread`](#untag-thread)                                                                                                                                                                                                                                                                         |
| **Customers**   | [`get_customer`](#get-customer) [`list_customers`](#list-customers) [`create_customer`](#create-customer) [`update_customer`](#update-customer) [`ban_customer`](#ban-customer)                                                                                                                                                     |
| **Status**      | [`login`](#login) [`change_push_notifications`](#change-push-notifications) [`set_routing_status`](#set-routing-status) [`set_away_status`](#set-away-status) [`logout`](#logout)                                                                                                                                                   |
| **Other**       | [`mark_events_as_seen`](#mark-events-as-seen) [`send_typing_indicator`](#send-typing-indicator) [`multicast`](#multicast) [`list_agents_for_transfer`](#list-agents-for-transfer)                                                                                                                                                   |

</Text>
<Code>
<CodeSample path={'GENERAL RTM API REQUEST FORMAT'}>

```json
{
  "request_id": "<request_id>", // optional
  "action": "<action>",
  "payload": {
  // optional
  },
  "author_id": "<author_id>" // optional, applies only to bots
}
```

</CodeSample>
<CodeResponse title={'GENERAL RTM API RESPONSE FORMAT'}>

```json
{
  "request_id": "<request_id>", // optional
  "action": "<action>",
  "type": "response",
  "success": true,
  "payload": {
  // optional
  }
}
```

</CodeResponse>
</Code>
</Section>

## Chats

<Section>
<Text>

### List Chats

It returns [summaries](#chat-summaries) of the chats an Agent has access to.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `list_chats`                                      |
| **Required scopes \*** | `chats--all:ro` `chats--access:ro` `chats--my:ro` |
| **Web API equivalent** | [`list_chats`](../#list-chats)                    |
| **Push message**       | -                                                 |

#### Request

| Parameter                                             | Required | Type     | Notes                                                                                       |
| ----------------------------------------------------- | -------- | -------- | ------------------------------------------------------------------------------------------- |
| `filters`                                             | No       | `object` | Mustn't change between requests for subsequent pages. Otherwise, the behavior is undefined. |
| `filters.include_active`                              | No       | `bool`   | Defines if the returned chat summary includes active chats; default: `true`.                |
| `filters.include_chats_without_threads`               | No       | `bool`   | Defines if the returned chat summary includes chats without any threads; default: `true`.   |
| `filters.group_ids`                                   | No       | `array`  | Array of group IDs. Max array size: 200                                                     |
| `filters.properties.<namespace>.<name>.<filter_type>` | No       | `any`    |                                                                                             |
| `sort_order`                                          | No       | `string` | Possible values: `asc` - oldest chats firstm `desc` - newest chats first (default)          |
| `limit`                                               | No       | `number` | Default: 10, maximum: 100                                                                   |
| `page_id`                                             | No       | `string` |                                                                                             |

`filter_type` can take the following values:

- exists (bool)
- values (type[] - array with specific type for property: `string`, `int`, or `bool`)
- exclude_values (type[] - array with specific type for property: `string`, `int`, or `bool`)

There's only one value allowed for a single property.

#### Response

| Field              | Data type | Notes                                                                                                        |
| ------------------ | --------- | ------------------------------------------------------------------------------------------------------------ |
| `chats_summary`    | `array`   | An array of [Chat summary](#chat-summaries) data structures                                                  |
| `next_page_id`     | `string`  | In relation to `page_id` specified in the request. Appears in the response only when there's a next page.    |
| `previous_page_id` | `string`  | In relation to `page_id` specified in the request Appears in the response only when there's a previous page. |
| `found_chats`      | `number`  | An estimated number. The real number of found chats can slightly differ.                                     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "list_chats",
  "payload": {}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "list_chats",
  "type": "response",
  "success": true,
  "payload": {
    "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
    "chats_summary": [{
      "id": "PJ0MRSHTDG",
      "last_event_per_type": {
        "message": {
          "thread_id": "K600PKZON8",
          "thread_created_at": "2020-05-07T07:11:28.288340Z",
          "event": {
            "id": "Q298LUVPRH_1",
            "created_at": "2019-12-09T12:01:18.909000Z",
            "recipients": "all",
            "type": "message",
            "text": "hello world",
            "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
          }
        },
        "system_message": {
          "thread_id": "K600PKZON8",
          "thread_created_at": "2020-05-07T07:11:28.288340Z",
          "event": {
            // "System message" event
          }
        }
      },
      "users": [{
        // "Customer" user object
      }, {
        // "Agent" user object
      }],
      "last_thread_summary": {
        "id": "K600PKZON8",
        "created_at": "2020-05-07T07:11:28.288340Z",
        "user_ids": [
          "b7eff798-f8df-4364-8059-649c35c9ed0c",
          "smith@example.com"
        ],
        "properties": {
          // "Properties" object
        },
        "active": true,
        "access": {
          "group_ids": [0]
        }
      },
      "properties": {
        // "Properties" object
      },
      "access": {
        "group_ids": [0]
      },
      "is_followed": true
    }],
    "found_chats": 4
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### List Threads

It returns threads that the current Agent has access to in a given chat.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `list_threads`                                    |
| **Required scopes**    | `chats--all:ro` `chats--access:ro` `chats--my:ro` |
| **Web API equivalent** | [`list_threads`](../#list-threads)                |
| **Push message**       | -                                                 |

#### Request

| Parameter          | Required | Data type | Notes                                                                                                                                                                                                                                                       |
| ------------------ | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`          | Yes      | `string`  |                                                                                                                                                                                                                                                             |
| `sort_order`       | No       | `string`  | Possible values: `asc` - oldest threads first and `desc` - newest threads first (default).                                                                                                                                                                  |
| `limit`            | No       | `number`  | Default: 3, maximum: 100                                                                                                                                                                                                                                    |
| `page_id`          | No       | `string`  |                                                                                                                                                                                                                                                             |
| `min_events_count` | No       | `number`  | Range: 1-100; Specifies the minimum number of events to be returned in the response. It's the **total** number of events, so they can come from more than one thread. You'll get as many latest threads as needed to meet the `min_events_count` condition. |

You cannot use both `limit` and `min_events_count` at the same time.

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```shell
{
  "action": "list_threads",
    "payload": {
      "chat_id": "PWJ8Y4THAV"
    }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "list_threads",
  "type": "response",
  "success": true,
  "payload": {
    "threads": [{
      "id": "K600PKZON8",
      "created_at": "2019-12-17T07:57:41.512000Z",
      "active": true,
      "user_ids": [
        "b7eff798-f8df-4364-8059-649c35c9ed0c",
        "smith@example.com"
      ],
      "events": [{
        "id": "Q20N9CKRX2_1",
        "created_at": "2019-12-17T07:57:41.512000Z",
        "recipients": "all",
        "type": "message",
        "text": "Hello",
        "author_id": "smith@example.com"
      }],
      "properties": {
        // "Property" object
      },
      "access": {
        "group_ids": [0]
      },
      "previous_thread_id": "K600PKZOM8", // optional
      "next_thread_id": "K600PKZOO8" // optional
    }],
    "found_threads": 42,
    "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
    "previous_page_id": "MTUxNzM5ODEzMTQ5Nw==" // optional
  }
}
```

</CodeResponse>

</Code>
</Section>

<Section>
<Text>

### Get Chat

It returns a thread that the current Agent has access to in a given chat.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `get_chat`                                        |
| **Required scopes**    | `chats--all:ro` `chats--access:ro` `chats--my:ro` |
| **Web API equivalent** | [`get_chat`](../#get-chat)                        |
| **Push message**       | -                                                 |

#### Request

| Parameter   | Required | Data type | Notes                                  |
| ----------- | -------- | --------- | -------------------------------------- |
| `chat_id`   | Yes      | `string`  |                                        |
| `thread_id` | No       | `string`  | Default: the latest thread (if exists) |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "get_chat",
  "payload": {
    "chat_id": "PJ0MRSHTDG",
    "thread_id": "K600PKZON8"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>",
  "action": "get_chat",
  "type": "response",
  "success": true,
  "payload": {
    "id": "PJ0MRSHTDG",
    "thread": {
      "id": "K600PKZON8",
      "created_at": "2020-05-07T07:11:28.288340Z",
      "active": true,
      "user_ids": [
        "b7eff798-f8df-4364-8059-649c35c9ed0c",
        "smith@example.com"
      ],
      "events": [{
        "id": "Q20N9CKRX2_1",
        "created_at": "2019-12-17T07:57:41.512000Z",
        "recipients": "all",
        "type": "message",
        "text": "Hello",
        "author_id": "smith@example.com"
      }],
      "properties": {
        "0805e283233042b37f460ed8fbf22160": {
          "string_property": "string_value"
        }
      },
      "access": {
        "group_ids": [0]
      },
      "previous_thread_id": "K600PKZOM8",
      "next_thread_id": "K600PKZOO8"
    },
    "users": [{
      "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
      "type": "customer",
      "present": true,
      "created_at": "2019-12-17T08:53:20.693553+01:00",
      "statistics": {
        "chats_count": 1
      },
      "agent_last_event_created_at": "2019-12-17T09:04:05.239000+01:00"
    }, {
      "id": "smith@example.com",
      "name": "Agent Smith",
      "email": "smith@example.com",
      "type": "agent",
      "present": true,
      "avatar": "https://example.com/avatar.jpg"
    }],
    "properties": {
      "0805e283233042b37f460ed8fbf22160": {
        "string_property": "string_value"
      }
    },
    "access": {
      "group_ids": [0]
    },
    "is_followed": true
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### List Archives

It returns a list of the chats an Agent has access to. Together with a **chat**, the **events** of **one thread** from this chat are returned.

The list classification is based on threads; 1 chat per 1 thread. Thus, the same **chat** object may appear on the list several times, but each time with a different **thread**. The returned **chat** is a complete object, not only a **chat summary**.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `list_archives`                                   |
| **Required scopes**    | `chats--all:ro` `chats--access:ro` `chats--my:ro` |
| **Web API equivalent** | [`list_archives`](../#list-archives)              |
| **Push message**       | -                                                 |

#### Request

| Parameter                                             | Required | Data type | Notes                                                                                                                 |
| ----------------------------------------------------- | -------- | --------- | --------------------------------------------------------------------------------------------------------------------- |
| `filters`                                             | No       | `object`  |                                                                                                                       |
| `filters.query`                                       | No       | `string`  |                                                                                                                       |
| `filters.from`                                        | No       | `string`  | Date & time format with a resolution of microseconds, UTC string, `YYYY-MM-DDTHH:MM:SS.ssssssZHH:MM`                  |
| `filters.to`                                          | No       | `string`  | Date & time format with a resolution of microseconds, UTC string, `YYYY-MM-DDTHH:MM:SS.ssssssZHH:MM`                  |
| `filters.group_ids`                                   | No       | `array`   | Array of group IDs. Max array size: 200                                                                               |
| `filters.properties.<namespace>.<name>.<filter_type>` | No       | `any`     | **\* described below**                                                                                                |
| `filters.agents.<filter_type>`                        | No       | `any`     | `exists` see to `false` will return unassigned chats; `true` will return the assigned ones.                           |
| `filters.tags.<filter_type>`                          | No       | `any`     |                                                                                                                       |
| `filters.sales.<filter_type>`                         | No       | `any`     |                                                                                                                       |
| `filters.goals.<filter_type>`                         | No       | `any`     |                                                                                                                       |
| `filters.surveys.<survey>`                            | No       | `array`   | **\*\*** **described below**                                                                                          |
| `filters.events.types`                                | No       | `array`   | Array of [Event](#events) types. Duplicates are ignored.                                                              |
| `page_id`                                             | No       | `string`  |                                                                                                                       |
| `sort_order` **\*\*\***                               | No       | `string`  | Default: `desc`                                                                                                       |
| `limit`                                               | No       | `number`  | Default: 10, min: 1, max: 100                                                                                         |
| `highlights`                                          | No       | `object`  | Use it to highlight the match of `filters.query`. To enable highlights with default parameters, pass an empty object. |
| `highlights.pre_tag`                                  | No       | `string`  | An HTML tag to use for highlighting the matched text; default: `<em>`. Use it together with `highlights.post_tag`.    |
| `highlights.post_tag`                                 | No       | `string`  | An HTML tag to use for highlighting the matched text; default: `</em>`. Use it together with `highlights.pre_tag`.    |

**\*)**
`<filter_type>` can take the following values:

- `exists` (`bool`)
- `values` (`type[]` - an array with aspecific type for property: `string`, `int` or `bool`)
- `exclude_values` (`type[]` - array with specific type for property: `string`, `int` or `bool`)

There's only one value allowed for a single property.

**\*\*)**
`<survey>` contains the following fields:

- `type` (`string`) - allowed values: `pre_chat`, `post_chat`
- `answer_id` (`string`)

**\*\*\*)**
`sort_order` can take the following values:

- `asc` - the oldest chats first
- `desc` - the newest chats first

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "list_archives",
  "payload": {
    "filters": {
      "events": {
        "types": ["message", "filled_form"]
      }
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>",
  "action": "list_archives",
  "type": "response",
  "success": true,
  "payload": {
    "chats": [
      {
        "id": "PJ0MRSHTDG",
        "users": [
          {
            "id": "smith@example.com",
            "name": "Agent Smith",
            "email": "smith@example.com",
            "type": "agent",
            "present": true,
            "avatar": "https://cdn.livechatinc.com/cloud/?uri=avatar.jpg"
          }
        ],
        "thread": {
          "id": "K600PKZON8",
          "active": false,
          "user_ids": [
            "smith@example.com"
          ],
          "events": [
            {
              "id": "QBT14H0Y3Y_1",
              "created_at": "2020-05-28T11:45:32.269000Z",
              "recipients": "all",
              "type": "message",
              "properties": {
                "0805e283233042b37f460ed8fbf22160": {
                  "event_property": "property_value"
                }
              },
              "text": "Hello, how can I help you?",
              "author_id": "smith@example.com"
            }
          ],
          "properties": {
            "0805e283233042b37f460ed8fbf22160": {
              "thread_property": "property_value"
            }
          },
          "access": {
            "group_ids": [
              0
            ]
          },
          "created_at": "2020-05-28T11:44:58.829000Z"
        },
        "properties": {
          "0805e283233042b37f460ed8fbf22160": {
            "chat_property": "property_value"
          }
        },
        "access": {
          "group_ids": [
            0
          ]
        },
        "is_followed": false
      }
    ],
    "found_chats": 42,
    "next_page_id": "MTUxNzM5ODEzMTQ5Ng==",
    "previous_page_id": "MTUxNzM5ODEzMTQ5Ng=="
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Start Chat

Starts a chat.

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `start_chat`                                                                             |
| **Required scopes \*** | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`start_chat`](../#start-chat)                                                           |
| **Push message**       | [`incoming_chat`](#incoming_chat)                                                        |

**\*)**
When `chat.users` is defined, one of following scopes is required:

- `chats--all:rw`
- `chats--access:rw`
- `chats--my:rw`

#### Request

| Parameter                | Required | Data type  | Notes                                                                                                    |
| ------------------------ | -------- | ---------- | -------------------------------------------------------------------------------------------------------- |
| `chat`                   | No       | `object`   |                                                                                                          |
| `chat.properties`        | No       | `object`   |                                                                                                          |
| `chat.access`            | No       | `object`   |                                                                                                          |
| `chat.users`             | No       | `[]object` | The list of existing users. Up to 4 additional (other than the requester) agents and 1 customer allowed. |
| `chat.users.id`          | Yes      | `string`   | User ID                                                                                                  |
| `chat.users.type`        | Yes      | `string`   | `agent` or `customer`.                                                                                   |
| `chat.thread`            | No       | `object`   |                                                                                                          |
| `chat.thread.events`     | No       | `array`    | The list of initial chat events                                                                          |
| `chat.thread.properties` | No       | `object`   |                                                                                                          |
| `continuous`             | No       | `bool`     | Starts chat as continuous (online group is not required); default: `false`.                              |

#### Response

| Field       | Data type  | Notes                                                                                                                                                                   |
| ----------- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`   | `string`   |                                                                                                                                                                         |
| `thread_id` | `string`   |                                                                                                                                                                         |
| `event_ids` | `[]string` | Returned only when the chat was started with initial events. Returns only the IDs of user-generated events; server-side generated events are not included in the array. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "start_chat",
  "payload": {}
}
```

</CodeSample>

<!-- > **`start_chat`** sample **request** with optional params

```json
{
  "action": "start_chat",
  "payload": {
  "chat": {
    "properties": {
      "source": {
        "type": "facebook"
      },
      // ...
    },
    "users": [{
      "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
      "type": "customer"
    }],
    "thread": {
      "events": [{
        "type": "message",
        "custom_id": "31-0C-1C-07-DB-16",
        "text": "hello there",
        "recipients": "all"
      }, {
        "type": "system_message",
        "custom_id": "31-0C-1C-07-DB-16",
        "text": "hello there",
        "recipients": "agents"
      }],
      "properties": {
        "source": {
          "type": "facebook"
        },
        // ...
      },
      "tags": ["bug_report"]
    }
    "access": {
      "group_ids": [1]
    },
    "is_followed": true
  },
  "continuous": true
  },
  "author_id": "<author_id>" // optional, applies only to bots
}
``` -->

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "start_chat",
  "type": "response",
  "success": true,
  "payload": {
    "chat_id": "PJ0MRSHTDG",
    "thread_id": "PGDGHT5G"
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Activate Chat

Restarts an archived chat.

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `activate_chat`                                                                          |
| **Required scopes \*** | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`activate_chat`](../#activate-chat)                                                     |
| **Push message**       | [`incoming_chat`](#incoming_chat)                                                        |

**\*)**
When `chat.users` is defined, one of following scopes is required:

- `chats--all:rw`
- `chats--access:rw`
- `chats--my:rw`

#### Request

| Parameter                | Required | Type       | Notes                                                                                                    |
| ------------------------ | -------- | ---------- | -------------------------------------------------------------------------------------------------------- |
| `chat`                   | Yes      | `object`   |                                                                                                          |
| `chat.id`                | Yes      | `string`   | The ID of the chat that will be activated.                                                               |
| `chat.access`            | No       | `object`   | Chat access to set, default: all agents.                                                                 |
| `chat.properties`        | No       | `object`   | Initial chat properties                                                                                  |
| `chat.users`             | No       | `[]object` | The list of existing users. Up to 4 additional (other than the requester) agents and 1 customer allowed. |
| `chat.users.id`          | Yes      | `string`   | User ID                                                                                                  |
| `chat.users.type`        | Yes      | `string`   | `agent` or `customer`                                                                                    |
| `chat.thread`            | No       | `object`   |                                                                                                          |
| `chat.thread.events`     | No       | `array`    | Initial chat events array                                                                                |
| `chat.thread.properties` | No       | `object`   | Initial thread properties                                                                                |
| `continuous`             | No       | `bool`     | Sets a chat to the continuous mode. When unset, leaves the mode unchanged.                               |

#### Response

| Field       | Data type  | Notes                                                                                                                                                                     |
| ----------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `thread_id` | `string`   |                                                                                                                                                                           |
| `event_ids` | `[]string` | Returned only when the chat was activated with initial events. Returns only the IDs of user-generated events; server-side generated events are not included in the array. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "activate_chat",
  "payload": {
  "chat": {
    "id": "PWJ8Y4THAV"
  }
  }
}
```

</CodeSample>

<!-- > **`activate_chat`** sample **request** with optional params

```json
{
  "request_id": "7676",
  "action": "activate_chat",
  "payload": {
  "chat": {
    "id": "PJ0MRSHTDG",
    "access": {
      "group_ids": [1]
    },
    "properties": {
      "source": {
        "type": "facebook"
      }
    },
    "thread": {
      "events": [{
        "type": "message",
        "custom_id": "31-0C-1C-07-DB-16",
        "text": "hello there"
      }, {
        "type": "system_message",
        "custom_id": "31-0C-1C-07-DB-16",
        "text": "hello there"
      }],
      "properties": {
        "source": {
          "type": "facebook"
        },
        // ...
      },
      "tags": ["bug_report"]
      }
    }
  },
  "author_id": "<author_id>" // optional, applies only to bots
}
``` -->

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "<action>",
  "type": "response",
  "success": true,
  "payload": {
  "thread_id": "Z8AGR5OUW"
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Deactivate Chat

Deactivates a chat by closing the currently open thread. Sending messages to this thread will no longer be possible.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `deactivate_chat`                                 |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw` |
| **Web API equivalent** | [`deactivate_chat`](../#deactivate-chat)          |
| **Push message**       | [`chat_deactivated`](#chat_deactivated)           |

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `chat_id` | Yes      | `string`  |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "deactivate_chat",
  "payload": {
  "chat_id": "PJ0MRSHTDG"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "deactivate_chat",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Follow Chat

Marks a chat as followed. All changes to the chat will be sent to the requester until the chat is reactivated or unfollowed. Chat members don't need to follow their chats. They receive all chat pushes regardless of their follower status.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `follow_chat`                                     |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw` |
| **Web API equivalent** | [`follow_chat`](../#follow-chat)                  |
| **Push message**       | [`incoming_chat`](#incoming_chat)**\***           |

**\*)**
It won't be sent when the requester already follows the chat or is the chat member.

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `chat_id` | Yes      | `string`  |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "follow_chat",
  "payload": {
  "chat_id": "PW94SJTGW6"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "follow_chat",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Unfollow Chat

Removes the requester from the chat followers. After that, only key changes to the chat (like `transfer_chat` or `close_active_thread`) will be sent to the requester. Chat members cannot unfollow the chat.

#### Specifics

|                        |                                       |
| ---------------------- | ------------------------------------- |
| **Action**             | `unfollow_chat`                       |
| **Required scopes**    | -                                     |
| **Web API equivalent** | [`unfollow_chat`](../#unfollow-chat)  |
| **Push message**       | [`chat_unfollowed`](#chat_unfollowed) |

#### Request

| Parameter | Required | Data type |     |
| --------- | -------- | --------- | --- |
| `chat_id` | Yes      | `string`  |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "unfollow_chat",
  "payload": {
  "chat_id": "PWF6BACIKO"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "unfollow_chat",
  "type": "response",
  "success": true,
  "payload": {
  "chat_id": "PWF6BACIKO"
  }
}
```

</CodeResponse>
</Code>
</Section>

## Chat access

<Section>
<Text>

### Grant Chat Access

Grants access to a new chat without overwriting the existing ones.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `grant_chat_access`                               |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw` |
| **Web API equivalent** | [`grant_chat_access`](../#grant-chat-access)      |
| **Push message**       | [`chat_access_granted`](#chat_access_granted)     |

#### Request

| Parameter     | Required | Data ype | Notes   |
| ------------- | -------- | -------- | ------- |
| `id`          | Yes      | `string` | Chat Id |
| `access`      | Yes      | `object` |         |
| `access.type` | Yes      | `string` | `group` |
| `access.id`   | Yes      | any      |         |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "grant_chat_access",
  "payload": {
  "id": "PW94SJTGW6",
  "access": {
    "type": "group",
    "id": 19
  }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "grant_chat_access",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Revoke Chat Access

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `revoke_chat_access`                              |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw` |
| **Web API equivalent** | [`revoke_chat_access`](../#revoke-chat-access)    |
| **Push message**       | [`chat_access_revoked`](#chat_access_revoked)     |

#### Request

| Parameter     | Required | Data type | Notes              |
| ------------- | -------- | --------- | ------------------ |
| `id`          | Yes      | `string`  | Chat Id            |
| `access`      | Yes      | `object`  |                    |
| `access.type` | Yes      | `string`  | `group` or `agent` |
| `access.id`   | Yes      | `number`  |                    |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "revoke_chat_access",
  "payload": {
  "id": "PW94SJTGW6",
  "access": {
    "type": "group",
    "id": 19
  }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "revoke_chat_access",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Transfer Chat

Transfers a chat to an Agent or a group.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `transfer_chat`                                   |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw` |
| **Web API equivalent** | [`transfer_chat`](../#transfer-chat)              |
| **Push message**       | [`chat_transferred`](#chat_transferred)           |

#### Request

| Parameter     | Required | Data ype | Notes                                                                                                                           |
| ------------- | -------- | -------- | ------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`     | Yes      | `string` | Chat Id                                                                                                                         |
| `target`      | No       | `object` | If missing, the chat will be transferred within the current group.                                                              |
| `target.type` | Yes      | `string` | `group` or `agent`                                                                                                              |
| `target.ids`  | Yes      | `array`  | `group` or `agent` IDs array                                                                                                    |
| `force`       | No       | `bool`   | If `true`, always transfers chats. Otherwise, fails when unable to assign any Agent from the requested groups; default `false`. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "transfer_chat",
  "payload": {
  "chat_id": "PWF6BACIKO",
  "target": {
    "type": "group",
    "ids": [19]
  }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "transfer_chat",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Chat users

### Add User to Chat

Adds a user to the chat. You can't add more than one `customer` user type to the chat.

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `add_user_to_chat`                                |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw` |
| **Web API equivalent** | [`add_user_to_chat`](../#add-user-to-chat)        |
| **Push message**       | [`user_added_to_chat`](#user_added_to_chat)       |

#### Request

| Parameter               | Required | Type     | Notes                                                                                        |
| ----------------------- | -------- | -------- | -------------------------------------------------------------------------------------------- |
| `chat_id`               | Yes      | `string` |                                                                                              |
| `user_id`               | Yes      | `string` |                                                                                              |
| `user_type`             | Yes      | `string` | Possible values: `agent` or `customer`                                                       |
| `require_active_thread` | No       | `bool`   | If `true`, it adds a user to a chat only if that chat has an active thread; default `false`. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "add_user_to_chat",
  "payload": {
  "chat_id": "PW94SJTGW6",
  "user_id": "smith@example.com",
  "user_type": "agent",
  "require_active_thread": "true"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "add_user_to_chat",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Remove User from Chat

Removes a user from chat. Removing `customer` user type is not allowed. It's always possible to remove the requester from chat.

#### Specifics

|                        |                                                      |
| ---------------------- | ---------------------------------------------------- |
| **Action**             | `remove_user_from_chat`                              |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw`    |
| **Web API equivalent** | [`remove_user_from_chat`](../#remove-user-from-chat) |
| **Push message**       | [`user_removed_from_chat`](#user_removed_from_chat)  |

#### Request

| Parameter   | Required | Type     | Notes                                     |
| ----------- | -------- | -------- | ----------------------------------------- |
| `chat_id`   | Yes      | `string` |                                           |
| `user_id`   | Yes      | `string` |                                           |
| `user_type` | Yes      | `string` | Possible values are `agent` or `customer` |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "remove_user_from_chat",
  "payload": {
  "chat_id": "PW94SJTGW6",
  "user_id": "smith@example.com",
  "user_type": "agent"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "remove_user_from_chat",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Events

### Send Event

Sends an [Event](#events) object. Use this method to send a message by specifying the [Message](#message) event type in the request.

It's possible to write to a chat without joining it. The user sending an event will be automatically added to the chat with the `present` parameter set to `false` (see [`user_added_to_chat`](#user_added_to_chat)). **Sample use case:** a Bot Agent that sends messages visible to all chat participants without actually joining the chat.

The method updates the requester's `events_seen_up_to` as if they've seen all chat events.

To call the API as a bot, use the `author_id` property set to the bot's id in the payload.

#### Specifics

|                        |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `send_event`                                                                             |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`send_event`](../#send-event)                                                           |
| **Push message**       | [`incoming_event`](#incoming_event)                                                      |

#### Request

| Parameter               | Required | Data type | Notes                                                                                                                                                             |
| ----------------------- | -------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`               | Yes      | `string`  | Id of the chat you want to send the message to.                                                                                                                   |
| `event`                 | Yes      | `object`  | Event object                                                                                                                                                      |
| `attach_to_last_thread` | No       | `bool`    | The flag is ignored for active chats. For inactive chats: `true` – the event will be added to the last thread; `false` – the request will fail. Default: `false`. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "send_event",
  "payload": {
  "chat_id": "PW94SJTGW6",
  "event": {
    "type": "message",
    "text": "hello world",
    "recipients": "all"
  }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "send_event",
  "type": "response",
  "success": true,
  "payload": {
    "event_id": "K600PKZON8"
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Send Rich Message Postback

#### Specifics

|                        |                                                                           |
| ---------------------- | ------------------------------------------------------------------------- |
| **Action**             | `send_rich_message_postback`                                              |
| **Required scopes**    | `chats.conversation--my:rw` `chats.conversation--all:rw`                  |
| **Web API equivalent** | [`send_rich_message_postback`](../#send-rich-message-postback)            |
| **Push message**       | [`incoming_rich_message_postback`](#incoming_rich_message_postback)**\*** |

**\*)** `incoming_rich_message_postback` will be sent only for active threads.

#### Request

| Parameter          | Required | Data type | Notes                               |
| ------------------ | -------- | --------- | ----------------------------------- |
| `chat_id`          | Yes      | `string`  |                                     |
| `event_id`         | Yes      | `string`  |                                     |
| `postback`         | Yes      | `object`  |                                     |
| `postback.id`      | Yes      | `string`  | Postback name of the button         |
| `postback.toggled` | Yes      | `bool`    | Postback toggled; `true` or `false` |
| `thread_id`        | Yes      | `string`  |                                     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "send_rich_message_postback",
  "payload": {
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "event_id": "a0c22fdd-fb71-40b5-bfc6-a8a0bc3117f7",
  "postback": {
    "id": "Method URL_yes",
    "toggled": true
  }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "send_rich_message_postback",
  "type": "response",
  "success": true,
  "payload": {
  //no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Properties

### Update Chat Properties

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `update_chat_properties`                                                                 |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`update_chat_properties`](../#update-chat-properties)                                   |
| **Push message**       | [`chat_properties_updated`](#chat_properties_updated)                                    |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                        |
| ------------ | -------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you to set a property for.                                                                                                                                    |
| `properties` | Yes      | `object`  | Chat properties to set. You should stick to the [general properties format](/management/configuration-api/#properties) and include _namespace_, _property name_ and _value_. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "update_chat_properties",
  "payload": {
  "chat_id": "Q1VZR7AJCE",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": {
      "string_property": "Chat property value updated by Agent"
      }
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "update_chat_properties",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Delete Chat Properties

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `delete_chat_properties`                                                                 |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`delete_chat_properties`](../#delete-chat-properties)                                   |
| **Push message**       | [`chat_properties_deleted`](#chat_properties_deleted)                                    |

#### Request

| Parameter    | Required | Data type | Notes                                           |
| ------------ | -------- | --------- | ----------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete property for. |
| `properties` | Yes      | `object`  | Chat properties to delete.                      |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "delete_chat_properties",
  "payload": {
  "chat_id": "Q1VZR7AJCE",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": [
      "string_property"
      ]
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "delete_chat_properties",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Update Thread Properties

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `update_thread_properties`                                                               |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`update_thread_properties`](../#update-thread-properties)                               |
| **Push message**       | [`thread_properties_updated`](#thread_properties_updated)                                |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                        |
| ------------ | -------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to set properties for.                                                                                                                               |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to set properties for.                                                                                                                             |
| `properties` | Yes      | `object`  | Chat properties to set. You should stick to the [general properties format](/management/configuration-api/#properties) and include _namespace_, _property name_ and _value_. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "update_thread_properties",
  "payload": {
  "chat_id": "Q1WZ073OA7",
  "thread_id": "Q1WZ073OB7",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": {
      "string_property": "Chat thread property value updated by Agent"
      }
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "update_thread_properties",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Delete Thread Properties

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `delete_thread_properties`                                                               |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`delete_thread_properties`](../#delete-thread-properties)                               |
| **Push message**       | [`thread_properties_deleted`](#thread_properties_deleted)                                |

#### Request

| Parameter    | Required | Data type | Notes                                             |
| ------------ | -------- | --------- | ------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete property for.   |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to delete property for. |
| `properties` | Yes      | `object`  | Chat properties to delete.                        |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "delete_thread_properties",
  "payload": {
   "chat_id": "Q1WZ073OA7",
   "thread_id": "Q1WZ073OB7",
   "properties": {
    "0805e283233042b37f460ed8fbf22160": [
      "string_property"
      ]
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "delete_thread_properties",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Update Event Properties

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `update_event_properties`                                                                |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`update_event_properties`](../#update-event-properties)                                 |
| **Push message**       | [`event_properties_updated`](#event_properties_updated)                                  |

#### Request

| Parameter    | Required | Data type | Notes                                            |
| ------------ | -------- | --------- | ------------------------------------------------ |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to set properties for.   |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to set properties for. |
| `event_id`   | Yes      | `string`  | Id of the event you want to set properties for.  |
| `properties` | Yes      | `object`  | Chat properties to set.                          |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "update_event_properties",
  "payload": {
  "chat_id": "Q1GZ3FNAT9",
  "thread_id": "Q1GZ3FNAU9",
  "event_id": "Q1GZ3FNAU9_1",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": {
      "string_property": "Event property value updated by Agent"
      }
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "update_event_properties",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Delete Event Properties

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `delete_event_properties`                                                                |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`delete_event_properties`](../#delete-event-properties)                                 |
| **Push message**       | [`event_properties_deleted`](#event_properties_deleted)                                  |

#### Request

| Parameter    | Required | Data type | Notes                                                                                                                                                                            |
| ------------ | -------- | --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to delete the properties of.                                                                                                                             |
| `thread_id`  | Yes      | `string`  | Id of the thread you want to delete the properties of.                                                                                                                           |
| `event_id`   | Yes      | `string`  | Id of the event you want to delete the properties of.                                                                                                                            |
| `properties` | Yes      | `object`  | Event properties to delete. You should stick to the [general properties format](/management/configuration-api/#properties) and include _namespace_, _property name_ and _value_. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "delete_event_properties",
  "payload": {
  "chat_id": "Q16ZSBGX3J",
  "thread_id": "Q16ZSBGX4J",
  "event_id": "Q16ZSBGX4J_1",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": [
      "string_property"
      ]
    }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "delete_event_properties",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Thread tags

### Tag Thread

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `tag_thread`                                      |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw` |
| **Web API equivalent** | [`tag_thread`](../#tag-thread)                    |
| **Push message**       | [`thread_tagged`](#thread_tagged)                 |

#### Request

| Parameter   | Required | Data type | Notes                                      |
| ----------- | -------- | --------- | ------------------------------------------ |
| `chat_id`   | Yes      | `string`  | Id of the chat you want to add a tag to.   |
| `thread_id` | Yes      | `string`  | Id of the thread you want to add a tag to. |
| `tag`       | Yes      | `string`  | Tag name                                   |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "tag_thread",
  "payload": {
  "chat_id": "PW94SJTGW6",
  "thread_id": "PWS6GIKAKH",
  "tag": "support"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "tag_thread",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Untag Thread

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `untag_thread`                                    |
| **Required scopes**    | `chats--all:rw` `chats--access:rw` `chats--my:rw` |
| **Web API equivalent** | [`untag_thread`](../#untag-thread)                |
| **Push message**       | [`thread_untagged`](#thread_untagged)             |

#### Request

| Parameter   | Required | Data type | Notes                                           |
| ----------- | -------- | --------- | ----------------------------------------------- |
| `chat_id`   | Yes      | `string`  | Id of the chat you want to remove a tag from.   |
| `thread_id` | Yes      | `string`  | Id of the thread you want to remove a tag from. |
| `tag`       | Yes      | `string`  | Tag name                                        |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "untag_thread",
  "payload": {
  "chat_id": "PW94SJTGW6",
  "thread_id": "PWS6GIKAKH",
  "tag": "support"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "untag_thread",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

## Customers

<Section>
<Text>

### Get Customer

Returns the info about the Customer with a given `customer_id`.

#### Specifics

|                        |                                    |
| ---------------------- | ---------------------------------- |
| **Action**             | `get_customer`                     |
| **Required scopes**    | `customers:ro`                     |
| **Web API equivalent** | [`get_customer`](../#get-customer) |
| **Push message**       | -                                  |

#### Request

| Parameter     | Required | Data type | Notes |
| ------------- | -------- | --------- | ----- |
| `customer_id` | Yes      | string    |       |

#### Response

| Field            | Data type | Notes                                                                                                                             |
| ---------------- | --------- | --------------------------------------------------------------------------------------------------------------------------------- |
| `id`             | string    | [Customer's](#customer) ID.                                                                                                       |
| `type`           | string    | `customer`                                                                                                                        |
| `name`           | string    | Customer's name. Returned only if set.                                                                                            |
| `email`          | string    | Customer's email. Returned only if set.                                                                                           |
| `avatar`         | string    | Customer's avatar. Returned only if set.                                                                                          |
| `created_at`     | string    | Specifies when the customer's identity was created.                                                                               |
| `session_fields` | []object  | An array of custom object-enclosed `key:value` pairs. Returned only if set. Available for the session duration.                   |
| `statistics`     | object    | Counters for started threads, opened pages, etc.                                                                                  |
| `last_visit`     | object    | Geolocation and opened pages from the customer's most recent online visit. Returned only if the customer logged in at least once. |
| `chat_ids`       | []string  | IDs of a customer's chats. Returned only if the customer had at least one chat.                                                   |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "get_customer",
  "payload": {
  "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
  }
}
```

</CodeSample>
<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "get_customer",
  "type": "response",
  "success": true,
  "payload": {
    "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
    "type": "customer",
    "created_at": "2017-10-11T15:19:21.010200Z",
    "name": "Thomas Anderson",
    "email": "t.anderson@example.com",
    "avatar": "example.com/avatars/1.jpg",
    "session_fields": [{
      "custom_key": "custom_value"
    }, {
      "another_custom_key": "another_custom_value"
    }],
    "last_visit": {
      "started_at": "2017-10-12T15:19:21.010200Z",
      "referrer": "http://www.google.com/",
      "ip": "<customer_ip>",
      "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36",
      "geolocation": {
        "latitude": "-14.6973803",
        "longitude": "-75.1266898",
        "country": "Poland",
        "country_code": "PL",
        "region": "Dolnoslaskie",
        "city": "Wroclaw",
        "timezone": "Europe/Warsaw"
      },
      "last_pages": [{
        "opened_at": "2017-10-12T15:19:21.010200Z",
        "url": "https://www.livechat.com/",
        "title": "LiveChat - Homepage"
      }, {
        "opened_at": "2017-10-12T15:19:21.010200Z",
        "url": "https://www.livechat.com/tour",
        "title": "LiveChat - Tour"
      }]
    },
    "statistics": {
      "chats_count": 3,
      "threads_count": 9,
      "visits_count": 5,
      "page_views_count": 1337,
      "greetings_shown_count": 69,
      "greetings_accepted_count": 42
    },
    "__priv_lc2_customer_id": "test_771305.dafea66e5c", // old customer_id
    "agent_last_event_created_at": "2017-10-12T15:19:21.010200Z",
    "customer_last_event_created_at": "2017-10-12T15:19:21.010200Z",
    "chat_ids": [
      "PWJ8Y4THAV"
    ]
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### List Customers

It returns the list of Customers.

#### Specifics

|                        |                                        |
| ---------------------- | -------------------------------------- |
| **Action**             | `list_customers`                       |
| **Required scopes**    | `customers:ro`                         |
| **Web API equivalent** | [`list_customers`](../#list-customers) |
| **Push message**       | -                                      |

#### Request

All parameters are optional.

| Parameter                                                                      | Data type | Notes                     |
| ------------------------------------------------------------------------------ | --------- | ------------------------- |
| `page_id`                                                                      | `string`  |                           |
| `limit`                                                                        | `number`  | Default: 10, maximum: 100 |
| `sort_order` **\***                                                            | `string`  | Default: `desc`           |
| `filters`                                                                      | `object`  |                           |
| `filters.country.<string_filter_type>` **\*\***                                | `object`  |                           |
| `filters.email.<string_filter_type>` **\*\***                                  | `object`  |                           |
| `filters.name.<string_filter_type>` **\*\***                                   | `object`  |                           |
| `filters.customer_id.<string_filter_type>` **\*\***                            | `object`  |                           |
| `filters.chats_count.<range_filter_type>` **\*\*\***                           | `object`  |                           |
| `filters.threads_count.<range_filter_type>` **\*\*\***                         | `object`  |                           |
| `filters.visits_count.<range_filter_type>` **\*\*\***                          | `object`  |                           |
| `filters.created_at.<date_range_filter_type>`**\*\*\*\***                      | `object`  |                           |
| `filters.agent_last_event_created_at.<date_range_filter_type>` **\*\*\*\***    | `object`  |                           |
| `filters.customer_last_event_created_at.<date_range_filter_type>` **\*\*\*\*** | `object`  |                           |

**\*)**

`sort_order` can take the following values:

- `asc` - oldest customers first
- `desc` - newest customers first

**\*\*)**

`<string_filter_type>` can take the following values :

- `values` (`string[]` - an array of strings)
- `exclude_values` (`string[]` - an array of strings)

There's only one value allowed for a single filter.

**\*\*\*)**

`<range_filter_type>` can take the following values:

- `lte` (`int` - less than or equal to given value)
- `lt` (`int` - less than given value)
- `gte` (`int` - greater than or equal to given value)
- `gt` (`int` - greater than given value)
- `eq` (`int` - equal to given value)

**\*\*\*\*)**

`<date_range_filter_type>` can take the following values:

- `lte` ( `string` - less than or equal to given value)
- `lt` (`string` - less than given value)
- `gte` (`string` - greater than or equal to given value)
- `gt` (`string` - greater than given value)
- `eq` (`string` - equal to given value)

Dates are represented in ISO 8601 format with microseconds resolution, e.g. `2017-10-12T15:19:21.010200+01:00` in specific timezone or `2017-10-12T14:19:21.010200Z` in UTC.

#### Response

| Field              | Data type | Notes                                              |
| ------------------ | --------- | -------------------------------------------------- |
| `next_page_id`     | `string`  | In relation to `page_id` specified in the request. |
| `previous_page_id` | `string`  | In relation to `page_id` specified in the request. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "list_customers",
  "payload": {}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "list_customers",
  "type": "response",
  "success": true,
  "payload": {
  "customers": [
    // an array of "User > Customer" objects
  ],
  "total_customers": 2340,
  "next_page_id": "MTUxNzM5ODEzMTQ5Ng==", // optional
  "previous_page_id": "MTUxNzM5ODEzMTQ5Ng==" // optional
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Create Customer

Creates a new [Customer](#customer) user type.

#### Specifics

|                        |                                          |
| ---------------------- | ---------------------------------------- |
| **Action**             | `create_customer`                        |
| **Required scopes**    | `customers:rw`                           |
| **Web API equivalent** | [`create_customer`](../#create-customer) |
| **Push message**       | [`customer_created`](#customer_created)  |

#### Request

| Parameter        | Required | Data type  | Notes                                                                              |
| ---------------- | -------- | ---------- | ---------------------------------------------------------------------------------- |
| `name`           | No       | `string`   |                                                                                    |
| `email`          | No       | `string`   |                                                                                    |
| `avatar`         | No       | `string`   | URL of the Customer's avatar                                                       |
| `session_fields` | No       | `[]object` | An array of custom object-enclosed `key:value` pairs. Respects the order of items. |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "create_customer",
  "payload": {
  "name": "Thomas Anderson",
  "email": "t.anderson@example.com",
  "avatar": "example.com/avatars/1.png",
  "session_fields": [{
    "custom_key": "custom_value"
  }, {
    "another_custom_key": "another_custom_value"
  }]
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "create_customer",
  "type": "response",
  "success": true,
  "payload": {
   "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Update Customer

Updates Customer's properties.

#### Specifics

|                        |                                          |
| ---------------------- | ---------------------------------------- |
| **Action**             | `update_customer`                        |
| **Required scopes**    | `customers:rw`                           |
| **Web API equivalent** | [`update_customer`](../#update-customer) |
| **Push message**       | [`customer_updated`](#customer_updated)  |

#### Request

| Parameter        | Required | Data type  | Notes                                                                              |
| ---------------- | -------- | ---------- | ---------------------------------------------------------------------------------- |
| `customer_id`    | Yes      | `string`   | UUID v4 format is required.                                                        |
| `name`           | No       | `string`   |                                                                                    |
| `email`          | No       | `string`   |                                                                                    |
| `avatar`         | No       | `string`   | URL of the Customer's avatar                                                       |
| `session_fields` | No       | `[]object` | An array of custom object-enclosed `key:value` pairs. Respects the order of items. |

Apart from `customer_id`, which is a required parameter, you also need to include **one of the optional** parameters.

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "update_customer",
  "payload": {
  "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "name": "Thomas Anderson",
  "email": "t.anderson@example.com",
  "avatar": "example.com/avatars/1.png",
  "session_fields": [{
    "custom_key": "custom_value"
  }, {
    "another_custom_key": "another_custom_value"
  }]
  }
}
```

</CodeSample>
<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "update_customer",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Ban Customer

Bans the customer for a specific period of time. It immediately disconnects all active sessions of this customer and does not accept new ones during the ban lifespan.

#### Specifics

|                        |                                       |
| ---------------------- | ------------------------------------- |
| **Action**             | `ban_customer`                        |
| **Required scopes**    | `customers.ban:rw`                    |
| **Web API equivalent** | [`ban_customer`](../#ban-customer)    |
| **Push message**       | [`customer_banned`](#customer_banned) |

#### Request

| Parameter     | Required | Data type |     |
| ------------- | -------- | --------- | --- |
| `customer_id` | Yes      | `string`  |     |
| `ban`         | Yes      | `object`  |     |
| `ban.days`    | Yes      | `number`  |     |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "ban_customer",
  "payload": {
  "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "ban": {
    "days": 3
  }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "ban_customer",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

## Status

### Login

It returns the initial state of the current Agent.

#### Specifics

|                        |                                                                                        |
| ---------------------- | -------------------------------------------------------------------------------------- |
| **Action**             | `login`                                                                                |
| **Required scopes**    | `chats--access:ro` `customers:ro` `multicast:ro` `agents--all:ro` `agents-bot--all:ro` |
| **Web API equivalent** | -                                                                                      |
| **Push message**       | -                                                                                      |

#### Request

| Parameter                           | Required | Data type | Notes                                                                                                                            |
| ----------------------------------- | -------- | --------- | -------------------------------------------------------------------------------------------------------------------------------- |
| `token`                             | Yes      | `string`  | OAuth token from the Agent's account                                                                                             |
| `timezone`                          | No       | `string`  |                                                                                                                                  |
| `reconnect`                         | No       | `bool`    | Reconnecting sets the status to the last known state instead of the default one.                                                 |
| `push_notifications`                | No       | `object`  |                                                                                                                                  |
| `push_notifications.firebase_token` | No       | `string`  | Firebase device token to allow connecting this instance with the existing push notification instance (to be seen as 1 instance). |
| `push_notifications.platform`       | Yes      | `string`  | OS platform; possible values:`ios`, `android`. Required only when `push_notifications` is included.                              |
| `application`                       | No       | `object`  |                                                                                                                                  |
| `application.name`                  | No       | `string`  | Application name                                                                                                                 |
| `application.version`               | No       | `string`  | Application version                                                                                                              |
| `away` __*__                        | No       | `bool`    | When `true`, the connection is set to the `away` state. Defaults to `false`.                                                     |

__*__ You can use the `away` param to **prevent assigning chats** to Agents **after random reconnections** when their status was set to `not_accepting_chats` by the auto-away feature. When an Agent logs in with `away: true`, the connection is immediately recognized
as `away`. [Read more...](#set-away-status)

#### Response

| Field        | Data type | Notes |
| ------------ | --------- | ----- |
| `access`     | `object`  |       |
| `properties` | `object`  |       |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "login",
  "payload": {
    "token": "Bearer dal:test_1fgTbfXmgthj4cZSA"
    }
  }
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "login",
  "type": "response",
  "success": true,
  "payload": {
  "license": {
    "id": "104130623",
    "plan": "enterprise",
    "expiration_timestamp": 1483433500,
    "creation_timestamp": 1482433500,
    "in_trial": true,
    "website_last_activity": "2018-01-05" // optional
  },
  "my_profile": {
    // "User > My profile" object
  },
  "chats_summary": [{
    "id": "PJ0MRSHTDG",
    "users": [
    // array of "User" objects
    ],
    "last_event_per_type": {
    // the last event of each type in chat
    "message": {
      "thread_id": "K600PKZON8",
      "thread_created_at": "2020-05-07T07:11:28.288340Z",
      "event": {
      // "restricted_access": "User has no access to following resource"
      // or
      // Event > Message object
      }
    },
    "system_message": {
      "thread_id": "K600PKZON8",
      "thread_created_at": "2020-05-07T07:11:28.288340Z",
      "event": {
      // "restricted_access": "User has no access to following resource"
      // or
      // Event > System Message object
      }
    }
    // ...
    },
    "last_thread_summary": {
    "id": "K600PKZON8",
    "user_ids": ["smith@example.com"],
    "properties": {
      "routing": {
      "idle": false,
      "unassigned": false
      }
      // ...
    },
    "created_at": "2020-05-07T07:11:28.288340Z"
    },
    "properties": {
    "routing": {
      "idle": false,
      "unassigned": false
    }
    // ...
    },
    "access": {
    // "Access" object
    }
  }]
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Set Away Status

Sets an Agent's connection to the `away` state. You can use this method to manipulate the Agent's status. The method works per connection - all connections an Agent has (desktop, mobile, etc) must be in the `away` state for the Agent's status to be changed to `not_accepting_chats`.

You may want to make use of the <a href="https://www.livechat.com/help/setting-up-auto-away/" target="_blank">auto-away feature</a> and set the Agents' statuses to `not_accepting_chats` when they're inactive, for example they're not at their desks.
Remember that checking if Agents are active/inactive should be **implemented on your side**. If you decide they're inactive, set their connections to `away`. The auto-away feature will recognize the `away` connections and change the Agent's status to `not_accepting_chats`.

#### Specifics

|                        |                   |
| ---------------------- | ----------------- |
| **Action**             | `set_away_status` |
| **Required scopes**    | `agents--my:rw`   |
| **Web API equivalent** | -                 |
| **Push message**       | -                 |

#### Request

| Parameter | Required | Data type |
| --------- | -------- | --------- |
| `away`    | Yes      | `bool`    |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "set_away_status",
  "payload": {
  "away": true
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "set_away_status",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Change Push Notifications

Change the firebase push notifications properties.

#### Specifics

|                        |                             |
| ---------------------- | --------------------------- |
| **Action**             | `change_push_notifications` |
| **Required scopes**    | -                           |
| **Web API equivalent** | -                           |
| **Push message**       | -                           |

#### Request

| Parameter        | Required | Data type | Notes                                                        |
| ---------------- | -------- | --------- | ------------------------------------------------------------ |
| `firebase_token` | Yes      | string    | Firebase device token                                        |
| `platform`       | Yes      | string    | OS platform; possible values: `ios`, `android`               |
| `enabled`        | Yes      | bool      | Enable or disable push notifications for the requested token |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "change_push_notifications",
  "payload": {
  "firebase_token": "8daDAD9dada8ja1JADA11",
  "platform": "ios",
  "enabled": true
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "change_push_notifications",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Set Routing Status

Changes the status of an Agent or a Bot Agent. It sets the status for the session duration. Once the session ends, the status gets back to what's in the Agent's settings.
Unlike [**Set Away Status**](#set-away-status), which is another mechanism of status manipulation, **Set Routing Status** is independent of the number of connections (desktop, mobile, etc).

#### Specifics

|                        |                                                                                                        |
| ---------------------- | ------------------------------------------------------------------------------------------------------ |
| **Action**             | `set_routing_status`                                                                                   |
| **Required scopes**    | for Agents: `agents--my:rw` `agents--all:rw`; for Bot Agents: `agents-bot--my:rw` `agents-bot--all:rw` |
| **Web API equivalent** | [`set_routing_status`](../#set-routing-status)                                                         |
| **Push message**       | [`routing_status_set`](#routing_status_set)                                                            |

#### Request

| Parameter  | Required | Data type | Notes                                                                                                                          |
| ---------- | -------- | --------- | ------------------------------------------------------------------------------------------------------------------------------ |
| `status`   | Yes      | `string`  | For Agents: `accepting_chats` or `not_accepting_chats`; for Bot Agents: `accepting_chats`, `not_accepting_chats`, or `offline` |
| `agent_id` | No       | `string`  | If not specified, the requester's status will be updated.                                                                      |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "set_routing_status",
  "payload": {
  "status": "accepting_chats",
  "agent_id": "smith@example.com"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "set_routing_status",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Logout

Logs the Agent out.

#### Specifics

|                        |          |
| ---------------------- | -------- |
| **Action**             | `logout` |
| **Required scopes**    | -        |
| **Web API equivalent** | -        |
| **Push message**       | -        |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "logout",
  "payload": {}
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "logout",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

## Other

<Section>
<Text>

### Mark Events as Seen

#### Specifics

|                        |                                                   |
| ---------------------- | ------------------------------------------------- |
| **Action**             | `mark_events_as_seen`                             |
| **Required scopes**    | `chats--access:ro` `chats--all:ro`                |
| **Web API equivalent** | [`mark_events_as_seen`](../#mark-events-as-seen)  |
| **Push message**       | [`events_marked_as_seen`](#events_marked_as_seen) |

#### Request

| Parameter    | Required | Data type | Notes                     |
| ------------ | -------- | --------- | ------------------------- |
| `chat_id`    | Yes      | `string`  |                           |
| `seen_up_to` | Yes      | `string`  | RFC 3339 date-time format |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "mark_events_as_seen",
  "payload": {
  "chat_id": "PJ0MRSHTDG",
  "seen_up_to": "2017-10-12T15:19:21.010200Z"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>",
  "action": "mark_events_as_seen",
  "type": "response",
  "success": true,
  "payload": {
  }
}
```

</CodeResponse>

</Code>
</Section>

<Section>
<Text>

### Send Typing Indicator

#### Specifics

|                        |                                                                                          |
| ---------------------- | ---------------------------------------------------------------------------------------- |
| **Action**             | `send_typing_indicator`                                                                  |
| **Required scopes**    | `chats.conversation--all:rw` `chats.conversation--access:rw` `chats.conversation--my:rw` |
| **Web API equivalent** | [`send_typing_indicator`](../#send-typing-indicator)                                     |
| **Push message**       | -                                                                                        |

#### Request

| Parameter    | Required | Data type | Notes                                                    |
| ------------ | -------- | --------- | -------------------------------------------------------- |
| `chat_id`    | Yes      | `string`  | Id of the chat you want to send the typing indicator to. |
| `recipients` | No       | `string`  | `all` (default), `agents`                                |
| `is_typing`  | Yes      | `bool`    |                                                          |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "send_typing_indicator",
  "payload": {
  "chat_id": "PJ0MRSHTDG",
  "is_typing": true
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "send_typing_indicator",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### Multicast

This method serves for the **chat-unrelated communication**. Messages sent using `multicast` are not being saved.

For example, it could be used in an app that sends notifications to Agents or Customers, when a certain condition is met (e.g. an important Customer started the chat).

#### Specifics

|                        |                                             |
| ---------------------- | ------------------------------------------- |
| **Action**             | `multicast`                                 |
| **Required scopes**    | `multicast:rw`                              |
| **Web API equivalent** | [`multicast`](../#multicast)                |
| **Push message**       | [`incoming_multicast`](#incoming_multicast) |

#### Request

| Parameter    | Required | Data type | Notes                     |
| ------------ | -------- | --------- | ------------------------- |
| `recipients` | Yes      | `object`  | **\***                    |
| `content`    | Yes      | `any`     | A JSON message to be sent |
| `type`       | No       | `string`  | Multicast message type    |

**\*)** `recipients` can take the following values:

- `agents`:

  - `all` (`bool` - includes all agents)
  - `ids` (`[]string` - an array of agents' IDs)
  - `groups` (`[]string` - an array of groups' IDs)

- `customers`:
  - `ids` (`[]string` - an array of customer's IDs)

At least one `recipients` type (`agents.all`, `agents.ids`, `agents.groups`, `customers.ids`) is required.

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "multicast",
  "payload": {
  "recipients": {
    "agents": {
    "all": true,
    "ids": [
      "smith@example.com",
      "agent@example.com"
    ],
    "groups": [
      1,
      2
    ]
    },
    "customers": {
    "ids": [
      "b7eff798-f8df-4364-8059-649c35c9ed0c"
    ]
    }
  },
  "content": {
    "example": {
    "nested": "json"
    }
  }
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "multicast",
  "type": "response",
  "success": true,
  "payload": {
  // no response payload
  }
}
```

</CodeResponse>
</Code>
</Section>

<Section>
<Text>

### List Agents For Transfer

It returns the Agents you can transfer a chat to. Agents are sorted ascendingly by the total number of active chats they have. Note that:

- The method only returns Agents with statuses **online** and **not accepting chats**. Offline Agents aren't returned.
- Only chats **with Customers** are taken into account in `total_active_chats`.

#### Specifics

|                        |                                                            |
| ---------------------- | ---------------------------------------------------------- |
| **Action**             | `list_agents_for_transfer`                                 |
| **Required scopes**    | -                                                          |
| **Web API equivalent** | [`list_agents_for_transfer`](../#list-agents-for-transfer) |
| **Push message**       | -                                                          |

#### Request

| Parameter | Required | Data type | Notes                                   |
| --------- | -------- | --------- | --------------------------------------- |
| `chat_id` | Yes      | `string`  | The ID of the chat you want to transfer |

</Text>
<Code>
<CodeSample path={'REQUEST'}>

```json
{
  "action": "list_agents_for_transfer",
  "payload": {
   "chat_id": "PJ0MRSHTDG"
  }
}
```

</CodeSample>

<CodeResponse>

```json
{
  "request_id": "<request_id>", // optional
  "action": "list_agents_for_transfer",
  "type": "response",
  "success": true,
  "payload": [{
  "agent_id": "smith@example.com",
  "active_chats": 2
  }, {
  "agent_id": "agent@example.com",
  "active_chats": 5
  }]
}
```

</CodeResponse>
</Code>
</Section>

<Section>

<Text>

# Pushes

Here's what you need to know about **pushes**:

- They are generated primarily by RTM API actions, but also by Web API actions.
- They notify you when specific events occur.
- Can be **delivered** only in the websocket transport.
- You don't need to register pushes to receive them.
- Their equivalents in Web API are [webhooks](/management/configuration-api/#webhooks). Pushes and webhooks have similar payloads.
- There are no retries for pushes. To determine if a user has seen an event, compare the [event's](#response) `created_at` parameter with the [user's](#users) `events_seen_up_to` field.

|                 |                                                                                                                                                                                                                                                                                                                                                 |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Chats**       | [`incoming_chat`](#incoming_chat) [`chat_deactivated`](#chat_deactivated)                                                                                                                                                                                                                                                                       |
| **Chat access** | [`chat_access_granted`](#chat_access_granted) [`chat_access_revoked`](#chat_access_revoked) [`chat_transferred`](#chat_transferred)                                                                                                                                                                                                             |
| **Chat users**  | [`user_added_to_chat`](#user_added_to_chat) [`user_removed_from_chat`](#user_removed_from_chat)                                                                                                                                                                                                                                                 |
| **Events**      | [`incoming_event`](#incoming_event) [`event_updated`](#event_updated)[`incoming_rich_message_postback`](#incoming_rich_message_postback)                                                                                                                                                                                                        |
| **Properties**  | [`chat_properties_updated`](#chat_properties_updated) [`chat_properties_deleted`](#chat_properties_deleted) [`thread_properties_updated`](#thread_properties_updated) [`thread_properties_deleted`](#thread_properties_deleted) [`event_properties_updated`](#event_properties_updated) [`event_properties_deleted`](#event_properties_deleted) |
| **Thread tags** | [`thread_tagged`](#thread_tagged) [`thread_untagged`](#thread_untagged)                                                                                                                                                                                                                                                                         |
| **Customers**   | [`customer_visit_started`](#customer_visit_started) [`customer_created`](#customer_created) [`customer_updated`](#customer_updated) [`customer_page_updated`](#customer_page_updated) [`customer_banned`](#customer_banned) [`customer_visit_ended`](#customer_visit_ended)                                                                     |
| **Status**      | [`routing_status_set`](#routing_status_set) [`agent_disconnected`](#agent_disconnected)                                                                                                                                                                                                                                                         |
| **Other**       | [`events_marked_as_seen`](#events_marked_as_seen) [`incoming_sneak_peek`](#incoming_sneak_peek) [`incoming_typing_indicator`](#incoming_typing_indicator) [`incoming_multicast`](#incoming_multicast) [`chat_unfollowed`](#chat_unfollowed) [`queue_positions_updated`](#queue_positions_updated)                                               |

</Text>

<Code>

<CodeResponse title={'general push format'}>

```json
{
  "request_id": "<request_id>", // optional, applies only to the requester
  "action": "<action>",
  "type": "push",
  "payload": {
  // optional payload
  }
}
```

</CodeResponse>

</Code>

</Section>

## Chats

### `incoming_chat`

Informs about a chat coming with a new thread. The push payload contains the whole chat data structure. If the chat was started with some initial events, the thread object contains them.

<CodeResponse title={'Sample push payload'}>

```json
{
  "requester_id": "smith@example.com",
  "chat": {
    "id": "PJ0MRSHTDG",
    "users": [
      // array of "User" objects
    ],
    "properties": {
      "0805e283233042b37f460ed8fbf22160": {
      "string_property": "string value"
      }
      // ...
    },
    "thread": {
      // "Thread" object
    },
    "transferred_from": {
      "group_ids": [ 1 ],
      "agent_ids": [ "agent@example.com" ]
    }
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                 |
| ---------------------- | --------------------------------------------------------------- |
| **Action**             | `incoming_chat`                                                 |
| **Webhook equivalent** | [`incoming_chat`](/management/configuration-api/#incoming_chat) |

### `chat_deactivated`

Informs that a chat was deactivated by closing the currently open thread.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "user_id": "b7eff798-f8df-4364-8059-649c35c9ed0c" // optional
}
```

</CodeResponse>

#### Specifics

|                        |                                                                       |
| ---------------------- | --------------------------------------------------------------------- |
| **Action**             | `chat_deactivated`                                                    |
| **Webhook equivalent** | [`chat_deactivated`](/management/configuration-api/#chat_deactivated) |

#### Push payload

| Field     | Notes                                         |
| --------- | --------------------------------------------- |
| `user_id` | Missing if a thread was closed by the router. |

## Chat access

### `chat_access_granted`

Informs that new, single access to a chat was granted. The existing access isn't overwritten.

<CodeResponse title={'Sample push payload'}>

```json
{
  "id": "PJ0MRSHTDG",
  "access": {
  "group_ids": [1]
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                  |
| ---------------------- | -------------------------------------------------------------------------------- |
| **Action**             | `chat_access_granted`                                                            |
| **Webhook equivalent** | [`chat_access_granted`](/management/configuration-api/v3.2/#chat_access_granted) |

#### Push payload

| Field | Notes   |
| ----- | ------- |
| `id`  | Chat id |

### `chat_access_revoked`

Informs that access to a certain chat was revoked.

<CodeResponse title={'Sample push payload'}>

```json
{
  "id": "PJ0MRSHTDG",
  "access": {
  "group_ids": [1]
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                  |
| ---------------------- | -------------------------------------------------------------------------------- |
| **Action**             | `chat_access_revoked`                                                            |
| **Webhook equivalent** | [`chat_access_revoked`](/management/configuration-api/v3.2/#chat_access_revoked) |

#### Push payload

| Field | Notes   |
| ----- | ------- |
| `id`  | Chat Id |

### `chat_transferred`

Informs that a chat was transferred to a different group or to an Agent.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "requester_id": "cb531744-e6a4-4ded-b3eb-b3eb4ded4ded",
  "transferred_to": {
    "group_ids": [ 1 ],
    "agent_ids": ["smith@example.com"],
  },
  "queue": {
    "position": 42,
    "wait_time": 1337,
    "queued_at": "2019-12-09T12:01:18.909000Z"
  }
}
```

</CodeResponse>

#### Specifics

|                        |                    |
| ---------------------- | ------------------ |
| **Action**             | `chat_transferred` |
| **Webhook equivalent** | -                  |

#### Push payload

| Field                   | Notes                                                |
| ----------------------- | ---------------------------------------------------- |
| `thread_id`             | Present if the chat is active                        |
| `transferred_to` **\*** | IDs of groups and Agents the chat is now assigned to |
| `queue`                 | Present if the chat is queued after the transfer     |

**\*)**
One of the following combinations of IDs is possible:

- Both `group_ids` and `agent_ids`. In situations when a chat was transferred to a group and it was immediately assigned to an Agent (even if the chat transfer occurred in the same group).
- Only `group_ids`. When a chat was transferred to a group and no Agents were available; the queue will be present.
- Only `agent_ids`. When a chat was transferred directly to an Agent; there'll be no queue.

## Chat users

### `user_added_to_chat`

Informs that a user (Customer or Agent) was added to a chat.

This push can be emitted with `user.present` set to `false` when a user writes to a chat without joining it. You can achieve that via the [Send Event](#send-event) method.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "user": {
  // "User > Customer" or "User > Agent" object
  },
  "reason": "manual",
  "requester_id": "smith@example.com"
}
```

</CodeResponse>

#### Specifics

|                        |                                                                           |
| ---------------------- | ------------------------------------------------------------------------- |
| **Action**             | `user_added_to_chat`                                                      |
| **Webhook equivalent** | [`user_added_to_chat`](/management/configuration-api/#user_added_to_chat) |

#### Push payload

| Field          | Notes                                            |
| -------------- | ------------------------------------------------ |
| `thread_id`    | Present when a user was added to an active chat. |
| `reason`       | Why the user was added.                          |
| `requester_id` | Present if the user was added by an agent.       |

### `user_removed_from_chat`

Informs that a user (Customer or Agent) was removed from a chat.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "user_id": "agent@example.com",
  "reason": "manual",
  "requester_id": "smith@example.com"
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                   |
| ---------------------- | --------------------------------------------------------------------------------- |
| **Action**             | `user_removed_from_chat`                                                          |
| **Webhook equivalent** | [`user_removed_from_chat`](/management/configuration-api/#user_removed_from_chat) |

#### Push payload

| Field          | Notes                                                |
| -------------- | ---------------------------------------------------- |
| `thread_id`    | Present when a user was removed from an active chat. |
| `reason`       | Why the user was removed.                            |
| `requester_id` | Present if the user was removed by an agent.         |

## Events

### `incoming_event`

Informs about an incoming [event](#events) sent to a chat.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "event": {
  "id": "Q20163UAHO_2",
  "created_at": "2019-12-05T07:27:08.820000Z",
  "recipients": "all",
  "type": "message",
  "properties": {
    "0805e283233042b37f460ed8fbf22160": {
    "string_property": "string value"
    }
  },
  "text": "Hello",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c"
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                   |
| ---------------------- | ----------------------------------------------------------------- |
| **Action**             | `incoming_event`                                                  |
| **Webhook equivalent** | [`incoming_event`](/management/configuration-api/#incoming_event) |

### `event_updated`

Informs that an [event](#events) was updated.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "123-123-123-123",
  "thread_id": "E2WDHA8A",
  "event": {
  // "Event" object
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                 |
| ---------------------- | --------------------------------------------------------------- |
| **Action**             | `event_updated`                                                 |
| **Webhook equivalent** | [`event_updated`](/management/configuration-api/#event_updated) |

### `incoming_rich_message_postback`

Informs about an incoming [rich message](#rich-message) postback. The push payload contains the info on the postback itself, as well as the chat it was sent in.

<CodeResponse title={'Sample push payload'}>

```json
{
  "user_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "event_id": "a0c22fdd-fb71-40b5-bfc6-a8a0bc3117f7",
  "postback": {
  "id": "action_yes",
  "toggled": true
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                                   |
| ---------------------- | ------------------------------------------------------------------------------------------------- |
| **Action**             | `incoming_rich_message_postback`                                                                  |
| **Webhook equivalent** | [`incoming_rich_message_postback`](/management/configuration-api/#incoming_rich_message_postback) |

## Properties

### `chat_properties_updated`

Informs about those chat properties that were updated.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "properties": {
  "rating": {
    "score": 1,
    "comment": "Well done!"
  }
  // ...
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                     |
| ---------------------- | ----------------------------------------------------------------------------------- |
| **Action**             | `chat_properties_updated`                                                           |
| **Webhook equivalent** | [`chat_properties_updated`](/management/configuration-api/#chat_properties_updated) |

#### Push payload

| Field        | Notes                                                                                                        |
| ------------ | ------------------------------------------------------------------------------------------------------------ |
| `properties` | This is not a full `properties` object. This push shows only the properties that have been recently updated. |

### `chat_properties_deleted`

Informs about those chat properties that were deleted.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "properties": {
    "rating": ["score", "comment"]
    },
    // ...
  }
```

</CodeResponse>

#### Specifics

|                        |                                                                                     |
| ---------------------- | ----------------------------------------------------------------------------------- |
| **Action**             | `chat_properties_deleted`                                                           |
| **Webhook equivalent** | [`chat_properties_deleted`](/management/configuration-api/#chat_properties_deleted) |

#### Push payload

| Field        | Notes                                                                                                        |
| ------------ | ------------------------------------------------------------------------------------------------------------ |
| `properties` | This is not a full `properties` object. This push shows only the properties that have been recently updated. |

### `thread_properties_updated`

Informs about those thread properties that were updated.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "properties": {
  "rating": {
    "score": 1,
    "comment": "Well done!"
  }
  // ...
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                         |
| ---------------------- | --------------------------------------------------------------------------------------- |
| **Action**             | `thread_properties_updated`                                                             |
| **Webhook equivalent** | [`thread_properties_updated`](/management/configuration-api/#thread_properties_updated) |

#### Push payload

| Field        | Notes                                                                                                        |
| ------------ | ------------------------------------------------------------------------------------------------------------ |
| `properties` | This is not a full `properties` object. This push shows only the properties that have been recently updated. |

### `thread_properties_deleted`

Informs about those thread properties that were deleted.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "properties": {
    "rating": ["score", "comment"]
    },
    // ...
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                         |
| ---------------------- | --------------------------------------------------------------------------------------- |
| **Action**             | `thread_properties_deleted`                                                             |
| **Webhook equivalent** | [`thread_properties_deleted`](/management/configuration-api/#thread_properties_deleted) |

#### Push payload

| Field        | Notes                                                                                                        |
| ------------ | ------------------------------------------------------------------------------------------------------------ |
| `properties` | This is not a full `properties` object. This push shows only the properties that have been recently updated. |

### `event_properties_updated`

Informs about those event properties that were updated.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "event_id": "2_E2WDHA8A",
  "properties": {
  "rating": {
    "score": 1,
    "comment": "Well done!"
  }
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                       |
| ---------------------- | ------------------------------------------------------------------------------------- |
| **Action**             | `event_properties_updated`                                                            |
| **Webhook equivalent** | [`event_properties_updated`](/management/configuration-api/#event_properties_updated) |

#### Push payload

| Field        | Notes                                                                                                        |
| ------------ | ------------------------------------------------------------------------------------------------------------ |
| `properties` | This is not a full `properties` object. This push shows only the properties that have been recently updated. |

### `event_properties_deleted`

Informs about those event properties that were deleted.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "event_id": "2_E2WDHA8A",
  "properties": {
    "rating": ["score", "comment"]
    },
    // ...
  }
```

</CodeResponse>

#### Specifics

|                        |                                                                                       |
| ---------------------- | ------------------------------------------------------------------------------------- |
| **Action**             | `event_properties_deleted`                                                            |
| **Webhook equivalent** | [`event_properties_deleted`](/management/configuration-api/#event_properties_deleted) |

#### Push payload

| Field        | Notes                                                                                                        |
| ------------ | ------------------------------------------------------------------------------------------------------------ |
| `properties` | This is not a full `properties` object. This push shows only the properties that have been recently updated. |

## Thread tags

### `thread_tagged`

Informs that a chat thread was tagged.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "tag": "bug_report"
}
```

</CodeResponse>

#### Specifics

|                        |                                                                 |
| ---------------------- | --------------------------------------------------------------- |
| **Action**             | `thread_tagged`                                                 |
| **Webhook equivalent** | [`thread_tagged`](/management/configuration-api/#thread_tagged) |

### `thread_untagged`

Informs that a chat thread was untagged.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "tag": "bug_report"
}
```

</CodeResponse>

#### Specifics

|                        |                                                                     |
| ---------------------- | ------------------------------------------------------------------- |
| **Action**             | `thread_untagged`                                                   |
| **Webhook equivalent** | [`thread_untagged`](/management/configuration-api/#thread_untagged) |

## Customers

### `customer_visit_started`

Informs that a Customer entered the tracked website.

<CodeResponse title={'Sample push payload'}>

```json
{
  "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "visit_id": 42,
  "started_at": "2017-10-12T15:19:21.010200Z",
  "ip": "<customer_ip>",
  "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36",
  "geolocation": {
    "latitude": "54.0805",
    "longitude": "17.4211",
    "country": "Poland",
    "country_code": "PL",
    "region": "Dolnoslaskie",
    "city": "Wroclaw",
    "timezone": "Europe/Warsaw"
  }
}
```

</CodeResponse>

#### Specifics

|                        |                          |
| ---------------------- | ------------------------ |
| **Action**             | `customer_visit_started` |
| **Webhook equivalent** | -                        |

### `customer_created`

Informs that a new Customer registered.

<CodeResponse title={'Sample push payload'}>

```json
{
  "customer": {
  // "User > Customer" object
  "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "created_at": "2019-11-14T14:27:24.410018Z",
  "name": "Thomas Anderson",
  "email": "t.anderson@example.com",
  "avatar": "https://example.com/avatars/1.jpg",
  "session_fields": [{
    "custom_key": "custom_value"
  }, {
    "another_custom_key": "another_custom_value"
  }]
  }
}
```

</CodeResponse>

#### Specifics

|                        |                                                                       |
| ---------------------- | --------------------------------------------------------------------- |
| **Action**             | `customer_created`                                                    |
| **Webhook equivalent** | [`customer_created`](/management/configuration-api/#customer_created) |

### `customer_updated`

Informs that Customer's data was updated.

<CodeResponse title={'Sample push payload'}>

```json
{
  "customer": {
  "id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "name": "Thomas Anderson",
  "email": "t.anderson@example.com",
  "avatar": "https://example.com/avatars/1.jpg",
  "type": "customer",
  "present": false,
  "banned": false,
  "session_fields": [{
    "custom_key": "custom_value"
  }, {
    "another_custom_key": "another_custom_value"
  }]
  }
}
```

</CodeResponse>

#### Specifics

|                        |                    |
| ---------------------- | ------------------ |
| **Action**             | `customer_updated` |
| **Webhook equivalent** | -                  |

### `customer_page_updated`

Informs that a Customer moved to another page of the website.

<CodeResponse title={'Sample push payload'}>

```json
{
  "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "visit_id": 42,
  "opened_at": "2017-10-12T15:19:21.010200Z",
  "url": "https://www.livechat.com/",
  "title": "LiveChat - Homepage"
}
```

</CodeResponse>

#### Specifics

|                        |                         |
| ---------------------- | ----------------------- |
| **Action**             | `customer_page_updated` |
| **Webhook equivalent** | -                       |

### `customer_banned`

Informs that a Customer was banned for a specified number of days.

<CodeResponse title={'Sample push payload'}>

```json
{
  "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "ban": {
  "days": 5
  }
}
```

</CodeResponse>

#### Specifics

|                        |                   |
| ---------------------- | ----------------- |
| **Action**             | `customer_banned` |
| **Webhook equivalent** | -                 |

### `customer_visit_ended`

Informs that a Customer left the tracked website.

<CodeResponse title={'Sample push payload'}>

```json
{
  "customer_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "visit_id": 42,
  "ended_at": "2017-10-12T15:19:21.010200Z"
}
```

</CodeResponse>

#### Specifics

|                        |                        |
| ---------------------- | ---------------------- |
| **Action**             | `customer_visit_ended` |
| **Webhook equivalent** | -                      |

## Status

### `routing_status_set`

Informs that an Agent's or Bot Agent's status was changed.

<CodeResponse title={'Sample push payload'}>

```json
{
  "agent_id": "smith@example.com",
  "status": "accepting_chats"
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                |
| ---------------------- | ------------------------------------------------------------------------------ |
| **Action**             | `routing_status_set`                                                           |
| **Webhook equivalent** | [`routing_status_set`](/management/configuration-api/v3.2/#routing_status_set) |

### `agent_disconnected`

Informs that an Agent was disconnected. The payload contains the reason of Customer's disconnection.

<CodeResponse title={'Sample push payload'}>

```json
{
  "reason": "misdirected_request",
  "data": {
  // optional
  "region": "fra"
  }
}
```

</CodeResponse>

#### Specifics

|                        |                      |
| ---------------------- | -------------------- |
| **Action**             | `agent_disconnected` |
| **Webhook equivalent** | -                    |

#### Possible reasons

| Type                            | Notes                                                  |
| ------------------------------- | ------------------------------------------------------ |
| `access_token_revoked`          | Agent access token has been revoked.                   |
| `access_token_expired`          | Access token life time has elapsed.                    |
| `license_expired`               | License has expired.                                   |
| `agent_deleted`                 | Agent account has been deleted.                        |
| `agent_logged_out_remotely`     | Agent has been logged out remotely.                    |
| `agent_disconnected_by_server`  | Agent has been disconnected by the server.             |
| `unsupported_version`           | Connecting to an unsupported version of the Agent API. |
| `ping_timeout`                  | Not receiving ping for some time from the Customer.    |
| `internal_error`                | Internal error                                         |
| `too_many_connections`          | Agent reached the max. number of connections.          |
| `misdirected_connection` **\*** | Agent connected to the server in the wrong region.     |
| `product_version_changed`       | Product version has been changed.                      |
| `license_not_found`             | License with the specified ID doesn't exist.           |

**\*)**
Also, `misdirected_connection` returns the correct `region` value in the optional `data` object.
With this piece of information, the client is able to figure out where it should be connected.

## Other

### `incoming_typing_indicator`

Informs that one of the chat users is currently typing a message. The message hasn't been sent yet. The push payload contains the typing indicator object.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "typing_indicator": {
  "author_id": "smith@example.com",
  "recipients": "all",
  "timestamp": 1574245378,
  "is_typing": true
  }
}
```

</CodeResponse>

#### Specifics

|                        |                             |
| ---------------------- | --------------------------- |
| **Action**             | `incoming_typing_indicator` |
| **Webhook equivalent** | -                           |

### `incoming_sneak_peek`

Informs about the message a Customer is currently typing. The push payload contains the sneak peek object.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "sneak_peek": {
  author_id: "b7eff798-f8df-4364-8059-649c35c9ed0c",
  recipients: "all",
  text: "Hello",
  timestamp: 1574245378
  }
}
```

</CodeResponse>

#### Specifics

|                        |                       |
| ---------------------- | --------------------- |
| **Action**             | `incoming_sneak_peek` |
| **Webhook equivalent** | -                     |

### `events_marked_as_seen`

Informs that a user has seen events up to a specific time.

<CodeResponse title={'Sample push payload'}>

```json
{
  "user_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "chat_id": "PJ0MRSHTDG",
  "seen_up_to": "2017-10-12T15:19:21.010200Z"
}
```

</CodeResponse>

#### Specifics

|                        |                                                                                 |
| ---------------------- | ------------------------------------------------------------------------------- |
| **Action**             | `events_marked_as_seen`                                                         |
| **Webhook equivalent** | [`events_marked_as_seen`](/management/configuration-api/#events_marked_as_seen) |

### `incoming_multicast`

Informs about messages sent via the `multicast` method or by the system.

<CodeResponse title={'Sample push payload'}>

```json
{
  "author_id": "smith@example.com",
  "content": {
  "example": {
    "nested": "json"
  }
  },
  "type": "type1"
}
```

</CodeResponse>

#### Specifics

|                        |                      |
| ---------------------- | -------------------- |
| **Action**             | `incoming_multicast` |
| **Webhook equivalent** | -                    |

#### Push payload

| Field       | Required | Notes                                                                                            |
| ----------- | -------- | ------------------------------------------------------------------------------------------------ |
| `author_id` | No       | Present only if the push was generated by the **Multicast** method and not sent from the server. |
| `content`   | Yes      |                                                                                                  |
| `type`      | No       |                                                                                                  |

### `chat_unfollowed`

Informs that a chat has been unfollowed. Useful in multiple connection scenarios, where one app/integration needs to know that another one unfollowed the chat.

<CodeResponse title={'Sample push payload'}>

```json
{
  "chat_id": "PJ0MRSHTDG"
}
```

</CodeResponse>

#### Specifics

|                        |                   |
| ---------------------- | ----------------- |
| **Action**             | `chat_unfollowed` |
| **Webhook equivalent** | -                 |

### `queue_positions_updated`

New positions and wait times for queued chats.

<CodeResponse title={'Sample push payload'}>

```json
[{
  "chat_id": "PJ0MRSHTDG",
  "thread_id": "K600PKZON8",
  "queue": {
    "position": 42,
    "wait_time": 1337
  }
}, {
  "chat_id": "PJ0VRSATDS",
  "thread_id": "K60QPKSON9",
  "queue": {
    "position": 43,
    "wait_time": 1373
  }
}]
```

</CodeResponse>

#### Specifics

|                        |                           |
| ---------------------- | ------------------------- |
| **Action**             | `queue_positions_updated` |
| **Webhook equivalent** | -                         |

# Errors

<CodeResponse title={'Format of error payload'}>

```json
{
  "error": {
    "type": "misdirected_request",
    "message": "Wrong region",
    "data": {
      // optional
      "region": "dal"
    }
  }
}
```

</CodeResponse>

## Possible errors

<Errors errors="authentication,authorization,chat_inactive,internal,license_expired,pending_requests_limit_reached,requester_already_offline,requester_awaiting_approval,request_timeout,requester_suspended,seats_limit_exceeded,too_many_requests,validation,wrong_product_version"/>

# Contact us

If you found a bug or a typo, you can let us know directly on GitHub.
In case of any questions or feedback, don't hesitate to contact us at [developers@livechat.com](mailto:developers@livechat.com). We'll be happy to hear from you!
